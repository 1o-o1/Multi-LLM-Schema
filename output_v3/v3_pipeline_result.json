{
  "pipeline_version": "V3",
  "timestamp": "2025-07-30 10:06:39",
  "total_processing_time": 795.3509802818298,
  "stages": {
    "stage1_prompt1": {
      "stage_name": "stage1_prompt1",
      "content": {
        "openai": {
          "parsed_json": {
            "log_type": "Windows Security Log - Logon/Logoff Events",
            "follow_up_queries": [
              "threat hunting queries for Windows Security logon events",
              "common attack vectors related to Windows logon/logoff events"
            ],
            "fields": {
              "source_computer": {
                "type": "string",
                "description": "Name of the computer from which the logon/logoff event originated.",
                "OCSF": "actor.machine.id",
                "ECS": "source.host.name",
                "OSSEM": "subject.machine.name",
                "importance": 8
              },
              "destination_computer": {
                "type": "string",
                "description": "Name of the computer to which the logon/logoff event was directed.",
                "OCSF": "target.machine.id",
                "ECS": "destination.host.name",
                "OSSEM": "object.machine.name",
                "importance": 8
              },
              "auth_type": {
                "type": "string",
                "description": "Authentication package or protocol used (e.g., Kerberos, NTLM).",
                "OCSF": "event.authentication_method",
                "ECS": "user.authentication.type",
                "OSSEM": "subject.credential.authentication_method",
                "importance": 7
              },
              "logon_type": {
                "type": "string",
                "description": "Type of logon session (e.g., Network).",
                "OCSF": "event.session.type",
                "ECS": "winlog.event_data.LogonType",
                "OSSEM": "subject.session.type",
                "importance": 6
              },
              "times": {
                "type": "string",
                "description": "Timestamp of the event in HHMMSS format.",
                "OCSF": "event.start",
                "ECS": "event.time",
                "OSSEM": "event.event.timestamp",
                "importance": 8
              },
              "source_users": {
                "type": "array",
                "description": "List of user accounts on the source computer involved in the event.",
                "OCSF": "actor.user.name",
                "ECS": "source.user.name",
                "OSSEM": "subject.user.name",
                "importance": 10
              },
              "destination_users": {
                "type": "array",
                "description": "List of user accounts on the destination computer involved in the event.",
                "OCSF": "target.user.name",
                "ECS": "destination.user.name",
                "OSSEM": "object.user.name",
                "importance": 10
              },
              "orientations": {
                "type": "string",
                "description": "Operation type of the event (e.g., LogOn, LogOff).",
                "OCSF": "event.action",
                "ECS": "event.action",
                "OSSEM": "event.action",
                "importance": 6
              },
              "statuses": {
                "type": "string",
                "description": "Result of the logon/logoff operation (e.g., Success, Failure).",
                "OCSF": "event.outcome",
                "ECS": "event.outcome",
                "OSSEM": "event.outcome",
                "importance": 9
              }
            }
          },
          "raw_response": "{\"log_type\":\"Windows Security Log - Logon/Logoff Events\",\"follow_up_queries\":[\"threat hunting queries for Windows Security logon events\",\"common attack vectors related to Windows logon/logoff events\"],\"fields\":{\"source_computer\":{\"type\":\"string\",\"description\":\"Name of the computer from which the logon/logoff event originated.\",\"OCSF\":\"actor.machine.id\",\"ECS\":\"source.host.name\",\"OSSEM\":\"subject.machine.name\",\"importance\":8},\"destination_computer\":{\"type\":\"string\",\"description\":\"Name of the computer to which the logon/logoff event was directed.\",\"OCSF\":\"target.machine.id\",\"ECS\":\"destination.host.name\",\"OSSEM\":\"object.machine.name\",\"importance\":8},\"auth_type\":{\"type\":\"string\",\"description\":\"Authentication package or protocol used (e.g., Kerberos, NTLM).\",\"OCSF\":\"event.authentication_method\",\"ECS\":\"user.authentication.type\",\"OSSEM\":\"subject.credential.authentication_method\",\"importance\":7},\"logon_type\":{\"type\":\"string\",\"description\":\"Type of logon session (e.g., Network).\",\"OCSF\":\"event.session.type\",\"ECS\":\"winlog.event_data.LogonType\",\"OSSEM\":\"subject.session.type\",\"importance\":6},\"times\":{\"type\":\"string\",\"description\":\"Timestamp of the event in HHMMSS format.\",\"OCSF\":\"event.start\",\"ECS\":\"event.time\",\"OSSEM\":\"event.event.timestamp\",\"importance\":8},\"source_users\":{\"type\":\"array\",\"description\":\"List of user accounts on the source computer involved in the event.\",\"OCSF\":\"actor.user.name\",\"ECS\":\"source.user.name\",\"OSSEM\":\"subject.user.name\",\"importance\":10},\"destination_users\":{\"type\":\"array\",\"description\":\"List of user accounts on the destination computer involved in the event.\",\"OCSF\":\"target.user.name\",\"ECS\":\"destination.user.name\",\"OSSEM\":\"object.user.name\",\"importance\":10},\"orientations\":{\"type\":\"string\",\"description\":\"Operation type of the event (e.g., LogOn, LogOff).\",\"OCSF\":\"event.action\",\"ECS\":\"event.action\",\"OSSEM\":\"event.action\",\"importance\":6},\"statuses\":{\"type\":\"string\",\"description\":\"Result of the logon/logoff operation (e.g., Success, Failure).\",\"OCSF\":\"event.outcome\",\"ECS\":\"event.outcome\",\"OSSEM\":\"event.outcome\",\"importance\":9}}}",
          "model": "o4-mini",
          "provider": "openai"
        },
        "gemini": {
          "parsed_json": {
            "log_type": "Windows Authentication Log",
            "follow_up_queries": [
              "Threat hunting queries for lateral movement using Windows authentication events",
              "Detecting credential dumping attacks using Windows event logs"
            ],
            "fields": {
              "source_computer": {
                "type": "string",
                "description": "The hostname or IP address of the system where the authentication request originated.",
                "OCSF": "src_endpoint.hostname",
                "ECS": "source.hostname",
                "OSSEM": "source.host.name",
                "importance": 8
              },
              "destination_computer": {
                "type": "string",
                "description": "The hostname or IP address of the system that the user is attempting to authenticate to.",
                "OCSF": "dst_endpoint.hostname",
                "ECS": "destination.hostname",
                "OSSEM": "destination.host.name",
                "importance": 8
              },
              "auth_type": {
                "type": "string",
                "description": "The authentication protocol used in the logon attempt, such as Kerberos or NTLM.",
                "OCSF": "auth_protocol_name",
                "ECS": "winlog.event_data.AuthenticationPackageName",
                "OSSEM": "winlog.event_data.AuthenticationPackageName",
                "importance": 7
              },
              "logon_type": {
                "type": "string",
                "description": "Specifies the type of logon that occurred, for example, Network, Interactive, or Service.",
                "OCSF": "logon_type",
                "ECS": "winlog.logon.type",
                "OSSEM": "winlog.event_data.LogonType",
                "importance": 8
              },
              "times": {
                "type": "array",
                "description": "The timestamp or series of timestamps when the event occurred.",
                "OCSF": "time",
                "ECS": "@timestamp",
                "OSSEM": "event.created",
                "importance": 9
              },
              "source_users": {
                "type": "array",
                "description": "The user account that initiated the logon from the source system.",
                "OCSF": "actor.user.name",
                "ECS": "source.user.name",
                "OSSEM": "source.user.name",
                "importance": 9
              },
              "destination_users": {
                "type": "array",
                "description": "The user account on the destination system for which the authentication was attempted.",
                "OCSF": "user.name",
                "ECS": "user.name",
                "OSSEM": "user.name",
                "importance": 9
              },
              "orientations": {
                "type": "string",
                "description": "The specific action being logged, such as a 'LogOn' or 'LogOff' event.",
                "OCSF": "activity_name",
                "ECS": "event.action",
                "OSSEM": "event.action",
                "importance": 8
              },
              "statuses": {
                "type": "string",
                "description": "The outcome of the authentication event, such as 'Success' or 'Failure'.",
                "OCSF": "status",
                "ECS": "event.outcome",
                "OSSEM": "event.outcome",
                "importance": 10
              }
            }
          },
          "raw_response": "```json\n{\n  \"log_type\": \"Windows Authentication Log\",\n  \"follow_up_queries\": [\n    \"Threat hunting queries for lateral movement using Windows authentication events\",\n    \"Detecting credential dumping attacks using Windows event logs\"\n  ],\n  \"fields\": {\n    \"source_computer\": {\n      \"type\": \"string\",\n      \"description\": \"The hostname or IP address of the system where the authentication request originated.\",\n      \"OCSF\": \"src_endpoint.hostname\",\n      \"ECS\": \"source.hostname\",\n      \"OSSEM\": \"source.host.name\",\n      \"importance\": 8\n    },\n    \"destination_computer\": {\n      \"type\": \"string\",\n      \"description\": \"The hostname or IP address of the system that the user is attempting to authenticate to.\",\n      \"OCSF\": \"dst_endpoint.hostname\",\n      \"ECS\": \"destination.hostname\",\n      \"OSSEM\": \"destination.host.name\",\n      \"importance\": 8\n    },\n    \"auth_type\": {\n      \"type\": \"string\",\n      \"description\": \"The authentication protocol used in the logon attempt, such as Kerberos or NTLM.\",\n      \"OCSF\": \"auth_protocol_name\",\n      \"ECS\": \"winlog.event_data.AuthenticationPackageName\",\n      \"OSSEM\": \"winlog.event_data.AuthenticationPackageName\",\n      \"importance\": 7\n    },\n    \"logon_type\": {\n      \"type\": \"string\",\n      \"description\": \"Specifies the type of logon that occurred, for example, Network, Interactive, or Service.\",\n      \"OCSF\": \"logon_type\",\n      \"ECS\": \"winlog.logon.type\",\n      \"OSSEM\": \"winlog.event_data.LogonType\",\n      \"importance\": 8\n    },\n    \"times\": {\n      \"type\": \"array\",\n      \"description\": \"The timestamp or series of timestamps when the event occurred.\",\n      \"OCSF\": \"time\",\n      \"ECS\": \"@timestamp\",\n      \"OSSEM\": \"event.created\",\n      \"importance\": 9\n    },\n    \"source_users\": {\n      \"type\": \"array\",\n      \"description\": \"The user account that initiated the logon from the source system.\",\n      \"OCSF\": \"actor.user.name\",\n      \"ECS\": \"source.user.name\",\n      \"OSSEM\": \"source.user.name\",\n      \"importance\": 9\n    },\n    \"destination_users\": {\n      \"type\": \"array\",\n      \"description\": \"The user account on the destination system for which the authentication was attempted.\",\n      \"OCSF\": \"user.name\",\n      \"ECS\": \"user.name\",\n      \"OSSEM\": \"user.name\",\n      \"importance\": 9\n    },\n    \"orientations\": {\n      \"type\": \"string\",\n      \"description\": \"The specific action being logged, such as a 'LogOn' or 'LogOff' event.\",\n      \"OCSF\": \"activity_name\",\n      \"ECS\": \"event.action\",\n      \"OSSEM\": \"event.action\",\n      \"importance\": 8\n    },\n    \"statuses\": {\n      \"type\": \"string\",\n      \"description\": \"The outcome of the authentication event, such as 'Success' or 'Failure'.\",\n      \"OCSF\": \"status\",\n      \"ECS\": \"event.outcome\",\n      \"OSSEM\": \"event.outcome\",\n      \"importance\": 10\n    }\n  }\n}\n```",
          "model": "gemini-2.5-pro",
          "provider": "gemini"
        },
        "gemini_flash": {
          "parsed_json": {
            "log_type": "Windows Authentication Log",
            "follow_up_queries": [
              "threat hunting queries for Windows authentication logs",
              "common attack vectors related to Windows logon events"
            ],
            "fields": {
              "source_computer": {
                "type": "string",
                "description": "The name of the source computer involved in the authentication event.",
                "OCSF": "src.host.name",
                "ECS": "source.host.name",
                "OSSEM": "source.host.name",
                "importance": 8
              },
              "destination_computer": {
                "type": "string",
                "description": "The name of the destination computer involved in the authentication event.",
                "OCSF": "dst.host.name",
                "ECS": "destination.host.name",
                "OSSEM": "destination.host.name",
                "importance": 8
              },
              "auth_type": {
                "type": "string",
                "description": "The type of authentication protocol used (e.g., Kerberos, NTLM).",
                "OCSF": "auth.auth_protocol",
                "ECS": "authentication.type",
                "OSSEM": "logon.authentication_package_name",
                "importance": 9
              },
              "logon_type": {
                "type": "string",
                "description": "The type of logon that occurred (e.g., Network, Interactive).",
                "OCSF": "auth.logon_type",
                "ECS": "logon.type",
                "OSSEM": "logon.logon_type",
                "importance": 9
              },
              "times": {
                "type": "array",
                "description": "An array of timestamps associated with the event. The format appears to be a Unix timestamp.",
                "OCSF": "time",
                "ECS": "@timestamp",
                "OSSEM": "time",
                "importance": 7
              },
              "source_users": {
                "type": "string",
                "description": "The user account(s) on the source computer involved in the authentication event. This field can contain multiple users.",
                "OCSF": "actor.user.name",
                "ECS": "source.user.name",
                "OSSEM": "source.user.name",
                "importance": 9
              },
              "destination_users": {
                "type": "string",
                "description": "The user account(s) on the destination computer involved in the authentication event. This field can contain multiple users.",
                "OCSF": "user.name",
                "ECS": "destination.user.name",
                "OSSEM": "destination.user.name",
                "importance": 9
              },
              "orientations": {
                "type": "string",
                "description": "Indicates the orientation of the event, such as 'LogOn' or 'LogOff'.",
                "OCSF": "activity_name",
                "ECS": "event.action",
                "OSSEM": "event.action",
                "importance": 8
              },
              "statuses": {
                "type": "string",
                "description": "The status of the authentication attempt (e.g., Success, Failure).",
                "OCSF": "status",
                "ECS": "event.outcome",
                "OSSEM": "status",
                "importance": 10
              }
            }
          },
          "raw_response": "```json\n{\n  \"log_type\": \"Windows Authentication Log\",\n  \"follow_up_queries\": [\n    \"threat hunting queries for Windows authentication logs\",\n    \"common attack vectors related to Windows logon events\"\n  ],\n  \"fields\": {\n    \"source_computer\": {\n      \"type\": \"string\",\n      \"description\": \"The name of the source computer involved in the authentication event.\",\n      \"OCSF\": \"src.host.name\",\n      \"ECS\": \"source.host.name\",\n      \"OSSEM\": \"source.host.name\",\n      \"importance\": 8\n    },\n    \"destination_computer\": {\n      \"type\": \"string\",\n      \"description\": \"The name of the destination computer involved in the authentication event.\",\n      \"OCSF\": \"dst.host.name\",\n      \"ECS\": \"destination.host.name\",\n      \"OSSEM\": \"destination.host.name\",\n      \"importance\": 8\n    },\n    \"auth_type\": {\n      \"type\": \"string\",\n      \"description\": \"The type of authentication protocol used (e.g., Kerberos, NTLM).\",\n      \"OCSF\": \"auth.auth_protocol\",\n      \"ECS\": \"authentication.type\",\n      \"OSSEM\": \"logon.authentication_package_name\",\n      \"importance\": 9\n    },\n    \"logon_type\": {\n      \"type\": \"string\",\n      \"description\": \"The type of logon that occurred (e.g., Network, Interactive).\",\n      \"OCSF\": \"auth.logon_type\",\n      \"ECS\": \"logon.type\",\n      \"OSSEM\": \"logon.logon_type\",\n      \"importance\": 9\n    },\n    \"times\": {\n      \"type\": \"array\",\n      \"description\": \"An array of timestamps associated with the event. The format appears to be a Unix timestamp.\",\n      \"OCSF\": \"time\",\n      \"ECS\": \"@timestamp\",\n      \"OSSEM\": \"time\",\n      \"importance\": 7\n    },\n    \"source_users\": {\n      \"type\": \"string\",\n      \"description\": \"The user account(s) on the source computer involved in the authentication event. This field can contain multiple users.\",\n      \"OCSF\": \"actor.user.name\",\n      \"ECS\": \"source.user.name\",\n      \"OSSEM\": \"source.user.name\",\n      \"importance\": 9\n    },\n    \"destination_users\": {\n      \"type\": \"string\",\n      \"description\": \"The user account(s) on the destination computer involved in the authentication event. This field can contain multiple users.\",\n      \"OCSF\": \"user.name\",\n      \"ECS\": \"destination.user.name\",\n      \"OSSEM\": \"destination.user.name\",\n      \"importance\": 9\n    },\n    \"orientations\": {\n      \"type\": \"string\",\n      \"description\": \"Indicates the orientation of the event, such as 'LogOn' or 'LogOff'.\",\n      \"OCSF\": \"activity_name\",\n      \"ECS\": \"event.action\",\n      \"OSSEM\": \"event.action\",\n      \"importance\": 8\n    },\n    \"statuses\": {\n      \"type\": \"string\",\n      \"description\": \"The status of the authentication attempt (e.g., Success, Failure).\",\n      \"OCSF\": \"status\",\n      \"ECS\": \"event.outcome\",\n      \"OSSEM\": \"status\",\n      \"importance\": 10\n    }\n  }\n}\n```",
          "model": "gemini-2.5-flash",
          "provider": "gemini_flash"
        }
      },
      "confidence": 0.8,
      "processing_time": 99.24098229408264,
      "method_used": "multi_model_prompt1",
      "source_files": [
        "output_v3\\stage1_prompt1\\openai_prompt1.json",
        "output_v3\\stage1_prompt1\\gemini_prompt1.json",
        "output_v3\\stage1_prompt1\\gemini_flash_prompt1.json"
      ],
      "metadata": {
        "models_used": [
          "openai",
          "gemini",
          "gemini_flash"
        ],
        "preprocessed_log_length": 1103
      }
    },
    "stage2_semantic_core_consensus": {
      "stage_name": "stage2_semantic_core_consensus",
      "content": {
        "log_type": "Windows Authentication Log",
        "follow_up_queries": [
          "Threat hunting queries for lateral movement using Windows authentication events",
          "Detecting credential dumping attacks using Windows event logs"
        ],
        "fields": {
          "source_computer": {
            "type": "string",
            "description": "The name or identifier of the computer where the authentication attempt originated.",
            "OCSF": "source.device.hostname",
            "ECS": "source.domain",
            "OSSEM": "source.host.name",
            "importance": 8
          },
          "destination_computer": {
            "type": "string",
            "description": "The name or identifier of the computer that was the target of the authentication attempt.",
            "OCSF": "dst_endpoint.hostname",
            "ECS": "destination.domain",
            "OSSEM": "destination.host.name",
            "importance": 8
          },
          "auth_type": {
            "type": "string",
            "description": "The authentication protocol used for the logon, such as Kerberos or NTLM.",
            "OCSF": "auth.auth_protocol",
            "ECS": "event.authentication_method",
            "OSSEM": "authentication.package_name",
            "importance": 7
          },
          "logon_type": {
            "type": "string",
            "description": "The type of logon that occurred, such as Network or Interactive.",
            "OCSF": "logon_type",
            "ECS": "winlog.logon.type",
            "OSSEM": "logon.logon_type",
            "importance": 7
          },
          "times": {
            "type": "array",
            "description": "A list of timestamps associated with the event. The raw log sample indicates multiple timestamps can be present for a single event.",
            "OCSF": "time",
            "ECS": "@timestamp",
            "OSSEM": "event.time",
            "importance": 9
          },
          "source_users": {
            "type": "array",
            "description": "The user account that initiated the logon request.",
            "OCSF": "src.user.name",
            "ECS": "source.user.name",
            "OSSEM": "source.user.name",
            "importance": 9
          },
          "destination_users": {
            "type": "array",
            "description": "The user account for which the new logon was created.",
            "OCSF": "user.name",
            "ECS": "destination.user.name",
            "OSSEM": "object.user.name",
            "importance": 9
          },
          "orientations": {
            "type": "string",
            "description": "The orientation of the event, indicating if it was a logon or logoff.",
            "OCSF": "activity_name",
            "ECS": "event.action",
            "OSSEM": "action",
            "importance": 8
          },
          "statuses": {
            "type": "string",
            "description": "The status of the authentication attempt, such as Success or Failure.",
            "OCSF": "status",
            "ECS": "event.outcome",
            "OSSEM": "status",
            "importance": 8
          }
        }
      },
      "confidence": 0.3884615384615384,
      "processing_time": 3.0810439586639404,
      "method_used": "SEMANTIC_CORE",
      "source_files": [
        "output_v3\\stage2_semantic_core\\json1_consensus.json",
        "output_v3\\stage2_semantic_core\\json1_consensus_prompt2.json"
      ],
      "metadata": {
        "consensus_parts_count": 5,
        "original_file_count": 3,
        "quality_metrics": {
          "overall_quality": 0.3884615384615384,
          "coverage": 0.02564102564102564,
          "consensus_success_rate": 0.4,
          "average_consensus_confidence": 0.5,
          "data_preservation": 1.0,
          "source_diversity": 0.3333333333333333,
          "structural_integrity": 0.0
        }
      }
    },
    "stage3_prompt2": {
      "stage_name": "stage3_prompt2",
      "content": {
        "claude": "I'll conduct a comprehensive security analysis of Windows Authentication Logs by researching the current threat landscape, adversary behaviors, and detection opportunities. Let me start by gathering the latest threat intelligence.Now I have gathered comprehensive information about the current threat landscape, lateral movement techniques, credential dumping attacks, MITRE ATT&CK mappings, and STIX 2.1 standards. Let me compile this into a complete security analysis report for Windows Authentication Logs.\n\n# Security Analysis Report for Windows Authentication Logs\n\n## Executive Summary\n\nWindows Authentication Logs represent one of the most critical data sources for detecting advanced persistent threats, lateral movement, and credential-based attacks in enterprise environments. According to the CrowdStrike 2025 Global Threat Report, the misuse of valid accounts emerged as the primary initial access vector for cloud environments, accounting for 35% of cloud incidents in the first half of 2024. Adversaries also used compromised credentials to enter and move laterally through organizations, operating as legitimate users and evading detections, with access broker advertisements, often selling valid stolen credentials, surging 50% year-over-year.\n\nThis log source provides unparalleled visibility into authentication patterns, enabling detection of sophisticated attack techniques including pass-the-hash attacks, credential dumping, privilege escalation, and lateral movement. The analyzed fields—encompassing source/destination computers, authentication types, logon types, timestamps, user accounts, orientations, and statuses—form a comprehensive framework for identifying malicious activity that traditional perimeter defenses often miss.\n\nKey recommendations include implementing behavioral analytics for anomaly detection, establishing baseline authentication patterns, monitoring for temporal and geographical inconsistencies, and integrating authentication logs with threat intelligence platforms for enhanced context and attribution.\n\n---\n\n## 1. Threat Landscape & Adversary Behavior\n\n### 1.1. Current Threat Landscape Research\n\n**Industry Reporting:**\n\nVoice phishing (vishing) attacks surged by 442% between the first and second half of 2024 as groups like CURLY SPIDER trick employees into handing over login details. Those who don't steal credentials can buy them — access broker activity was up nearly 50% in 2024, reflecting the growing market for illicit access. The average eCrime breakout time — the time it takes for an adversary to move from an initially compromised host to another within the target organization — was 48 minutes in 2024, down from 62 minutes the previous year.\n\nValid account abuse is the primary initial access tactic, accounting for 35% of cloud incidents in H1 2024. According to M-Trends 2025, the most common initial infection vector was exploit (33%), followed by stolen credentials (16%), and email phishing (14%). While exploits are still the most common way that attackers are breaching organizations, they're using stolen credentials more than ever before.\n\n**Emerging Vectors:**\n\nLockBit leverages a wide array of tools for lateral movement, including Cobalt Strike, Mimikatz, and RDP. They're also known to use custom tools to disable security software. In February 2024, the BlackCat ransomware group infiltrated Change Healthcare's systems, utilizing stolen credentials to move laterally across the network. They deployed ransomware to encrypt files and exfiltrated sensitive data to pressure the organization into paying a ransom.\n\nThe vulnerability enables what is known as an authentication coercion attack, where a vulnerable device is essentially coerced into sending NTLM hashes — the cryptographic representation of a user's password — to an attacker's system.\n\n**Academic Research:**\n\nRecent research proposed a different set of rarity aspects to characterize an anomalous Windows authentication event, with systems tracking login activity and creating graphs of related logins among hosts to identify anomalies in login patterns, thus allowing for detecting lateral movement attacks. Anomaly detection is crucial for various applications, including network security, fraud detection, predictive maintenance, fault diagnosis, and industrial and healthcare monitoring. Many researchers have proposed numerous methods and worked in the area of anomaly detection.\n\n### 1.2. MITRE ATT&CK® Framework Mapping\n\n**T1003 – OS Credential Dumping:**\nAdversaries may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password. Credentials can be obtained from OS caches, memory, or structures. Credentials can then be used to perform Lateral Movement and access restricted information. Detection relies on monitoring authentication events in the `destination_users` and `source_users` fields for unusual credential usage patterns.\n\n**T1021 – Remote Services:**\nAdversaries may use Valid Accounts to log into a service that accepts remote connections, such as telnet, SSH, and VNC. Domains provide centralized identity management, allowing users to login using one set of credentials across the entire network. If an adversary is able to obtain a set of valid domain credentials, they could login to many different machines using remote access protocols such as secure shell (SSH) or remote desktop protocol (RDP). Observable through `auth_type`, `logon_type`, `source_computer`, and `destination_computer` fields.\n\n**T1078 – Valid Accounts:**\nLeverages legitimate credentials for persistence and lateral movement. Detectable through analysis of `source_users`, `destination_users`, `times`, and `statuses` fields for anomalous authentication patterns.\n\n**TA0008 – Lateral Movement:**\nLateral Movement consists of techniques that adversaries use to enter and control remote systems on a network. Following through on their primary objective often requires exploring the network to find their target and subsequently gaining access to it. All analyzed fields contribute to lateral movement detection, particularly `source_computer`, `destination_computer`, and temporal patterns in `times`.\n\n---\n\n## 2. Observable Evidence & Patterns \n\n### 2.1.1 Malicious Behavioral/Temporal Patterns\n\n**Pattern:** Rapid Cross-System Authentication\n**Description:** Authentication events over the network from rare or unusual hosts or users using EventCode 4624 with LogonType 3 (network connection) occurring within short time windows across multiple systems.\n**Identifiable Fields:** `source_computer`, `destination_computer`, `times`, `source_users`, `destination_users`, `logon_type`\n\n**Pattern:** Pass-the-Hash Authentication Anomalies\n**Description:** Attackers leverage hashed credentials (NTLM hashes) or Kerberos tickets to authenticate on other systems without needing the plaintext passwords. These techniques are commonly used to escalate privileges and move laterally between high-value systems\n**Identifiable Fields:** `auth_type`, `destination_users`, `source_computer`, `destination_computer`, `statuses`\n\n**Pattern:** Privilege Escalation Authentication Chains\n**Description:** Sequential authentication events showing escalation from standard user to administrative accounts across systems.\n**Identifiable Fields:** `source_users`, `destination_users`, `times`, `orientations`, `statuses`\n\n**Pattern:** Credential Stuffing Attack Signatures\n**Description:** Malicious actors routinely use the NTLM authentication protocol to carry out account enumeration and brute force-styled attacks to compromise accounts within a victim's network. Once inside, an attacker can gain persistence, exfiltrate sensitive data, and unleash ransomware\n**Identifiable Fields:** `source_users`, `destination_users`, `statuses`, `times`, `auth_type`\n\n**Pattern:** Service Account Abuse\n**Description:** Legitimate service accounts being used for interactive logons or accessing resources outside their normal scope.\n**Identifiable Fields:** `source_users`, `destination_users`, `logon_type`, `destination_computer`\n\n### 2.1.2 Anomalous Behavioral/Temporal Patterns\n\n**Pattern:** Off-Hours Authentication Activity\n**Description:** User anomaly refers to the exercise of finding rare login pattern. Each device has a steady pattern of login as most of the IT operations are repetitive and so their login pattern is quite straight forward\n**Identifiable Fields:** `times`, `source_users`, `destination_users`, `source_computer`\n\n**Pattern:** Geographical Authentication Inconsistencies\n**Description:** Authentication attempts from locations inconsistent with user's typical access patterns.\n**Identifiable Fields:** `source_computer`, `times`, `source_users`, `destination_users`\n\n**Pattern:** Authentication Protocol Deviations\n**Description:** Users suddenly switching from typical Kerberos to NTLM authentication or other protocol changes.\n**Identifiable Fields:** `auth_type`, `source_users`, `destination_users`, `times`\n\n**Pattern:** Logon Type Anomalies\n**Description:** Users performing logon types inconsistent with their role (e.g., service logons from interactive users).\n**Identifiable Fields:** `logon_type`, `source_users`, `destination_users`, `destination_computer`\n\n**Pattern:** Authentication Frequency Spikes\n**Description:** Sudden increases in authentication frequency from specific users or to specific systems.\n**Identifiable Fields:** `times`, `source_users`, `destination_users`, `source_computer`, `destination_computer`\n\n### 2.1.3 Vulnerable Behavioral/Temporal Patterns\n\n**Pattern:** Weak Authentication Protocol Usage\n**Description:** Despite being replaced by more secure authentication protocols and having multiple known vulnerabilities, NTLM is still widely deployed today because of its compatibility with legacy systems and applications\n**Identifiable Fields:** `auth_type`, `source_computer`, `destination_computer`\n\n**Pattern:** Shared Account Usage\n**Description:** Multiple simultaneous sessions from the same account across different systems.\n**Identifiable Fields:** `source_users`, `destination_users`, `times`, `source_computer`, `destination_computer`\n\n**Pattern:** Stale Authentication Sessions\n**Description:** Long-running authentication sessions without re-authentication, indicating potential session hijacking vulnerability.\n**Identifiable Fields:** `times`, `orientations`, `source_users`, `destination_users`\n\n**Pattern:** Administrative Account Overuse\n**Description:** Administrative accounts being used for routine tasks instead of standard user accounts.\n**Identifiable Fields:** `source_users`, `destination_users`, `logon_type`, `destination_computer`\n\n**Pattern:** Legacy System Authentication\n**Description:** Authentication to systems running outdated software or protocols vulnerable to exploitation.\n**Identifiable Fields:** `destination_computer`, `auth_type`, `source_users`, `destination_users`\n\n### 2.2. Key Indicators of Compromise (IOCs)\n\n**Authentication Failure Patterns:** The most common and noisy indicators within event logs for lateral movement attempts are failed logins; the most common event IDs for this are 529 & 4625. Each method of lateral movement has its own set of associated event IDs. For example, attempts to login to accounts via SMB will generate event IDs 552 or 4648 (logon attempt using explicit credentials), and PsExec will show 601 or 4697 (service was installed in the system)\n\n**Credential Dumping Artifacts:** LSASS credential dumping was first observed in the tactics, techniques, and procedures (TTPs) of several sophisticated threat activity groups—including actors that Microsoft tracks as HAFNIUM and GALLIUM. Detecting and stopping OS credential theft is therefore important because it can spell the difference between compromising or encrypting one device versus an entire network\n\n**Lateral Movement Indicators:** Based on searches, administrators connected over the network from specific IP addresses and gained command line access to victim hosts. Using psexec for lateral movement has been around for quite a while and is still very popular and relevant\n\n**Account Enumeration Signatures:** Account enumeration is a more specific type of brute force attack where the attacker is attempting to guess the valid usernames of users within a network. These attacks are typically done when the malicious actor has limited information about their victim's network\n\n---\n\n## 3. Actionable Detection & Response\n\n### 3.1. Detection Logic \n\n#### Rule 1: Lateral Movement via Authentication Events\n**Conceptual Rule:** Detect rapid authentication across multiple systems within short time windows\n**Threat Scenario:** Initial search using Windows security logs, looking for authentication events over the network from rare or unusual hosts or users\n**Detection Logic:** \n- Monitor `source_computer` and `destination_computer` for authentication chains\n- Analyze `times` for rapid sequential authentications (< 5 minutes between systems)\n- Filter `logon_type` = 3 (Network) and `statuses` = \"Success\"\n- Cross-reference `source_users` and `destination_users` for privilege escalation patterns\n**Mapped TTPs:** T1021 (Remote Services), TA0008 (Lateral Movement)\n**Immediate Action:** Isolate affected systems and reset credentials for involved accounts\n\n#### Rule 2: Credential Dumping Detection\n**Conceptual Rule:** Identify potential credential harvesting activities\n**Threat Scenario:** Credential dumping via Mimikatz is a technique used by attackers to extract sensitive authentication data. Attackers can use various methods to dump credentials such as exploiting vulnerabilities, keylogging, sniffing network traffic, or using tools like Mimikatz\n**Detection Logic:**\n- Monitor for unusual `auth_type` changes (Kerberos to NTLM)\n- Detect multiple failed authentications followed by successful ones\n- Analyze `source_users` for service accounts performing interactive logons\n- Track `destination_computer` access to domain controllers\n**Mapped TTPs:** T1003 (OS Credential Dumping), T1078 (Valid Accounts)\n**Immediate Action:** Force password resets and audit privileged account access\n\n#### Rule 3: Authentication Anomaly Detection\n**Conceptual Rule:** Detect statistically rare authentication patterns\n**Threat Scenario:** Characterize an anomalous Windows authentication event through statistical rarity assessment\n**Detection Logic:**\n- Establish baseline authentication patterns using `times`, `source_computer`, `destination_computer`\n- Calculate rarity scores for authentication combinations\n- Flag deviations in `logon_type`, `auth_type`, and user behavior\n- Monitor `orientations` for unusual logoff patterns\n**Mapped TTPs:** T1078 (Valid Accounts), TA0008 (Lateral Movement)\n**Immediate Action:** Investigate flagged accounts and implement additional monitoring\n\n### 3.2. SOC Operationalization Guide\n\n**Investigation Playbook:**\n1. **Initial Triage:** Verify alert legitimacy by checking user's typical authentication patterns\n2. **Timeline Analysis:** Construct authentication timeline using `times` field across all involved systems\n3. **Lateral Movement Assessment:** Map authentication flow between `source_computer` and `destination_computer`\n4. **Privilege Analysis:** Examine `source_users` and `destination_users` for privilege escalation\n5. **Impact Assessment:** Determine scope of compromise based on accessed systems and accounts\n6. **Containment:** Isolate affected systems and disable compromised accounts\n7. **Eradication:** Reset credentials, patch vulnerabilities, and remove malicious artifacts\n8. **Recovery:** Restore systems from clean backups and implement additional monitoring\n\n**Proactive Threat Hunting:**\n- Hunt for accounts with anomalous naming conventions, account logon successful transactions in similar patterns on multiple hosts, and account logon failure transactions in similar patterns on multiple hosts\n- Monitor authentication patterns during off-hours and holidays\n- Analyze authentication chains for signs of automated tools\n- Investigate authentication attempts to high-value systems\n\n---\n\n## 4. Threat Intelligence Integration (STIX™ 2.1)\n\n### 4.1. Key Observables & Enrichment Workflow\n\n**Key STIX Cyber Observable Objects:**\n- `source_computer` and `destination_computer` → ipv4-addr, domain-name, or hostname SCOs\n- `source_users` and `destination_users` → user-account SCOs  \n- `times` → timestamp properties in observed-data SCOs\n- `auth_type` and `logon_type` → process or network-traffic SCOs\n\n**Enrichment Workflow:**\n1. **Extract Observables:** Parse authentication logs to extract IP addresses, hostnames, and user accounts\n2. **Create SCOs:** Convert observables to STIX Cyber Observable Objects using the pattern property, which holds the actual detection rule. This pattern can describe various malicious behaviors, such as file hashes, IP addresses, domain names, and registry keys\n3. **TIP Integration:** Query threat intelligence platforms using extracted observables\n4. **Contextualization:** Enrich authentication events with threat actor attribution, campaign associations, and IOC matches\n5. **Relationship Mapping:** Create STIX Relationship Objects linking authentication patterns to known attack patterns\n\n### 4.2. STIX Domain Object Summary\n\n**Indicators:** \nSTIX 2.1 Indicators define patterns for detecting potential malicious activity. Each Indicator contains a pattern property, which holds the actual detection rule\n- Authentication failure rate thresholds\n- Lateral movement authentication chains\n- Credential dumping behavioral patterns\n- Off-hours authentication anomalies\n- Cross-system authentication velocity indicators\n\n**Intrusion Sets:** \nIntrusion sets group all the common properties, capturing multiple campaigns or other activities. These activities share attributes indicating a commonly known or unknown Threat Actor\n- APT groups known for credential-based attacks (APT1, APT29, APT40)\n- Ransomware groups utilizing lateral movement (LockBit, BlackCat, Conti)\n- Financially motivated groups targeting authentication systems\n\n**Vulnerabilities:**\n- CVE-2024-38030 (Windows Themes spoofing vulnerability)\n- CVE-2019-1040 (NTLM authentication bypass)\n- Authentication protocol weaknesses (NTLM downgrade attacks)\n- Session management vulnerabilities\n- Privilege escalation vulnerabilities in authentication systems\n\n**Attack Patterns:** \nAttack Patterns are used to help categorize attacks, generalize specific attacks to the patterns that they follow, and provide detailed information about how attacks are performed. An example of an attack pattern is \"spear phishing\": a common type of attack where an attacker sends a carefully crafted e-mail message\n\nComprehensive list of authentication-related attack patterns:\n- CAPEC-16: Dictionary-based Password Attack\n- CAPEC-49: Password Brute Forcing\n- CAPEC-50: Password Recovery Exploitation\n- CAPEC-55: Rainbow Table Password Cracking\n- CAPEC-70: Try Common or Default Usernames and Passwords\n- CAPEC-112: Brute Force\n- CAPEC-151: Identity Spoofing\n- CAPEC-192: Protocol Manipulation\n- CAPEC-210: Abuse of Functionality\n- CAPEC-244: Cross-Site Scripting via Encoded URI Schemes\n- CAPEC-509: Kerberoasting\n- CAPEC-560: Use of Known Domain Credentials\n- CAPEC-561: Windows Admin Shares with Stolen Credentials\n- CAPEC-565: Password Spraying\n- CAPEC-600: Credential Stuffing\n- CAPEC-645: Use of Captured Hashes (Pass The Hash)\n- CAPEC-652: Use of Known Kerberos Credentials\n- CAPEC-653: Use of Known Operating System Credentials\n\n**Malware Analysis:**\n- Credential harvesting tools (Mimikatz, LaZagne, PwDump)\n- Remote access trojans with authentication bypass capabilities\n- Keyloggers targeting authentication credentials\n- Memory dumping tools for credential extraction\n- Lateral movement frameworks (Cobalt Strike, Empire, Metasploit)\n\n**Course of Actions:**\n- Implement multi-factor authentication\n- Deploy privileged access management solutions\n- Enable advanced authentication logging\n- Implement network segmentation\n- Deploy behavioral analytics for authentication monitoring\n- Establish credential rotation policies\n- Implement just-in-time access controls\n\n**Malware:**\nSTIX objects for malware contain information about malicious software, such as POISON IVY malware with corresponding hash indicators\n- Credential-stealing malware families (Stealerium, RedLine, Raccoon)\n- Banking trojans with authentication bypass (Zeus, Emotet, TrickBot)\n- Ransomware with lateral movement capabilities (LockBit, BlackCat, Ryuk)\n- Remote access tools used for persistence (njRAT, QuasarRAT, AsyncRAT)\n- Living-off-the-land binaries abused for authentication attacks\n\n---",
        "openai": "## Security Analysis Report for the Log Type\n\n## Executive Summary\n\nWindows Authentication Logs are one of the most critical data sources for detecting and investigating adversary behavior, including credential theft, lateral movement, and persistence techniques. This report synthesizes industry and academic research, maps key MITRE ATT&CK® techniques, enumerates observable patterns in authentication events, and provides actionable detection and response guidance. Key recommendations include deploying high-fidelity detection rules for password spraying (T1110.003), pass-the-hash (T1550.002), and Kerberoasting (T1558.003); integrating threat intelligence enrichment of user and host observables via STIX™ 2.1; and operationalizing a SOC playbook to rapidly triage anomalous authentication activities.\n\n---\n\n## 1. Threat Landscape & Adversary Behavior\n\n### 1.1. Current Threat Landscape Research\n\n* **Industry Reporting:**\n  * Mandiant’s M-Trends 2023 report highlights Windows as the most targeted OS and notes a rising use of living-off-the-land tactics—legitimate tools such as RDP and PowerShell—to avoid EDR detection ([securityweek.com](https://www.securityweek.com/mandiant-2023-m-trends-report-provides-factual-analysis-of-emerging-threat-trends/?utm_source=chatgpt.com))([techtarget.com](https://www.techtarget.com/searchsecurity/news/366587481/Mandiant-Ransomware-investigations-up-20-percent?utm_source=chatgpt.com)).\n  * CISA AA24-046A documents threat actors leveraging compromised credentials (T1078.002) of former employees to conduct VPN access and LDAP reconnaissance against domain controllers, enabling lateral movement without MFA ([cisa.gov](https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-046a?utm_source=chatgpt.com)).\n  * CISA AA24-290A describes Iranian-aligned actors performing brute-force (T1110), password spraying (T1110.003), Kerberos SPN enumeration (T1558.003), RDP lateral movement (T1021.001), and MFA fatigue (T1621) attacks in 2024 ([cisa.gov](https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-290a?utm_source=chatgpt.com)).\n\n* **Emerging Vectors:**\n  * “MFA fatigue” or push-bombing attacks have surged, exploiting user-prompt overload to bypass multifactor defenses (T1621) ([cisa.gov](https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-290a?utm_source=chatgpt.com)).\n  * Despite deprecation efforts, NTLM remains widely supported; adversaries continue to use pass-the-hash (T1550.002) and over-pass-the-hash (T1550.004) techniques against misconfigured environments.\n  * Legacy Active Directory features (e.g. Credential Roaming) remain vulnerable to LDAP-based CVE-2022-30170 style file-write attacks, underscoring the need to monitor unusual LDAP attribute access ([cloud.google.com](https://cloud.google.com/blog/topics/threat-intelligence/apt29-windows-credential-roaming?utm_source=chatgpt.com)).\n\n* **Academic Research:**\n  * A Securonix case study proposes a hierarchical Bayesian model to detect rare deviations in per-user authentication counts, achieving stable anomaly detection on Windows event IDs 4624/4625 ([securonix.com](https://www.securonix.com/blog/detecting-windows-authentications-anomalies-with-hierarchical-bayesian-framework/?utm_source=chatgpt.com)).\n  * IIETA published a statistical-rarity assessment approach using feature hashing on Windows Event 4624 to flag uncommon authentication patterns indicative of RDP-based lateral movement ([iieta.org](https://iieta.org/journals/ijsse/paper/10.18280/ijsse.130501?utm_source=chatgpt.com)).\n  * Multiple works (e.g., LogGD) demonstrate the applicability of graph-neural networks for log anomaly detection, but emphasize the need for methods tailored to Windows authentication semantics ([arxiv.org](https://arxiv.org/abs/2209.07869?utm_source=chatgpt.com)).\n\n### 1.2. MITRE ATT&CK® Framework Mapping\n\n* **T1078 – Valid Accounts**  \n  Link: https://attack.mitre.org/techniques/T1078  \n  Relevance: Monitors `source_users` and `statuses` for use of legitimate credentials from unexpected `source_computer` hosts or disabled accounts.  \n\n* **T1110.003 – Password Spraying**  \n  Link: https://attack.mitre.org/techniques/T1110/003  \n  Relevance: Detect repeated `statuses: Failure` across multiple `destination_users` from single `source_computer` within a short `times` window.  \n\n* **T1550.002 – Pass the Hash**  \n  Link: https://attack.mitre.org/techniques/T1550/002  \n  Relevance: Identify successful `auth_type: NTLM` network (`logon_type`) logons without preceding Kerberos authentication on sensitive `destination_computer`.  \n\n* **T1558.003 – Kerberos Service Ticket Extraction (Kerberoasting)**  \n  Link: https://attack.mitre.org/techniques/T1558/003  \n  Relevance: Observe Kerberos (`auth_type`) requests for service principal accounts in `destination_users` outside normal maintenance windows.  \n\n* **T1003.001 – OS Credential Dumping: LSASS Memory**  \n  Link: https://attack.mitre.org/techniques/T1003/001  \n  Relevance: Not directly logged in authentication events but often indicated by subsequent machine-account logons (`source_computer`) with unusual `auth_type`.  \n\n* **T1021.001 – Remote Desktop Protocol**  \n  Link: https://attack.mitre.org/techniques/T1021/001  \n  Relevance: Detect `logon_type: 10 (Interactive)` with remote `source_computer` not matching `destination_computer` IP ranges.  \n\n* **T1621 – Multi-Factor Authentication Request Generation**  \n  Link: https://attack.mitre.org/techniques/T1621  \n  Relevance: Identify high volumes of authentication (`orientations: logon`) attempts with `statuses: Failure` potentially reflecting MFA-push bombardment.  \n\n* **T1110.001 – Brute Force**  \n  Link: https://attack.mitre.org/techniques/T1110/001  \n  Relevance: Multiple consecutive `statuses: Failure` for a single `destination_users` from the same `source_computer`.  \n\n* **T1556.006 – Modify Authentication Process: Multi-Factor Authentication**  \n  Link: https://attack.mitre.org/techniques/T1556/006  \n  Relevance: Look for successful `orientations: logon` events for new `source_computer` registrations under existing `source_users` on ADFS/Okta.  \n\n* **T1078.004 – Valid Accounts: Cloud Accounts**  \n  Link: https://attack.mitre.org/techniques/T1078/004  \n  Relevance: Windows authentication logs correlated with SSO or Azure AD logins for `source_users` on cloud-hosted `destination_computer`.  \n\n---\n\n## 2. Observable Evidence & Patterns \n\n### 2.1.1 Malicious Behavioral/Temporal Patterns\n\n1. **Pattern:** Password Spraying  \n   **Description:** Broad targeting of multiple accounts from one host with low-frequency failures to evade lockout.  \n   **Identifiable Fields:** source_computer, destination_users, statuses, times  \n\n2. **Pattern:** Brute Force Attack  \n   **Description:** Rapid-fire authentication failures against a single account indicating credential guessing.  \n   **Identifiable Fields:** source_computer, destination_users, statuses, times  \n\n3. **Pattern:** Pass-the-Hash  \n   **Description:** Successful NTLM authentication (`auth_type`) on network logons (`logon_type`) without Kerberos fallback.  \n   **Identifiable Fields:** auth_type, logon_type, source_users, destination_computer  \n\n4. **Pattern:** Kerberoasting  \n   **Description:** Unusually high Kerberos service ticket requests for service accounts outside normal usage periods.  \n   **Identifiable Fields:** auth_type, destination_users, times  \n\n5. **Pattern:** Pass-the-Ticket  \n   **Description:** Multiple Kerberos (`auth_type`) logons for high-privilege accounts without prior ticket-granting ticket requests.  \n   **Identifiable Fields:** auth_type, source_users, statuses  \n\n6. **Pattern:** RDP-based Lateral Movement  \n   **Description:** Interactive logons (`logon_type: 10`) from remote hosts not normally accessed by user.  \n   **Identifiable Fields:** logon_type, source_computer, destination_computer, times  \n\n7. **Pattern:** Golden Ticket Use  \n   **Description:** Kerberos logons (`auth_type`) for non-existent or service accounts with no corresponding TGT events.  \n   **Identifiable Fields:** auth_type, destination_users, statuses  \n\n### 2.1.2 Anomalous Behavioral/Temporal Patterns\n\n1. **Pattern:** Impossible Travel  \n   **Description:** Logons for same user from geographically disparate hosts within implausible timeframes.  \n   **Identifiable Fields:** source_computer, source_users, times  \n\n2. **Pattern:** Unusual Protocol Usage  \n   **Description:** NTLM logon events in environments locked to Kerberos-only authentication.  \n   **Identifiable Fields:** auth_type, source_users, times  \n\n3. **Pattern:** Out-of-Hours Logons  \n   **Description:** Successful logons occurring outside established business hours for a given user.  \n   **Identifiable Fields:** times, source_users  \n\n4. **Pattern:** Service Account Interactive Logon  \n   **Description:** Non-service hosts showing interactive (`logon_type: 2`) logons by service accounts.  \n   **Identifiable Fields:** destination_users, logon_type, destination_computer  \n\n5. **Pattern:** Account Lockout Storm  \n   **Description:** Multiple failure events followed by a lockout (event ID 4740) within a short period.  \n   **Identifiable Fields:** statuses, source_users, times  \n\n6. **Pattern:** New Host Access  \n   **Description:** First-time successful logon by a user to a host in their typical domain scope.  \n   **Identifiable Fields:** source_computer, source_users, times  \n\n7. **Pattern:** Orphaned Logoff  \n   **Description:** Logon events with no subsequent logoff (`orientations`) indicating potential persistence.  \n   **Identifiable Fields:** orientations, times  \n\n### 2.1.3 Vulnerable Behavioral/Temporal Patterns\n\n1. **Pattern:** Legacy Protocol Fall-back  \n   **Description:** Use of LM or NTLMv1 protocols despite policy disabling them.  \n   **Identifiable Fields:** auth_type, statuses  \n\n2. **Pattern:** Shared Account Across Hosts  \n   **Description:** Same account logging into multiple unrelated hosts simultaneously.  \n   **Identifiable Fields:** source_computer, source_users, times  \n\n3. **Pattern:** Disabled Account Attempts  \n   **Description:** Authentication failures (`statuses: Failure`) for known-disabled accounts.  \n   **Identifiable Fields:** source_users, statuses  \n\n4. **Pattern:** Excessive Failure Noise  \n   **Description:** High volume of failed logons from one host without any successes, indicating misconfiguration or reconnaissance.  \n   **Identifiable Fields:** source_computer, statuses, times  \n\n5. **Pattern:** Default Credential Usage  \n   **Description:** Attempts to log on with default or well-known account names (e.g., “Administrator”, “Guest”).  \n   **Identifiable Fields:** destination_users, statuses  \n\n6. **Pattern:** Non-Rotating Service Account Logon  \n   **Description:** Long-lived service accounts authenticating interactively at irregular intervals.  \n   **Identifiable Fields:** destination_users, times, logon_type  \n\n### 2.2. Key Indicators of Compromise (IOCs)\n\n* **Source Hostnames:** Unrecognized or unusual `source_computer` identifiers may indicate attacker-controlled systems.  \n* **Destination Hostnames:** Access attempts to critical servers (`destination_computer`), especially domain controllers.  \n* **Usernames:** Compromised or service accounts (`source_users`/`destination_users`) involved in anomalous logons.  \n* **Authentication Protocols:** NTLM vs Kerberos (`auth_type`) divergence from normal baselines.  \n* **Logon Types:** Elevated remote interactive (`logon_type: 10`) vs console access.  \n* **Timestamps:** Off-hours or rapid successive events in `times` indicating brute force or reconnaissance.  \n* **Event Outcomes:** Repeated failures followed by success (`statuses`) indicating credential stuffing.  \n\n---\n\n## 3. Actionable Detection & Response\n\n### 3.1. Detection Logic\n\n#### Rule 1: Detect Password Spraying  \n* **Conceptual Rule:** Count failed `statuses` per `source_computer` across ≥ 10 unique `destination_users` within 5 minutes.  \n* **Detection Logic:**  \n  - Filter events where `statuses: Failure` and `times` in a rolling 5-minute window  \n  - Aggregate by `source_computer`, count distinct `destination_users`  \n  - Alert if count ≥ 10  \n* **Mapped TTPs:** T1110.003  \n* **Immediate Action:** Block or isolate `source_computer`; force password reset for targeted accounts.  \n\n#### Rule 2: Identify Pass-the-Hash  \n* **Conceptual Rule:** Successful logon where `auth_type: NTLM`, `logon_type: 3 (Network)`, and destination account is high-privilege.  \n* **Detection Logic:**  \n  - Filter events where `auth_type == \"NTLM\"` AND `logon_type == \"Network\"` AND `statuses == \"Success\"`  \n  - Destination account in privileged group list  \n* **Mapped TTPs:** T1550.002  \n* **Immediate Action:** Invalidate NTLM hashes; rotate high-privilege credentials; investigate `source_computer`.  \n\n#### Rule 3: Flag Kerberoasting Attempts  \n* **Conceptual Rule:** ≥ 5 Kerberos (`auth_type`) service ticket requests for a single `destination_users` within 10 minutes.  \n* **Detection Logic:**  \n  - Filter events where `auth_type == \"Kerberos\"` AND `destination_users` is a service account  \n  - Aggregate by `destination_users`, count in rolling 10-minute window  \n  - Alert if count ≥ 5  \n* **Mapped TTPs:** T1558.003  \n* **Immediate Action:** Review delegation settings; reset service account passwords; monitor for subsequent cracks.  \n\n#### Rule 4: RDP Lateral Movement  \n* **Conceptual Rule:** Interactive logon (`logon_type: 10`) from non-standard `source_computer` to domain workstations/servers.  \n* **Detection Logic:**  \n  - Filter where `logon_type == \"Interactive\"` AND `source_computer` not in baseline list for user  \n* **Mapped TTPs:** T1021.001  \n* **Immediate Action:** Quarantine `source_computer`; require MFA for RDP; investigate user activity.  \n\n#### Rule 5: MFA Fatigue Attack  \n* **Conceptual Rule:** ≥ 20 failed MFA-associated `statuses` for same `source_users` in 1 hour.  \n* **Detection Logic:**  \n  - Correlate authentication events with MFA challenge outcome logs  \n  - Aggregate failure count by `source_users`  \n  - Alert if count ≥ 20 in 60 minutes  \n* **Mapped TTPs:** T1621  \n* **Immediate Action:** Temporarily block user; require out-of-band MFA re-enrollment; monitor for compromise.  \n\n### 3.2. SOC Operationalization Guide\n\n* **Investigation Playbook:**\n  1. **Alert Triage:** Review event details—`source_computer`, `destination_users`, `auth_type`, `logon_type`, `statuses`, and `times`.  \n  2. **Contextual Enrichment:** Pull host asset info, user risk scores, and recent authentications.  \n  3. **Pivot & Hunt:** Search for related events in +/- 1 hour across hosts for same user or host.  \n  4. **Containment:** Isolate suspicious hosts; enforce password resets or MFA re-enrollment on implicated accounts.  \n  5. **Remediation:** Patch and harden authentication protocols; disable legacy NTLM/LM; rotate credentials.  \n\n* **Proactive Threat Hunting:**\n  - Query for interactive logons on service accounts outside business hours.  \n  - Identify sudden spikes in Kerberos ticket requests.  \n  - Search for new source_computer entries authenticating to domain controllers.  \n\n---\n\n## 4. Threat Intelligence Integration (STIX™ 2.1)\n\n### 4.1. Key Observables & Enrichment Workflow\n\n* **Key Fields as Cyber Observable Objects:**\n  - `source_computer` → host  \n  - `destination_computer` → host  \n  - `source_users` → user-account  \n  - `destination_users` → user-account  \n  - `auth_type` → observed-data attribute  \n  - `logon_type` → observed-data attribute  \n  - `times` → timestamp  \n\n* **Enrichment Workflow:**\n  1. Ingest Windows Authentication Logs; extract STIX cyber-observable objects for each field.  \n  2. Push to TIP for automated enrichment: host reputation, geolocation, domain age.  \n  3. Link `user-account` objects to threat intelligence on compromised credentials from prior breaches.  \n  4. Generate STIX `Indicator` objects for confirmed malicious patterns and share across SOC.  \n\n### 4.2. STIX Domain Object Summary\n\n* **Indicators:** Unusual NTLM network logons, high-frequency service ticket requests, MFA fatigue patterns.  \n* **Intrusion Sets:** APT29 (NOBELIUM), Iranian cyber actors (per AA24-290A), Unit 29155 (GRU) ([picussecurity.com](https://www.picussecurity.com/resource/blog/cisa-alert-aa24-249a-russian-military-cyber-actors-target-us-and-global-critical-infrastructure?utm_source=chatgpt.com)).  \n* **Vulnerabilities:** CVE-2022-30170 (Credential Roaming), legacy NTLM/LM fallback.  \n* **Attack Patterns:** T1078, T1110.001/003, T1550.002/003/004, T1558.003, T1003.001/002, T1021.001, T1621, T1556.006.  \n* **Malware:** Beacon, SystemBC, HiveLocker, Qakbot (noted in M-Trends 2023) ([securityweek.com](https://www.securityweek.com/mandiant-2023-m-trends-report-provides-factual-analysis-of-emerging-threat-trends/?utm_source=chatgpt.com)).  \n* **Course of Actions:** Enforce Kerberos-only, deprecate NTLM, require MFA, isolate suspicious hosts, credential rotation.  \n* **Intrusion Sets:** #repeated as above for emphasis.  \n\n---\n\n*No relevant information found during the search for additional academic publications specifically focusing on novel vulnerabilities in Windows authentication logs beyond those cited.*",
        "gemini": "# Security Analysis Report for the Log Type\n\n## Executive Summary\n\nThis report provides a comprehensive security analysis of **Windows Authentication Logs**, a critical data source for detecting and responding to a wide array of cyber threats. These logs are fundamental to security monitoring as they capture the core of user and system activity within a Windows environment: every logon, logoff, and authentication attempt.\n\nThe primary threats detectable through these logs include **lateral movement**, where adversaries use compromised credentials to move between systems, and **credential dumping**, the act of stealing usernames and passwords from memory. Analysis of Windows authentication events is crucial for identifying techniques such as Pass-the-Hash, brute-force attacks, and the abuse of legitimate administrative tools.\n\nKey recommendations from this report include implementing robust audit policies to ensure necessary events are logged, centralizing log collection for correlation, and developing specific detection rules to identify anomalous patterns. This report provides detailed behavioral patterns to hunt for, actionable detection logic for Security Operations Centers (SOCs), and a guide for integrating findings with threat intelligence platforms using the STIX 2.1 framework. By leveraging the insights within this report, organizations can significantly enhance their ability to detect attacker activity, mitigate risks associated with compromised credentials, and improve their overall security posture.\n\n---\n\n## 1. Threat Landscape & Adversary Behavior\n\n### 1.1. Current Threat Landscape Research\n\n*   **Industry Reporting:**\n    Recent industry analysis from 2023-2024 highlights a persistent focus by adversaries on exploiting Windows authentication mechanisms. A notable trend is the abuse of NTLM, a legacy authentication protocol that remains a critical fallback in many Windows environments. Attackers actively seek to trigger NTLM authentication leaks, particularly from applications like Microsoft Outlook, to capture hashes for use in Pass-the-Hash attacks, enabling lateral movement and privilege escalation without needing the plaintext password. Furthermore, credential dumping, especially from the Local Security Authority Subsystem Service (LSASS) process, remains a primary technique for attackers once they gain administrative privileges on a host. This allows them to harvest credentials for widespread network compromise. Reports also emphasize that adversaries leverage legitimate tools like PsExec, WMI, and scheduled tasks to move laterally, making detection difficult as this activity can blend with normal administrative behavior.\n\n*   **Emerging Vectors:**\n    A significant emerging vector involves vulnerabilities that bypass existing security features in authentication protocols. For instance, **CVE-2024-20674** is a critical vulnerability in Windows Kerberos that allows an attacker to perform a machine-in-the-middle (MITM) attack to impersonate a Kerberos authentication server, thereby bypassing security features. Another area of concern is the exploitation of certificate-based authentication. Vulnerabilities like **CVE-2022-26931** and **CVE-2022-26923** allow for privilege escalation because the Key Distribution Center (KDC) improperly handled certificate-based authentication requests, enabling attackers to spoof identities. Microsoft is actively working to reduce reliance on NTLM and strengthen Kerberos with features like IAKerb and a local KDC to close these security gaps.\n\n*   **Academic Research:**\n    Academic research from 2023 has explored novel methods for enhancing Windows authentication security. One study proposes a location-based authentication method using WiFi signal classification to create a non-intrusive, multi-factor authentication layer for the Windows OS. This approach aims to add contextual security by verifying the user's physical location. Other research focuses on applying machine learning, specifically Convolutional Neural Networks (CNNs), to Intrusion Detection Systems (IDS) for analyzing network traffic related to authentication, achieving high accuracy in detecting threats. These studies indicate a move towards more dynamic and intelligent authentication and threat detection mechanisms beyond traditional log analysis.\n\n### 1.2. MITRE ATT&CK® Framework Mapping\n\nWindows Authentication Logs are a primary data source for detecting a wide range of adversary tactics and techniques. The fields provided directly map to observable actions within the ATT&CK framework.\n\n*   **T1078 – Valid Accounts:**\n    *   **Relevance:** This is the most fundamental technique related to authentication logs. Adversaries use legitimate credentials to gain access and move laterally. Differentiating malicious use from normal activity is a key challenge.\n    *   **Identifiable Fields:** `source_users`, `destination_users`, `source_computer`, `destination_computer`, `logon_type`, `statuses`. A successful logon (`statuses`: \"Success\") from an unusual `source_computer` or at an anomalous time (`times`) for a specific `source_users` can indicate abuse.\n\n*   **T1110 – Brute Force:**\n    *   **Relevance:** Adversaries attempt to guess passwords for accounts. This technique includes methods like password spraying (one password against many accounts) and credential stuffing (many passwords against one account).\n    *   **Identifiable Fields:** `destination_users`, `source_computer`, `statuses`. A high volume of failed logon events (`statuses`: \"Failure\") from a single `source_computer` targeting one or multiple `destination_users` is a strong indicator.\n\n*   **T1550 – Use Alternate Authentication Material:**\n    *   **Relevance:** This technique involves using stolen authentication materials like hashes or tickets instead of plaintext passwords. Pass-the-Hash and Pass-the-Ticket are common sub-techniques.\n    *   **Identifiable Fields:** `source_users`, `destination_computer`, `logon_type`, `auth_type`. A successful network logon (`logon_type`: \"3\") using NTLM (`auth_type`: \"NTLM\") where the user has not recently logged on interactively to the `source_computer` can indicate a Pass-the-Hash attack.\n\n*   **T1558 – Steal or Forge Kerberos Tickets:**\n    *   **Relevance:** Adversaries can steal Kerberos tickets to impersonate users. This includes techniques like Kerberoasting, where an attacker requests service tickets for accounts with weak passwords to crack them offline.\n    *   **Identifiable Fields:** `source_users`, `destination_users`, `auth_type`. A spike in Kerberos service ticket requests (`auth_type`: \"Kerberos\") from a single `source_computer` or for unusual `destination_users` (service accounts) can be an indicator.\n\n*   **T1003 – OS Credential Dumping:**\n    *   **Relevance:** While the dumping action itself is often observed through process creation logs, the *use* of the dumped credentials manifests in authentication logs. After dumping credentials from LSASS, an attacker will use them to authenticate to other systems.\n    *   **Identifiable Fields:** `source_users`, `destination_users`, `source_computer`, `destination_computer`. A successful logon from a user to a new `destination_computer` shortly after suspicious process activity (like accessing lsass.exe) on the `source_computer` is a key correlation.\n\n*   **T1021 – Remote Services:**\n    *   **Relevance:** Adversaries use remote services like RDP, WinRM, and SMB/Windows Admin Shares to execute code and move laterally. These actions generate authentication events.\n    *   **Identifiable Fields:** `destination_computer`, `source_computer`, `source_users`, `logon_type`. A logon with `logon_type` \"10\" (RemoteInteractive/RDP) or \"3\" (Network) from a workstation (`source_computer`) to another workstation or server (`destination_computer`) by a user who does not typically perform such actions is suspicious.\n\n---\n\n## 2. Observable Evidence & Patterns\n\n### 2.1.1 Malicious Behavioral/Temporal Patterns\n\n*   **Pattern:** High Volume of Failed Logons (Brute Force)\n    *   **Description:** A large number of failed logon attempts from a single source computer targeting one or more destination users in a short time frame. This is a classic indicator of a brute-force or password spraying attack.\n    *   **Identifiable Fields:** `source_computer`, `destination_users`, `statuses`, `times`.\n\n*   **Pattern:** Successful Logon After Multiple Failures\n    *   **Description:** A sequence of failed logon events (`statuses`: \"Failure\") followed immediately by a successful logon (`statuses`: \"Success\") for the same user. This can indicate a successful password guessing attempt.\n    *   **Identifiable Fields:** `destination_users`, `source_computer`, `statuses`, `times`.\n\n*   **Pattern:** NTLM Logon for Remote Administrative Access (Pass-the-Hash)\n    *   **Description:** A successful network logon (`logon_type`: 3) using NTLM authentication (`auth_type`: \"NTLM\") by an administrative account to a remote system. Kerberos is expected for legitimate domain admin activity; NTLM usage can suggest a Pass-the-Hash attack.\n    *   **Identifiable Fields:** `source_users`, `destination_computer`, `logon_type`, `auth_type`, `statuses`.\n\n*   **Pattern:** Lateral Movement via Remote Interactive Logon\n    *   **Description:** A user account logging on to multiple workstations or servers via Remote Desktop (`logon_type`: 10) in rapid succession. This is highly indicative of an attacker exploring the network.\n    *   **Identifiable Fields:** `source_users`, `destination_computer`, `logon_type`, `times`.\n\n*   **Pattern:** Logon with Explicit Credentials by Unexpected Account\n    *   **Description:** An event (ID 4648) showing that a user or process used the credentials of a *different* user to access a resource. This is common in \"runas\" scenarios but is suspicious when the source or target user is unexpected, often indicating lateral movement.\n    *   **Identifiable Fields:** `source_users`, `destination_users`, `source_computer`, `destination_computer`.\n\n*   **Pattern:** First-time Logon from a User to a Critical Server\n    *   **Description:** A user account that has never logged into a specific critical asset (like a domain controller or database server) before suddenly authenticates successfully.\n    *   **Identifiable Fields:** `source_users`, `destination_computer`, `statuses`.\n\n*   **Pattern:** Service Account Interactive Logon\n    *   **Description:** A service account, which should only perform automated tasks and network logons (`logon_type`: 5 or 3), performs an interactive logon (`logon_type`: 2) or remote interactive logon (`logon_type`: 10). This is highly anomalous and suggests account compromise.\n    *   **Identifiable Fields:** `source_users`, `logon_type`.\n\n### 2.1.2 Anomalous Behavioral/Temporal Patterns\n\n*   **Pattern:** Impossible Travel\n    *   **Description:** A single user account successfully authenticates from two geographically distant `source_computer` locations in a time frame that would be impossible to travel between.\n    *   **Identifiable Fields:** `source_users`, `source_computer` (requires IP/geolocation mapping), `times`.\n\n*   **Pattern:** Off-Hours Authentication\n    *   **Description:** A user account authenticates at unusual times, such as late at night or on weekends, contrary to their established baseline of activity.\n    *   **Identifiable Fields:** `source_users`, `times`.\n\n*   **Pattern:** Multiple Users Logged into a Single Workstation\n    *   **Description:** Multiple distinct user accounts are concurrently logged onto a standard end-user workstation within a short time window. This is abnormal for typical user behavior.\n    *   **Identifiable Fields:** `destination_computer`, `source_users`, `times`, `orientations`.\n\n*   **Pattern:** Same User Logged into Multiple Hosts Simultaneously\n    *   **Description:** A single user account shows active logon sessions on a large number of different computers simultaneously. While some roaming is normal, a widespread pattern can indicate credential abuse.\n    *   **Identifiable Fields:** `source_users`, `destination_computer`, `times`, `orientations`.\n\n*   **Pattern:** Excessive Logoff/Logon Activity\n    *   **Description:** An abnormally high frequency of logon and logoff events (`orientations`) for a single user or on a single machine, which could indicate scripted activity or an unstable connection being exploited.\n    *   **Identifiable Fields:** `source_users`, `destination_computer`, `orientations`, `times`.\n\n*   **Pattern:** Authentication from Non-Standard Hostname\n    *   **Description:** Authentication attempts originating from a `source_computer` with a hostname that does not conform to the organization's standard naming convention.\n    *   **Identifiable Fields:** `source_computer`.\n\n*   **Pattern:** Sudden Spike in Kerberos Ticket Requests\n    *   **Description:** A sudden, anomalous increase in Kerberos ticket requests (Event ID 4768/4769), especially from a single host, which could indicate reconnaissance or a Kerberoasting attack.\n    *   **Identifiable Fields:** `source_computer`, `auth_type`, `times`.\n\n### 2.1.3 Vulnerable Behavioral/Temporal Patterns\n\n*   **Pattern:** Use of Weak Kerberos Encryption (RC4/DES)\n    *   **Description:** Authentication events show the use of weak or deprecated Kerberos encryption types like RC4 or DES. This makes credentials susceptible to offline cracking and is a significant hygiene issue.\n    *   **Identifiable Fields:** `auth_type`, (Requires deeper event data for encryption type).\n\n*   **Pattern:** Excessive NTLMv1 Authentication\n    *   **Description:** The continued use of the outdated and insecure NTLMv1 protocol. NTLMv1 is highly vulnerable to relay and cracking attacks and should be disabled.\n    *   **Identifiable Fields:** `auth_type`.\n\n*   **Pattern:** Accounts with No Pre-Authentication Required\n    *   **Description:** Kerberos pre-authentication is a security feature that helps prevent offline password cracking. An authentication attempt for an account where this is disabled is a vulnerability. This is often detected via Kerberos event logs (4768).\n    *   **Identifiable Fields:** (Requires specific Kerberos event data not in the provided fields, but is a key related pattern).\n\n*   **Pattern:** Cleartext Password Submission over Network\n    *   **Description:** Some configurations might allow passwords to be sent in cleartext, which would be logged in certain events (e.g., if WDigest is enabled). This is a critical vulnerability.\n    *   **Identifiable Fields:** (Requires specific event data, such as Event ID 4624 with detailed logon process info).\n\n*   **Pattern:** Privileged Account Logon to a Workstation\n    *   **Description:** A domain administrator or other highly privileged account (`source_users`) logs on to a standard user workstation (`destination_computer`). This increases the risk of credential theft via LSASS dumping.\n    *   **Identifiable Fields:** `source_users`, `destination_computer`, `logon_type`.\n\n*   **Pattern:** Authentication from a Device with Known Vulnerabilities\n    *   **Description:** A successful authentication from a `source_computer` that is known to be unpatched or have critical vulnerabilities. This indicates a high-risk entry point.\n    *   **Identifiable Fields:** `source_computer`.\n\n### 2.2. Key Indicators of Compromise (IOCs)\n\n*   **Suspicious Source Hostnames:**\n    *   **Description:** Hostnames that do not conform to internal naming conventions, are randomly generated, or are known to be associated with malicious tools. This can indicate an unauthorized device on the network.\n\n*   **Anomalous User Agent Strings (in web-based authentication):**\n    *   **Description:** While not in the provided fields, web authentication logs often contain User-Agent strings. Those associated with scripting tools (PowerShell, Python requests) instead of web browsers can indicate automated attacks.\n\n*   **Known Malicious Source IP Addresses:**\n    *   **Description:** Authentication attempts originating from IP addresses listed on threat intelligence feeds as being malicious, command-and-control (C2) servers, or Tor exit nodes.\n    *   **Identifiable Fields:** `source_computer` (when it's an IP).\n\n*   **Use of Common Hacking/Admin Tool Names as Usernames/Hostnames:**\n    *   **Description:** Usernames or hostnames that match the names of common penetration testing or administration tools (e.g., \"mimikatz\", \"psexec\", \"kali\").\n\n*   **Suspicious Service Names:**\n    *   **Description:** When credential dumping or persistence is attempted via service creation (Event ID 4697), the service name may be random or attempt to masquerade as a legitimate service.\n\n*   **Suspicious Process Names Accessing LSASS:**\n    *   **Description:** While not a direct authentication log IOC, it's a critical correlated indicator. Processes like `procdump.exe` or `rundll32.exe` accessing the LSASS process are a hallmark of credential dumping. The credentials stolen are then used in attacks visible in authentication logs.\n\n---\n\n## 3. Actionable Detection & Response\n\n### 3.1. Detection Logic\n\n#### Rule 1: Potential Brute-Force or Password Spraying Attack\n*   **Conceptual Rule:**\n    *   **Threat Scenario:** An attacker is attempting to guess user credentials through brute force (many passwords for one user) or password spraying (one password for many users).\n    *   **Detection Logic:** Alert when a single `source_computer` generates more than 20 failed logon events (`statuses`: \"Failure\") within a 5-minute window. Group by `source_computer`. A lower threshold (e.g., 5 failures) targeting more than 50 distinct `destination_users` can specifically detect password spraying.\n    *   **Mapped TTPs:** T1110 (Brute Force)\n    *   **Immediate Action:** Temporarily block the `source_computer` IP at the firewall. Investigate the source for signs of compromise. Notify the targeted users if a specific account is being attacked.\n\n#### Rule 2: Successful Logon Immediately Following Failed Attempts\n*   **Conceptual Rule:**\n    *   **Threat Scenario:** An attacker successfully guesses a password after multiple attempts.\n    *   **Detection Logic:** Alert when a successful logon event (`statuses`: \"Success\") for a `destination_users` from a specific `source_computer` is preceded by 5 or more failed logon events for the same user from the same source within the last 15 minutes.\n    *   **Mapped TTPs:** T1110 (Brute Force), T1078 (Valid Accounts)\n    *   **Immediate Action:** Isolate the `destination_computer`. Force a password reset for the compromised `destination_users` and expire all active sessions.\n\n#### Rule 3: Potential Pass-the-Hash (PtH) Activity\n*   **Conceptual Rule:**\n    *   **Threat Scenario:** An attacker is using a stolen NTLM hash to authenticate to a remote system, bypassing the need for a password.\n    *   **Detection Logic:** Alert on a successful network logon (`logon_type`: 3) that uses NTLM authentication (`auth_type`: \"NTLM\") for a privileged user account (`source_users`) to a `destination_computer` where that user has no prior interactive logon history.\n    *   **Mapped TTPs:** T1550.002 (Use Alternate Authentication Material: Pass the Hash)\n    *   **Immediate Action:** Isolate the `source_computer` and `destination_computer`. Investigate the `source_computer` for signs of credential dumping. Expire all sessions for the user account involved.\n\n#### Rule 4: Anomalous Remote Desktop (RDP) Logon\n*   **Conceptual Rule:**\n    *   **Threat Scenario:** An attacker is moving laterally between hosts using RDP.\n    *   **Detection Logic:** Alert when a user account (`source_users`) initiates a remote interactive logon (`logon_type`: 10) to a `destination_computer` that is not on a pre-approved list of administrative jump boxes or servers for that user. Also, alert if a user logs into more than 5 distinct hosts via RDP within one hour.\n    *   **Mapped TTPs:** T1021.001 (Remote Services: Remote Desktop Protocol), T1078 (Valid Accounts)\n    *   **Immediate Action:** Validate the activity with the user. If suspicious, isolate the `destination_computer` and investigate the `source_computer` for compromise.\n\n#### Rule 5: Service Account Interactive Logon\n*   **Conceptual Rule:**\n    *   **Threat Scenario:** A service account has been compromised and is being used by an attacker for interactive access.\n    *   **Detection Logic:** Alert whenever an account known to be a service account (based on naming convention or group membership) generates a logon event with `logon_type` 2 (Interactive) or 10 (Remote Interactive).\n    *   **Mapped TTPs:** T1078 (Valid Accounts)\n    *   **Immediate Action:** Immediately disable the service account. Isolate the `destination_computer` where the logon occurred. Investigate for persistence and further malicious activity. Initiate a password rotation for all service accounts.\n\n### 3.2. SOC Operationalization Guide\n\n*   **Investigation Playbook:**\n    1.  **Triage Alert:** Immediately assess the alert's context. Identify the `source_users`, `source_computer`, and `destination_computer`. Note the `logon_type`, `auth_type`, and `statuses`.\n    2.  **Correlate Activity:** Pivot on the key fields (`source_users`, `source_computer`, `times`). Look for other related security events immediately preceding or following the alert. Did a process creation alert for `procdump.exe` fire on the `source_computer`? Is there subsequent network traffic to a known malicious IP?\n    3.  **Establish Baseline:** Quickly determine if this is normal behavior. Has this `source_users` logged in from this `source_computer` before? Is the `logon_type` typical for this user? Check against historical log data.\n    4.  **Contain the Threat:** If the activity is deemed malicious, take immediate containment actions. Isolate the involved hosts from the network. Disable the compromised user account.\n    5.  **Investigate and Eradicate:** Perform forensic analysis on the affected systems to understand the full scope of the compromise. Identify the initial access vector, check for persistence mechanisms, and remove all attacker artifacts.\n    6.  **Recover and Report:** Restore systems from clean backups, reset all potentially compromised credentials, and document the incident, including the timeline, impact, and remediation steps.\n\n*   **Proactive Threat Hunting:**\n    *   **Hypothesis 1 (Lateral Movement):** Search for users (`source_users`) with successful network (`logon_type`: 3) or remote interactive (`logon_type`: 10) logons to an unusually high number of distinct hosts (`destination_computer`) within a 24-hour period. Filter out administrative and service accounts that are expected to do this.\n    *   **Hypothesis 2 (Anomalous Credentials):** Hunt for successful logons (`statuses`: \"Success\") that use explicit credentials (`EventID 4648`) where the `source_users` is different from the `destination_users`. Investigate any instances that aren't related to legitimate administrative tasks.\n    *   **Hypothesis 3 (NTLM Abuse):** Periodically review all successful NTLM authentication (`auth_type`: \"NTLM\"). Is it being used where Kerberos should be? Are privileged accounts using it to access workstations? This can uncover both hygiene issues and active attacks.\n\n---\n\n## 4. Threat Intelligence Integration (STIX™ 2.1)\n\n### 4.1. Key Observables & Enrichment Workflow\n\nThe following fields from the Windows Authentication Log can be extracted as STIX Cyber Observable Objects for threat intelligence enrichment:\n\n*   **source_computer:** Can be mapped to `ipv4-addr`, `ipv6-addr`, or `domain-name` objects.\n*   **destination_computer:** Can be mapped to `ipv4-addr`, `ipv6-addr`, or `domain-name` objects.\n*   **source_users:** Can be mapped to a `user-account` object, with the `account_login` property populated.\n*   **destination_users:** Can be mapped to a `user-account` object.\n\n**Enrichment Workflow:**\n\n1.  **Extraction:** When a suspicious event is detected, an automated workflow or analyst extracts the key observables (e.g., the `source_computer` IP address and the `destination_users` account name).\n2.  **Pivot to TIP:** The extracted observables are used to query a Threat Intelligence Platform (TIP). For example, the `source_computer` IP address is checked against IP reputation feeds.\n3.  **Contextual Enrichment:** The TIP returns any related intelligence, such as:\n    *   Is the IP address a known C2 server, part of a botnet, or a Tor node? (STIX `Indicator` object).\n    *   Has this IP address been associated with a specific threat actor? (STIX `Intrusion Set` object).\n    *   Has this `user-account` been seen in credential dumps?\n4.  **Decision & Action:** The enriched data provides context to the analyst, helping them determine the alert's severity and priority. A logon from an IP associated with an APT group (`Intrusion Set`) is far more critical than one from an unknown source. This intelligence informs the response actions outlined in the SOC playbook.\n\n### 4.2. STIX Domain Object Summary\n\n*   **Indicators:**\n    *   An IP address (`ipv4-addr`) consistently failing to authenticate against multiple accounts indicates a brute-force attack.\n    *   A logon (`logon_type`: 3) using NTLM (`auth_type`: \"NTLM\") from a non-standard workstation to a domain controller indicates potential Pass-the-Hash.\n    *   A user account (`user-account`) authenticating from two geographically impossible locations in a short time (`pattern: \"impossible-travel\"`) indicates a compromised account.\n\n*   **Intrusion Sets:**\n    *   Groups like **FIN6** and **APT29** are known to leverage stolen credentials for lateral movement. An authenticated session originating from an IP address associated with these groups would be a high-confidence indicator of a targeted attack.\n\n*   **Vulnerabilities:**\n    *   **CVE-2024-20674:** A security feature bypass vulnerability in Windows Kerberos.\n    *   **CVE-2022-26931:** An elevation of privilege vulnerability related to certificate-based authentication.\n    *   **NTLM Relay Vulnerabilities:** A class of vulnerabilities where an attacker can relay NTLM authentication challenges to gain unauthorized access.\n\n*   **Attack Patterns:**\n    *   **Brute Force (T1110):** Repeatedly attempting to guess credentials.\n    *   **Password Spraying (T1110.003):** Using a small list of common passwords against many accounts.\n    *   **Pass the Hash (T1550.002):** Using a stolen NTLM hash to authenticate.\n    *   **Pass the Ticket (T1550.003):** Using a stolen Kerberos ticket to authenticate.\n    *   **Kerberoasting (T1558.003):** Requesting service tickets for accounts to crack their passwords offline.\n    *   **Remote Services: Remote Desktop Protocol (T1021.001):** Using RDP to move between systems.\n    *   **Valid Accounts (T1078):** Abusing legitimate credentials to blend in with normal network traffic.\n    *   **OS Credential Dumping: LSASS Memory (T1003.001):** Stealing credentials from the LSASS process memory.\n\n*   **Malware:**\n    *   **Mimikatz:** A post-exploitation tool widely used to dump credentials from memory (LSASS), which are then used in attacks visible in authentication logs.\n    *   **PsExec:** A legitimate system administration tool that is frequently abused by attackers to execute commands and move laterally using authenticated sessions.\n\n*   **Course of Actions:**\n    *   **Enforce Multi-Factor Authentication (MFA):** Require MFA for all user accounts, especially privileged ones, to mitigate the impact of stolen credentials.\n    *   **Disable Legacy Protocols:** Disable NTLMv1 and, where possible, restrict or disable NTLM entirely in favor of Kerberos.\n    *   **Implement Strong Password Policies:** Enforce password complexity, length, and history requirements to make brute-force attacks more difficult.\n    *   **Restrict Privileged Account Access:** Limit administrative accounts to specific, hardened administrative workstations or jump servers to reduce the risk of credential theft.\n    *   **Centralize Log Collection:** Aggregate Windows Authentication logs from all endpoints and domain controllers into a central SIEM for effective correlation and analysis.\n\n---"
      },
      "confidence": 0.8,
      "processing_time": 474.43632674217224,
      "method_used": "multi_model_prompt2",
      "source_files": [
        "output_v3\\stage3_prompt2\\claude_report.md",
        "output_v3\\stage3_prompt2\\openai_report.md",
        "output_v3\\stage3_prompt2\\gemini_report.md"
      ],
      "metadata": {
        "reports_generated": 3,
        "input_consensus_confidence": 0.3884615384615384
      }
    },
    "stage4_prompt3": {
      "stage_name": "stage4_prompt3",
      "content": {
        "gemini_from_claude_report": {
          "parsed_json": {
            "Log_context": {
              "log_type": "Windows Authentication Log",
              "log_description": "Windows Authentication Logs are a critical data source for detecting advanced persistent threats, lateral movement, and credential-based attacks. They provide visibility into authentication patterns, enabling the detection of techniques like pass-the-hash, credential dumping, privilege escalation, and lateral movement. The analyzed fields form a comprehensive framework for identifying malicious activity."
            },
            "observations": {
              "behavioral_patterns": {
                "malicious": [
                  {
                    "pattern_name": "Rapid Cross-System Authentication",
                    "Instruction": "Authentication events over the network from rare or unusual hosts or users using EventCode 4624 with LogonType 3 (network connection) occurring within short time windows across multiple systems.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "destination_computer: List",
                      "times: List",
                      "source_users: List",
                      "destination_users: List",
                      "logon_type: List"
                    ]
                  },
                  {
                    "pattern_name": "Pass-the-Hash Authentication Anomalies",
                    "Instruction": "Attackers leverage hashed credentials (NTLM hashes) or Kerberos tickets to authenticate on other systems without needing the plaintext passwords. These techniques are commonly used to escalate privileges and move laterally between high-value systems.",
                    "identifiable_fields": [
                      "auth_type: List",
                      "destination_users: List",
                      "source_computer: List",
                      "destination_computer: List",
                      "statuses: List"
                    ]
                  },
                  {
                    "pattern_name": "Privilege Escalation Authentication Chains",
                    "Instruction": "Sequential authentication events showing escalation from standard user to administrative accounts across systems.",
                    "identifiable_fields": [
                      "source_users: List",
                      "destination_users: List",
                      "times: List",
                      "orientations: List",
                      "statuses: List"
                    ]
                  },
                  {
                    "pattern_name": "Credential Stuffing Attack Signatures",
                    "Instruction": "Malicious actors routinely use the NTLM authentication protocol to carry out account enumeration and brute force-styled attacks to compromise accounts within a victim's network. Once inside, an attacker can gain persistence, exfiltrate sensitive data, and unleash ransomware.",
                    "identifiable_fields": [
                      "source_users: List",
                      "destination_users: List",
                      "statuses: List",
                      "times: List",
                      "auth_type: List"
                    ]
                  },
                  {
                    "pattern_name": "Service Account Abuse",
                    "Instruction": "Legitimate service accounts being used for interactive logons or accessing resources outside their normal scope.",
                    "identifiable_fields": [
                      "source_users: List",
                      "destination_users: List",
                      "logon_type: List",
                      "destination_computer: List"
                    ]
                  }
                ],
                "anomalous": [
                  {
                    "pattern_name": "Off-Hours Authentication Activity",
                    "Instruction": "User anomaly refers to the exercise of finding rare login pattern. Each device has a steady pattern of login as most of the IT operations are repetitive and so their login pattern is quite straight forward.",
                    "identifiable_fields": [
                      "times: List",
                      "source_users: List",
                      "destination_users: List",
                      "source_computer: List"
                    ]
                  },
                  {
                    "pattern_name": "Geographical Authentication Inconsistencies",
                    "Instruction": "Authentication attempts from locations inconsistent with user's typical access patterns.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "times: List",
                      "source_users: List",
                      "destination_users: List"
                    ]
                  },
                  {
                    "pattern_name": "Authentication Protocol Deviations",
                    "Instruction": "Users suddenly switching from typical Kerberos to NTLM authentication or other protocol changes.",
                    "identifiable_fields": [
                      "auth_type: List",
                      "source_users: List",
                      "destination_users: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Logon Type Anomalies",
                    "Instruction": "Users performing logon types inconsistent with their role (e.g., service logons from interactive users).",
                    "identifiable_fields": [
                      "logon_type: List",
                      "source_users: List",
                      "destination_users: List",
                      "destination_computer: List"
                    ]
                  },
                  {
                    "pattern_name": "Authentication Frequency Spikes",
                    "Instruction": "Sudden increases in authentication frequency from specific users or to specific systems.",
                    "identifiable_fields": [
                      "times: List",
                      "source_users: List",
                      "destination_users: List",
                      "source_computer: List",
                      "destination_computer: List"
                    ]
                  }
                ],
                "vulnerable": [
                  {
                    "pattern_name": "Weak Authentication Protocol Usage",
                    "Instruction": "Despite being replaced by more secure authentication protocols and having multiple known vulnerabilities, NTLM is still widely deployed today because of its compatibility with legacy systems and applications.",
                    "identifiable_fields": [
                      "auth_type: List",
                      "source_computer: List",
                      "destination_computer: List"
                    ]
                  },
                  {
                    "pattern_name": "Shared Account Usage",
                    "Instruction": "Multiple simultaneous sessions from the same account across different systems.",
                    "identifiable_fields": [
                      "source_users: List",
                      "destination_users: List",
                      "times: List",
                      "source_computer: List",
                      "destination_computer: List"
                    ]
                  },
                  {
                    "pattern_name": "Stale Authentication Sessions",
                    "Instruction": "Long-running authentication sessions without re-authentication, indicating potential session hijacking vulnerability.",
                    "identifiable_fields": [
                      "times: List",
                      "orientations: List",
                      "source_users: List",
                      "destination_users: List"
                    ]
                  },
                  {
                    "pattern_name": "Administrative Account Overuse",
                    "Instruction": "Administrative accounts being used for routine tasks instead of standard user accounts.",
                    "identifiable_fields": [
                      "source_users: List",
                      "destination_users: List",
                      "logon_type: List",
                      "destination_computer: List"
                    ]
                  },
                  {
                    "pattern_name": "Legacy System Authentication",
                    "Instruction": "Authentication to systems running outdated software or protocols vulnerable to exploitation.",
                    "identifiable_fields": [
                      "destination_computer: List",
                      "auth_type: List",
                      "source_users: List",
                      "destination_users: List"
                    ]
                  }
                ]
              },
              "temporal_patterns": {
                "malicious": [
                  {
                    "pattern_name": "Rapid Cross-System Authentication",
                    "Instruction": "Authentication events over the network from rare or unusual hosts or users using EventCode 4624 with LogonType 3 (network connection) occurring within short time windows across multiple systems.",
                    "identifiable_fields": [
                      "times: List",
                      "source_computer: List",
                      "destination_computer: List"
                    ]
                  }
                ],
                "anomalous": [
                  {
                    "pattern_name": "Off-Hours Authentication Activity",
                    "Instruction": "User anomaly refers to the exercise of finding rare login pattern. Each device has a steady pattern of login as most of the IT operations are repetitive and so their login pattern is quite straight forward.",
                    "identifiable_fields": [
                      "times: List",
                      "source_users: List"
                    ]
                  },
                  {
                    "pattern_name": "Authentication Frequency Spikes",
                    "Instruction": "Sudden increases in authentication frequency from specific users or to specific systems.",
                    "identifiable_fields": [
                      "times: List",
                      "source_users: List",
                      "destination_users: List"
                    ]
                  }
                ],
                "vulnerable": [
                  {
                    "pattern_name": "Stale Authentication Sessions",
                    "Instruction": "Long-running authentication sessions without re-authentication, indicating potential session hijacking vulnerability.",
                    "identifiable_fields": [
                      "times: List",
                      "orientations: List"
                    ]
                  }
                ]
              }
            },
            "entity_analysis_instructions": {
              "source_profiling_queries": [
                {
                  "query_name": "Identify Malicious and Anomalous Source Entities",
                  "instruction": "From the raw logs, extract and list all 'source_computer' and 'source_users' that are directly involved in the following patterns: 'Rapid Cross-System Authentication', 'Pass-the-Hash Authentication Anomalies', 'Credential Stuffing Attack Signatures', 'Service Account Abuse', 'Off-Hours Authentication Activity', 'Geographical Authentication Inconsistencies', 'Authentication Protocol Deviations', 'Authentication Frequency Spikes'."
                }
              ],
              "target_profiling_queries": [
                {
                  "query_name": "Identify High-Value or Frequently Targeted Systems",
                  "instruction": "From the raw logs, extract and list all 'destination_computer' and 'destination_users' that are involved in patterns like 'Privilege Escalation Authentication Chains', 'Service Account Abuse', 'Legacy System Authentication' or appear as a target in multiple anomalous events."
                }
              ]
            },
            "detection_rule_checklist": [
              {
                "detection_name": "Lateral Movement via Authentication Events",
                "mapped_ttp": "T1021 (Remote Services), TA0008 (Lateral Movement)",
                "threat_scenario": "Initial search using Windows security logs, looking for authentication events over the network from rare or unusual hosts or users.",
                "detection_logic": "- Monitor `source_computer` and `destination_computer` for authentication chains\n- Analyze `times` for rapid sequential authentications (< 5 minutes between systems)\n- Filter `logon_type` = 3 (Network) and `statuses` = \"Success\"\n- Cross-reference `source_users` and `destination_users` for privilege escalation patterns",
                "detection_probability": 0.0,
                "Details_reasoning_with_fields": "To detect this, you must analyze relationships between multiple log entries. Correlate successful network logons (logon_type: 3, statuses: Success) across different systems. A key indicator is seeing the same source_users authenticating to multiple destination_computer values in a short time window (times). The link between source_computer and destination_computer forms the lateral movement path."
              },
              {
                "detection_name": "Credential Dumping Detection",
                "mapped_ttp": "T1003 (OS Credential Dumping), T1078 (Valid Accounts)",
                "threat_scenario": "Credential dumping via Mimikatz is a technique used by attackers to extract sensitive authentication data. Attackers can use various methods to dump credentials such as exploiting vulnerabilities, keylogging, sniffing network traffic, or using tools like Mimikatz.",
                "detection_logic": "- Monitor for unusual `auth_type` changes (Kerberos to NTLM)\n- Detect multiple failed authentications followed by successful ones\n- Analyze `source_users` for service accounts performing interactive logons\n- Track `destination_computer` access to domain controllers",
                "detection_probability": 0.0,
                "Details_reasoning_with_fields": "This detection relies on behavioral anomalies. Look for a user (source_users) suddenly switching protocols (auth_type from Kerberos to NTLM), which can be a sign of a downgrade attack. Also, a spike in failed logins (statuses: Failure) followed by a success for the same source_users can indicate brute-forcing or password spraying. Pay special attention if the destination_computer is a domain controller, a primary target for credential harvesting."
              },
              {
                "detection_name": "Authentication Anomaly Detection",
                "mapped_ttp": "T1078 (Valid Accounts), TA0008 (Lateral Movement)",
                "threat_scenario": "Characterize an anomalous Windows authentication event through statistical rarity assessment.",
                "detection_logic": "- Establish baseline authentication patterns using `times`, `source_computer`, `destination_computer`\n- Calculate rarity scores for authentication combinations\n- Flag deviations in `logon_type`, `auth_type`, and user behavior\n- Monitor `orientations` for unusual logoff patterns",
                "detection_probability": 0.0,
                "Details_reasoning_with_fields": "This is a broad, baseline-dependent rule. The core task is to identify statistically rare events. This involves analyzing combinations of nearly all fields. For example, a user (source_users) logging in from an unusual source_computer at an abnormal time (times) with a logon_type they don't typically use would be a high-rarity event. Unusual logoff events (orientations) can also indicate a crashed or hijacked session."
              }
            ],
            "indicators_of_compromise": [
              {
                "indicator_category": "Authentication Failure Patterns",
                "Instruction": "The most common and noisy indicators within event logs for lateral movement attempts are failed logins; the most common event IDs for this are 529 & 4625. Each method of lateral movement has its own set of associated event IDs. For example, attempts to login to accounts via SMB will generate event IDs 552 or 4648 (logon attempt using explicit credentials), and PsExec will show 601 or 4697 (service was installed in the system).",
                "relevant_fields": [
                  "statuses: List",
                  "source_users: List",
                  "destination_users: List",
                  "destination_computer: List"
                ]
              },
              {
                "indicator_category": "Credential Dumping Artifacts",
                "Instruction": "LSASS credential dumping was first observed in the tactics, techniques, and procedures (TTPs) of several sophisticated threat activity groups—including actors that Microsoft tracks as HAFNIUM and GALLIUM. Detecting and stopping OS credential theft is therefore important because it can spell the difference between compromising or encrypting one device versus an entire network.",
                "relevant_fields": [
                  "source_users: List",
                  "destination_users: List",
                  "auth_type: List",
                  "logon_type: List"
                ]
              },
              {
                "indicator_category": "Lateral Movement Indicators",
                "Instruction": "Based on searches, administrators connected over the network from specific IP addresses and gained command line access to victim hosts. Using psexec for lateral movement has been around for quite a while and is still very popular and relevant.",
                "relevant_fields": [
                  "source_computer: List",
                  "destination_computer: List",
                  "source_users: List",
                  "logon_type: List"
                ]
              },
              {
                "indicator_category": "Account Enumeration Signatures",
                "Instruction": "Account enumeration is a more specific type of brute force attack where the attacker is attempting to guess the valid usernames of users within a network. These attacks are typically done when the malicious actor has limited information about their victim's network.",
                "relevant_fields": [
                  "source_users: List",
                  "destination_users: List",
                  "statuses: List",
                  "source_computer: List"
                ]
              }
            ],
            "attack_pattern_checks": [
              {
                "attack_pattern_name": "Dictionary-based Password Attack (CAPEC-16)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Credential Dumping Detection' or 'Authentication Anomaly Detection' rules, specifically a high volume of failed logons from a single source against multiple users. As proof, provide the source entity, a sample of target users, and the relevant timestamps.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Password Brute Forcing (CAPEC-49)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you find evidence of a high volume of failed logons against a single user account from one or more sources, matching the 'Credential Dumping Detection' rule. As proof, provide the source(s), the target user, and the relevant timestamps.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Password Recovery Exploitation (CAPEC-50)",
                "is_present": false,
                "evidence_Instruction": "This is difficult to detect with authentication logs alone. Set `is_present` to `true` only if you observe a suspicious successful logon immediately following activity related to password reset systems, if such context is available. Evidence should describe this correlation.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Rainbow Table Password Cracking (CAPEC-55)",
                "is_present": false,
                "evidence_Instruction": "This is an offline attack and not directly visible in authentication logs. Do not set to true unless there is external intelligence suggesting this. You may see the result as a 'Valid Accounts' authentication.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Try Common or Default Usernames and Passwords (CAPEC-70)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe failed logon attempts for common usernames like 'admin', 'administrator', 'guest', etc. from an external or unusual source. As proof, list the attempted usernames and the source computer.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Brute Force (CAPEC-112)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Credential Dumping Detection' rule involving a high number of failed logons followed by a success. As proof, provide the source and target entities and the relevant timestamps.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Identity Spoofing (CAPEC-151)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe a user account logging in from a system or location that is highly anomalous for that user, especially if it coincides with other suspicious activity. As proof, describe the anomaly (e.g., user X logged in from server Y for the first time).",
                "evidence": []
              },
              {
                "attack_pattern_name": "Protocol Manipulation (CAPEC-192)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe evidence of an 'Authentication Protocol Deviation' pattern, such as a sudden switch from Kerberos to NTLM. As proof, provide the user, source, destination, and the protocol change observed.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Abuse of Functionality (CAPEC-210)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe the 'Service Account Abuse' pattern where a non-interactive account is used for an interactive logon. As proof, provide the service account name, the logon type, and the systems involved.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Cross-Site Scripting via Encoded URI Schemes (CAPEC-244)",
                "is_present": false,
                "evidence_Instruction": "This is not typically detectable via Windows Authentication logs. Do not set to true.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Kerberoasting (CAPEC-509)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe a standard user account requesting a high number of Kerberos service tickets (TGS-REQ) for various services, especially if this is anomalous for the user. This may require deeper Kerberos event logging. As proof, list the user and the services for which tickets were requested.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Use of Known Domain Credentials (CAPEC-560)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if any of the 'Authentication Anomaly Detection' rules trigger, such as off-hours or geographically inconsistent logons. This pattern represents the outcome of a credential compromise. As proof, provide the details of the anomalous successful logon.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Windows Admin Shares with Stolen Credentials (CAPEC-561)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe the 'Lateral Movement via Authentication Events' detection rule triggering, specifically with a network logon (LogonType 3) to a high-value server or another workstation. As proof, provide the source/destination computers and the user account.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Password Spraying (CAPEC-565)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe a single source attempting to log in to many different user accounts with a small number of passwords (indicated by a large number of logon failures across many accounts from one source). As proof, provide the source computer and a list of targeted accounts.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Credential Stuffing (CAPEC-600)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe a high volume of failed logons from one or more sources across many different accounts, often followed by a few successes. This matches the 'Credential Stuffing Attack Signatures' pattern. As proof, provide the source(s) and the accounts involved.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Use of Captured Hashes (Pass The Hash) (CAPEC-645)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe the 'Pass-the-Hash Authentication Anomalies' pattern, such as a logon using NTLM where Kerberos is expected, especially for privileged accounts or to sensitive systems. As proof, detail the event, including the user, systems, and authentication protocol.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Use of Known Kerberos Credentials (CAPEC-652)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe lateral movement using Kerberos that is anomalous (e.g., user logging into a system they don't normally access). This can be identified by the 'Lateral Movement via Authentication Events' rule where the auth_type is Kerberos. As proof, provide the details of the anomalous successful Kerberos logon.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Use of Known Operating System Credentials (CAPEC-653)",
                "is_present": false,
                "evidence_Instruction": "This is a general pattern. Set `is_present` to `true` if any of the primary detection rules ('Lateral Movement', 'Credential Dumping', 'Authentication Anomaly') are triggered with a successful logon. As proof, cite the rule that was triggered and the associated entities.",
                "evidence": []
              }
            ],
            "vulnerability_checks": [
              {
                "vulnerability_id": "CVE-2024-38030",
                "is_present": false,
                "evidence_instruction": "For CVE-2024-38030, set `is_present` to `true` if you observe an authentication coercion attack where a device is forced to send NTLM hashes to an attacker's system. This may manifest as an unexpected NTLM authentication attempt from a vulnerable system to an unknown or untrusted destination. As proof, describe the source of the coerced authentication and the destination it attempted to connect to.",
                "evidence": []
              },
              {
                "vulnerability_id": "CVE-2019-1040",
                "is_present": false,
                "evidence_instruction": "For CVE-2019-1040, set `is_present` to `true` if you observe an NTLM authentication bypass, which could appear as a successful NTLM logon where it should have failed or been blocked. This is hard to spot; look for successful NTLM logons to services that should be protected against such bypasses, especially if the source is unusual. As proof, detail the suspicious successful NTLM authentication.",
                "evidence": []
              }
            ]
          },
          "raw_response": "```json\n{\n  \"Log_context\": {\n    \"log_type\": \"Windows Authentication Log\",\n    \"log_description\": \"Windows Authentication Logs are a critical data source for detecting advanced persistent threats, lateral movement, and credential-based attacks. They provide visibility into authentication patterns, enabling the detection of techniques like pass-the-hash, credential dumping, privilege escalation, and lateral movement. The analyzed fields form a comprehensive framework for identifying malicious activity.\"\n  },\n  \"observations\": {\n    \"behavioral_patterns\": {\n      \"malicious\": [\n        {\n          \"pattern_name\": \"Rapid Cross-System Authentication\",\n          \"Instruction\": \"Authentication events over the network from rare or unusual hosts or users using EventCode 4624 with LogonType 3 (network connection) occurring within short time windows across multiple systems.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"destination_computer: List\",\n            \"times: List\",\n            \"source_users: List\",\n            \"destination_users: List\",\n            \"logon_type: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Pass-the-Hash Authentication Anomalies\",\n          \"Instruction\": \"Attackers leverage hashed credentials (NTLM hashes) or Kerberos tickets to authenticate on other systems without needing the plaintext passwords. These techniques are commonly used to escalate privileges and move laterally between high-value systems.\",\n          \"identifiable_fields\": [\n            \"auth_type: List\",\n            \"destination_users: List\",\n            \"source_computer: List\",\n            \"destination_computer: List\",\n            \"statuses: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Privilege Escalation Authentication Chains\",\n          \"Instruction\": \"Sequential authentication events showing escalation from standard user to administrative accounts across systems.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"destination_users: List\",\n            \"times: List\",\n            \"orientations: List\",\n            \"statuses: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Credential Stuffing Attack Signatures\",\n          \"Instruction\": \"Malicious actors routinely use the NTLM authentication protocol to carry out account enumeration and brute force-styled attacks to compromise accounts within a victim's network. Once inside, an attacker can gain persistence, exfiltrate sensitive data, and unleash ransomware.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"destination_users: List\",\n            \"statuses: List\",\n            \"times: List\",\n            \"auth_type: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Service Account Abuse\",\n          \"Instruction\": \"Legitimate service accounts being used for interactive logons or accessing resources outside their normal scope.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"destination_users: List\",\n            \"logon_type: List\",\n            \"destination_computer: List\"\n          ]\n        }\n      ],\n      \"anomalous\": [\n        {\n          \"pattern_name\": \"Off-Hours Authentication Activity\",\n          \"Instruction\": \"User anomaly refers to the exercise of finding rare login pattern. Each device has a steady pattern of login as most of the IT operations are repetitive and so their login pattern is quite straight forward.\",\n          \"identifiable_fields\": [\n            \"times: List\",\n            \"source_users: List\",\n            \"destination_users: List\",\n            \"source_computer: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Geographical Authentication Inconsistencies\",\n          \"Instruction\": \"Authentication attempts from locations inconsistent with user's typical access patterns.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"times: List\",\n            \"source_users: List\",\n            \"destination_users: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Authentication Protocol Deviations\",\n          \"Instruction\": \"Users suddenly switching from typical Kerberos to NTLM authentication or other protocol changes.\",\n          \"identifiable_fields\": [\n            \"auth_type: List\",\n            \"source_users: List\",\n            \"destination_users: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Logon Type Anomalies\",\n          \"Instruction\": \"Users performing logon types inconsistent with their role (e.g., service logons from interactive users).\",\n          \"identifiable_fields\": [\n            \"logon_type: List\",\n            \"source_users: List\",\n            \"destination_users: List\",\n            \"destination_computer: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Authentication Frequency Spikes\",\n          \"Instruction\": \"Sudden increases in authentication frequency from specific users or to specific systems.\",\n          \"identifiable_fields\": [\n            \"times: List\",\n            \"source_users: List\",\n            \"destination_users: List\",\n            \"source_computer: List\",\n            \"destination_computer: List\"\n          ]\n        }\n      ],\n      \"vulnerable\": [\n        {\n          \"pattern_name\": \"Weak Authentication Protocol Usage\",\n          \"Instruction\": \"Despite being replaced by more secure authentication protocols and having multiple known vulnerabilities, NTLM is still widely deployed today because of its compatibility with legacy systems and applications.\",\n          \"identifiable_fields\": [\n            \"auth_type: List\",\n            \"source_computer: List\",\n            \"destination_computer: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Shared Account Usage\",\n          \"Instruction\": \"Multiple simultaneous sessions from the same account across different systems.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"destination_users: List\",\n            \"times: List\",\n            \"source_computer: List\",\n            \"destination_computer: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Stale Authentication Sessions\",\n          \"Instruction\": \"Long-running authentication sessions without re-authentication, indicating potential session hijacking vulnerability.\",\n          \"identifiable_fields\": [\n            \"times: List\",\n            \"orientations: List\",\n            \"source_users: List\",\n            \"destination_users: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Administrative Account Overuse\",\n          \"Instruction\": \"Administrative accounts being used for routine tasks instead of standard user accounts.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"destination_users: List\",\n            \"logon_type: List\",\n            \"destination_computer: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Legacy System Authentication\",\n          \"Instruction\": \"Authentication to systems running outdated software or protocols vulnerable to exploitation.\",\n          \"identifiable_fields\": [\n            \"destination_computer: List\",\n            \"auth_type: List\",\n            \"source_users: List\",\n            \"destination_users: List\"\n          ]\n        }\n      ]\n    },\n    \"temporal_patterns\": {\n      \"malicious\": [\n        {\n          \"pattern_name\": \"Rapid Cross-System Authentication\",\n          \"Instruction\": \"Authentication events over the network from rare or unusual hosts or users using EventCode 4624 with LogonType 3 (network connection) occurring within short time windows across multiple systems.\",\n          \"identifiable_fields\": [\n            \"times: List\",\n            \"source_computer: List\",\n            \"destination_computer: List\"\n          ]\n        }\n      ],\n      \"anomalous\": [\n        {\n          \"pattern_name\": \"Off-Hours Authentication Activity\",\n          \"Instruction\": \"User anomaly refers to the exercise of finding rare login pattern. Each device has a steady pattern of login as most of the IT operations are repetitive and so their login pattern is quite straight forward.\",\n          \"identifiable_fields\": [\n            \"times: List\",\n            \"source_users: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Authentication Frequency Spikes\",\n          \"Instruction\": \"Sudden increases in authentication frequency from specific users or to specific systems.\",\n          \"identifiable_fields\": [\n            \"times: List\",\n            \"source_users: List\",\n            \"destination_users: List\"\n          ]\n        }\n      ],\n      \"vulnerable\": [\n        {\n          \"pattern_name\": \"Stale Authentication Sessions\",\n          \"Instruction\": \"Long-running authentication sessions without re-authentication, indicating potential session hijacking vulnerability.\",\n          \"identifiable_fields\": [\n            \"times: List\",\n            \"orientations: List\"\n          ]\n        }\n      ]\n    }\n  },\n  \"entity_analysis_instructions\": {\n    \"source_profiling_queries\": [\n      {\n        \"query_name\": \"Identify Malicious and Anomalous Source Entities\",\n        \"instruction\": \"From the raw logs, extract and list all 'source_computer' and 'source_users' that are directly involved in the following patterns: 'Rapid Cross-System Authentication', 'Pass-the-Hash Authentication Anomalies', 'Credential Stuffing Attack Signatures', 'Service Account Abuse', 'Off-Hours Authentication Activity', 'Geographical Authentication Inconsistencies', 'Authentication Protocol Deviations', 'Authentication Frequency Spikes'.\"\n      }\n    ],\n    \"target_profiling_queries\": [\n      {\n        \"query_name\": \"Identify High-Value or Frequently Targeted Systems\",\n        \"instruction\": \"From the raw logs, extract and list all 'destination_computer' and 'destination_users' that are involved in patterns like 'Privilege Escalation Authentication Chains', 'Service Account Abuse', 'Legacy System Authentication' or appear as a target in multiple anomalous events.\"\n      }\n    ]\n  },\n  \"detection_rule_checklist\": [\n    {\n      \"detection_name\": \"Lateral Movement via Authentication Events\",\n      \"mapped_ttp\": \"T1021 (Remote Services), TA0008 (Lateral Movement)\",\n      \"threat_scenario\": \"Initial search using Windows security logs, looking for authentication events over the network from rare or unusual hosts or users.\",\n      \"detection_logic\": \"- Monitor `source_computer` and `destination_computer` for authentication chains\\n- Analyze `times` for rapid sequential authentications (< 5 minutes between systems)\\n- Filter `logon_type` = 3 (Network) and `statuses` = \\\"Success\\\"\\n- Cross-reference `source_users` and `destination_users` for privilege escalation patterns\",\n      \"detection_probability\": 0.0,\n      \"Details_reasoning_with_fields\": \"To detect this, you must analyze relationships between multiple log entries. Correlate successful network logons (logon_type: 3, statuses: Success) across different systems. A key indicator is seeing the same source_users authenticating to multiple destination_computer values in a short time window (times). The link between source_computer and destination_computer forms the lateral movement path.\"\n    },\n    {\n      \"detection_name\": \"Credential Dumping Detection\",\n      \"mapped_ttp\": \"T1003 (OS Credential Dumping), T1078 (Valid Accounts)\",\n      \"threat_scenario\": \"Credential dumping via Mimikatz is a technique used by attackers to extract sensitive authentication data. Attackers can use various methods to dump credentials such as exploiting vulnerabilities, keylogging, sniffing network traffic, or using tools like Mimikatz.\",\n      \"detection_logic\": \"- Monitor for unusual `auth_type` changes (Kerberos to NTLM)\\n- Detect multiple failed authentications followed by successful ones\\n- Analyze `source_users` for service accounts performing interactive logons\\n- Track `destination_computer` access to domain controllers\",\n      \"detection_probability\": 0.0,\n      \"Details_reasoning_with_fields\": \"This detection relies on behavioral anomalies. Look for a user (source_users) suddenly switching protocols (auth_type from Kerberos to NTLM), which can be a sign of a downgrade attack. Also, a spike in failed logins (statuses: Failure) followed by a success for the same source_users can indicate brute-forcing or password spraying. Pay special attention if the destination_computer is a domain controller, a primary target for credential harvesting.\"\n    },\n\n    {\n      \"detection_name\": \"Authentication Anomaly Detection\",\n      \"mapped_ttp\": \"T1078 (Valid Accounts), TA0008 (Lateral Movement)\",\n      \"threat_scenario\": \"Characterize an anomalous Windows authentication event through statistical rarity assessment.\",\n      \"detection_logic\": \"- Establish baseline authentication patterns using `times`, `source_computer`, `destination_computer`\\n- Calculate rarity scores for authentication combinations\\n- Flag deviations in `logon_type`, `auth_type`, and user behavior\\n- Monitor `orientations` for unusual logoff patterns\",\n      \"detection_probability\": 0.0,\n      \"Details_reasoning_with_fields\": \"This is a broad, baseline-dependent rule. The core task is to identify statistically rare events. This involves analyzing combinations of nearly all fields. For example, a user (source_users) logging in from an unusual source_computer at an abnormal time (times) with a logon_type they don't typically use would be a high-rarity event. Unusual logoff events (orientations) can also indicate a crashed or hijacked session.\"\n    }\n  ],\n  \"indicators_of_compromise\": [\n    {\n      \"indicator_category\": \"Authentication Failure Patterns\",\n      \"Instruction\": \"The most common and noisy indicators within event logs for lateral movement attempts are failed logins; the most common event IDs for this are 529 & 4625. Each method of lateral movement has its own set of associated event IDs. For example, attempts to login to accounts via SMB will generate event IDs 552 or 4648 (logon attempt using explicit credentials), and PsExec will show 601 or 4697 (service was installed in the system).\",\n      \"relevant_fields\": [\n        \"statuses: List\",\n        \"source_users: List\",\n        \"destination_users: List\",\n        \"destination_computer: List\"\n      ]\n    },\n    {\n      \"indicator_category\": \"Credential Dumping Artifacts\",\n      \"Instruction\": \"LSASS credential dumping was first observed in the tactics, techniques, and procedures (TTPs) of several sophisticated threat activity groups—including actors that Microsoft tracks as HAFNIUM and GALLIUM. Detecting and stopping OS credential theft is therefore important because it can spell the difference between compromising or encrypting one device versus an entire network.\",\n      \"relevant_fields\": [\n        \"source_users: List\",\n        \"destination_users: List\",\n        \"auth_type: List\",\n        \"logon_type: List\"\n      ]\n    },\n    {\n      \"indicator_category\": \"Lateral Movement Indicators\",\n      \"Instruction\": \"Based on searches, administrators connected over the network from specific IP addresses and gained command line access to victim hosts. Using psexec for lateral movement has been around for quite a while and is still very popular and relevant.\",\n      \"relevant_fields\": [\n        \"source_computer: List\",\n        \"destination_computer: List\",\n        \"source_users: List\",\n        \"logon_type: List\"\n      ]\n    },\n    {\n      \"indicator_category\": \"Account Enumeration Signatures\",\n      \"Instruction\": \"Account enumeration is a more specific type of brute force attack where the attacker is attempting to guess the valid usernames of users within a network. These attacks are typically done when the malicious actor has limited information about their victim's network.\",\n      \"relevant_fields\": [\n        \"source_users: List\",\n        \"destination_users: List\",\n        \"statuses: List\",\n        \"source_computer: List\"\n      ]\n    }\n  ],\n  \"attack_pattern_checks\": [\n    {\n      \"attack_pattern_name\": \"Dictionary-based Password Attack (CAPEC-16)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you find evidence matching the 'Credential Dumping Detection' or 'Authentication Anomaly Detection' rules, specifically a high volume of failed logons from a single source against multiple users. As proof, provide the source entity, a sample of target users, and the relevant timestamps.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Password Brute Forcing (CAPEC-49)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you find evidence of a high volume of failed logons against a single user account from one or more sources, matching the 'Credential Dumping Detection' rule. As proof, provide the source(s), the target user, and the relevant timestamps.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Password Recovery Exploitation (CAPEC-50)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"This is difficult to detect with authentication logs alone. Set `is_present` to `true` only if you observe a suspicious successful logon immediately following activity related to password reset systems, if such context is available. Evidence should describe this correlation.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Rainbow Table Password Cracking (CAPEC-55)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"This is an offline attack and not directly visible in authentication logs. Do not set to true unless there is external intelligence suggesting this. You may see the result as a 'Valid Accounts' authentication.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Try Common or Default Usernames and Passwords (CAPEC-70)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe failed logon attempts for common usernames like 'admin', 'administrator', 'guest', etc. from an external or unusual source. As proof, list the attempted usernames and the source computer.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Brute Force (CAPEC-112)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you find evidence matching the 'Credential Dumping Detection' rule involving a high number of failed logons followed by a success. As proof, provide the source and target entities and the relevant timestamps.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Identity Spoofing (CAPEC-151)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe a user account logging in from a system or location that is highly anomalous for that user, especially if it coincides with other suspicious activity. As proof, describe the anomaly (e.g., user X logged in from server Y for the first time).\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Protocol Manipulation (CAPEC-192)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe evidence of an 'Authentication Protocol Deviation' pattern, such as a sudden switch from Kerberos to NTLM. As proof, provide the user, source, destination, and the protocol change observed.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Abuse of Functionality (CAPEC-210)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe the 'Service Account Abuse' pattern where a non-interactive account is used for an interactive logon. As proof, provide the service account name, the logon type, and the systems involved.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Cross-Site Scripting via Encoded URI Schemes (CAPEC-244)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"This is not typically detectable via Windows Authentication logs. Do not set to true.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Kerberoasting (CAPEC-509)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe a standard user account requesting a high number of Kerberos service tickets (TGS-REQ) for various services, especially if this is anomalous for the user. This may require deeper Kerberos event logging. As proof, list the user and the services for which tickets were requested.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Use of Known Domain Credentials (CAPEC-560)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if any of the 'Authentication Anomaly Detection' rules trigger, such as off-hours or geographically inconsistent logons. This pattern represents the outcome of a credential compromise. As proof, provide the details of the anomalous successful logon.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Windows Admin Shares with Stolen Credentials (CAPEC-561)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe the 'Lateral Movement via Authentication Events' detection rule triggering, specifically with a network logon (LogonType 3) to a high-value server or another workstation. As proof, provide the source/destination computers and the user account.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Password Spraying (CAPEC-565)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe a single source attempting to log in to many different user accounts with a small number of passwords (indicated by a large number of logon failures across many accounts from one source). As proof, provide the source computer and a list of targeted accounts.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Credential Stuffing (CAPEC-600)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe a high volume of failed logons from one or more sources across many different accounts, often followed by a few successes. This matches the 'Credential Stuffing Attack Signatures' pattern. As proof, provide the source(s) and the accounts involved.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Use of Captured Hashes (Pass The Hash) (CAPEC-645)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe the 'Pass-the-Hash Authentication Anomalies' pattern, such as a logon using NTLM where Kerberos is expected, especially for privileged accounts or to sensitive systems. As proof, detail the event, including the user, systems, and authentication protocol.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Use of Known Kerberos Credentials (CAPEC-652)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe lateral movement using Kerberos that is anomalous (e.g., user logging into a system they don't normally access). This can be identified by the 'Lateral Movement via Authentication Events' rule where the auth_type is Kerberos. As proof, provide the details of the anomalous successful Kerberos logon.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Use of Known Operating System Credentials (CAPEC-653)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"This is a general pattern. Set `is_present` to `true` if any of the primary detection rules ('Lateral Movement', 'Credential Dumping', 'Authentication Anomaly') are triggered with a successful logon. As proof, cite the rule that was triggered and the associated entities.\",\n      \"evidence\": []\n    }\n  ],\n  \"vulnerability_checks\": [\n    {\n      \"vulnerability_id\": \"CVE-2024-38030\",\n      \"is_present\": false,\n      \"evidence_instruction\": \"For CVE-2024-38030, set `is_present` to `true` if you observe an authentication coercion attack where a device is forced to send NTLM hashes to an attacker's system. This may manifest as an unexpected NTLM authentication attempt from a vulnerable system to an unknown or untrusted destination. As proof, describe the source of the coerced authentication and the destination it attempted to connect to.\",\n      \"evidence\": []\n    },\n    {\n      \"vulnerability_id\": \"CVE-2019-1040\",\n      \"is_present\": false,\n      \"evidence_instruction\": \"For CVE-2019-1040, set `is_present` to `true` if you observe an NTLM authentication bypass, which could appear as a successful NTLM logon where it should have failed or been blocked. This is hard to spot; look for successful NTLM logons to services that should be protected against such bypasses, especially if the source is unusual. As proof, detail the suspicious successful NTLM authentication.\",\n      \"evidence\": []\n    }\n  ]\n}\n```",
          "model": "gemini-2.5-pro",
          "provider": "gemini",
          "report_source": "claude"
        },
        "gemini_from_openai_report": {
          "parsed_json": {
            "Log_context": {
              "log_type": "Windows Authentication Log",
              "log_description": "Windows Authentication Logs are one of the most critical data sources for detecting and investigating adversary behavior, including credential theft, lateral movement, and persistence techniques. This report synthesizes industry and academic research, maps key MITRE ATT&CK® techniques, enumerates observable patterns in authentication events, and provides actionable detection and response guidance."
            },
            "observations": {
              "behavioral_patterns": {
                "malicious": [
                  {
                    "pattern_name": "Password Spraying",
                    "Instruction": "Broad targeting of multiple accounts from one host with low-frequency failures to evade lockout.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "destination_users: List",
                      "statuses: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Brute Force Attack",
                    "Instruction": "Rapid-fire authentication failures against a single account indicating credential guessing.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "destination_users: List",
                      "statuses: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Pass-the-Hash",
                    "Instruction": "Successful NTLM authentication (auth_type) on network logons (logon_type) without Kerberos fallback.",
                    "identifiable_fields": [
                      "auth_type: List",
                      "logon_type: List",
                      "source_users: List",
                      "destination_computer: List"
                    ]
                  },
                  {
                    "pattern_name": "Kerberoasting",
                    "Instruction": "Unusually high Kerberos service ticket requests for service accounts outside normal usage periods.",
                    "identifiable_fields": [
                      "auth_type: List",
                      "destination_users: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Pass-the-Ticket",
                    "Instruction": "Multiple Kerberos (auth_type) logons for high-privilege accounts without prior ticket-granting ticket requests.",
                    "identifiable_fields": [
                      "auth_type: List",
                      "source_users: List",
                      "statuses: List"
                    ]
                  },
                  {
                    "pattern_name": "RDP-based Lateral Movement",
                    "Instruction": "Interactive logons (logon_type: 10) from remote hosts not normally accessed by user.",
                    "identifiable_fields": [
                      "logon_type: List",
                      "source_computer: List",
                      "destination_computer: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Golden Ticket Use",
                    "Instruction": "Kerberos logons (auth_type) for non-existent or service accounts with no corresponding TGT events.",
                    "identifiable_fields": [
                      "auth_type: List",
                      "destination_users: List",
                      "statuses: List"
                    ]
                  }
                ],
                "anomalous": [
                  {
                    "pattern_name": "Impossible Travel",
                    "Instruction": "Logons for same user from geographically disparate hosts within implausible timeframes.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "source_users: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Unusual Protocol Usage",
                    "Instruction": "NTLM logon events in environments locked to Kerberos-only authentication.",
                    "identifiable_fields": [
                      "auth_type: List",
                      "source_users: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Out-of-Hours Logons",
                    "Instruction": "Successful logons occurring outside established business hours for a given user.",
                    "identifiable_fields": [
                      "times: List",
                      "source_users: List"
                    ]
                  },
                  {
                    "pattern_name": "Service Account Interactive Logon",
                    "Instruction": "Non-service hosts showing interactive (logon_type: 2) logons by service accounts.",
                    "identifiable_fields": [
                      "destination_users: List",
                      "logon_type: List",
                      "destination_computer: List"
                    ]
                  },
                  {
                    "pattern_name": "Account Lockout Storm",
                    "Instruction": "Multiple failure events followed by a lockout (event ID 4740) within a short period.",
                    "identifiable_fields": [
                      "statuses: List",
                      "source_users: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "New Host Access",
                    "Instruction": "First-time successful logon by a user to a host in their typical domain scope.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "source_users: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Orphaned Logoff",
                    "Instruction": "Logon events with no subsequent logoff (orientations) indicating potential persistence.",
                    "identifiable_fields": [
                      "orientations: List",
                      "times: List"
                    ]
                  }
                ],
                "vulnerable": [
                  {
                    "pattern_name": "Legacy Protocol Fall-back",
                    "Instruction": "Use of LM or NTLMv1 protocols despite policy disabling them.",
                    "identifiable_fields": [
                      "auth_type: List",
                      "statuses: List"
                    ]
                  },
                  {
                    "pattern_name": "Shared Account Across Hosts",
                    "Instruction": "Same account logging into multiple unrelated hosts simultaneously.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "source_users: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Disabled Account Attempts",
                    "Instruction": "Authentication failures (statuses: Failure) for known-disabled accounts.",
                    "identifiable_fields": [
                      "source_users: List",
                      "statuses: List"
                    ]
                  },
                  {
                    "pattern_name": "Excessive Failure Noise",
                    "Instruction": "High volume of failed logons from one host without any successes, indicating misconfiguration or reconnaissance.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "statuses: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Default Credential Usage",
                    "Instruction": "Attempts to log on with default or well-known account names (e.g., “Administrator”, “Guest”).",
                    "identifiable_fields": [
                      "destination_users: List",
                      "statuses: List"
                    ]
                  },
                  {
                    "pattern_name": "Non-Rotating Service Account Logon",
                    "Instruction": "Long-lived service accounts authenticating interactively at irregular intervals.",
                    "identifiable_fields": [
                      "destination_users: List",
                      "times: List",
                      "logon_type: List"
                    ]
                  }
                ]
              },
              "temporal_patterns": {
                "malicious": [
                  {
                    "pattern_name": "Password Spraying",
                    "Instruction": "Broad targeting of multiple accounts from one host with low-frequency failures to evade lockout.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "destination_users: List",
                      "statuses: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Brute Force Attack",
                    "Instruction": "Rapid-fire authentication failures against a single account indicating credential guessing.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "destination_users: List",
                      "statuses: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Kerberoasting",
                    "Instruction": "Unusually high Kerberos service ticket requests for service accounts outside normal usage periods.",
                    "identifiable_fields": [
                      "auth_type: List",
                      "destination_users: List",
                      "times: List"
                    ]
                  }
                ],
                "anomalous": [
                  {
                    "pattern_name": "Impossible Travel",
                    "Instruction": "Logons for same user from geographically disparate hosts within implausible timeframes.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "source_users: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Out-of-Hours Logons",
                    "Instruction": "Successful logons occurring outside established business hours for a given user.",
                    "identifiable_fields": [
                      "times: List",
                      "source_users: List"
                    ]
                  },
                  {
                    "pattern_name": "Account Lockout Storm",
                    "Instruction": "Multiple failure events followed by a lockout (event ID 4740) within a short period.",
                    "identifiable_fields": [
                      "statuses: List",
                      "source_users: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Orphaned Logoff",
                    "Instruction": "Logon events with no subsequent logoff (orientations) indicating potential persistence.",
                    "identifiable_fields": [
                      "orientations: List",
                      "times: List"
                    ]
                  }
                ],
                "vulnerable": [
                  {
                    "pattern_name": "Shared Account Across Hosts",
                    "Instruction": "Same account logging into multiple unrelated hosts simultaneously.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "source_users: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Excessive Failure Noise",
                    "Instruction": "High volume of failed logons from one host without any successes, indicating misconfiguration or reconnaissance.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "statuses: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Non-Rotating Service Account Logon",
                    "Instruction": "Long-lived service accounts authenticating interactively at irregular intervals.",
                    "identifiable_fields": [
                      "destination_users: List",
                      "times: List",
                      "logon_type: List"
                    ]
                  }
                ]
              }
            },
            "entity_analysis_instructions": {
              "source_profiling_queries": [
                {
                  "query_name": "Identify Malicious and Anomalous Source Entities",
                  "instruction": "From the raw logs, extract and list all `source_computer` and `source_users` that are directly involved in the following patterns: 'Password Spraying', 'Brute Force Attack', 'Pass-the-Hash', 'Pass-the-Ticket', 'Impossible Travel', 'Unusual Protocol Usage', 'New Host Access', and 'Shared Account Across Hosts'."
                }
              ],
              "target_profiling_queries": [
                {
                  "query_name": "Identify High-Value or Frequently Targeted Entities",
                  "instruction": "From the raw logs, extract and list all `destination_computer` and `destination_users` that are involved in patterns like 'Pass-the-Hash', 'Kerberoasting', 'RDP-based Lateral Movement', 'Service Account Interactive Logon' or appear as a target in multiple anomalous events."
                }
              ]
            },
            "detection_rule_checklist": [
              {
                "detection_name": "Detect Password Spraying",
                "mapped_ttp": "T1110.003",
                "threat_scenario": "Count failed `statuses` per `source_computer` across ≥ 10 unique `destination_users` within 5 minutes.",
                "detection_logic": "- Filter events where `statuses: Failure` and `times` in a rolling 5-minute window\n- Aggregate by `source_computer`, count distinct `destination_users`\n- Alert if count ≥ 10",
                "detection_probability": null,
                "Details_reasoning_with_fields": "To determine the probability, analyze the logs for events matching the detection logic. Specifically, look for a single `source_computer` generating failed authentication events (`statuses: Failure`) for ten or more distinct `destination_users` within a 5-minute `times` window. The presence of these correlated fields directly indicates a password spraying attack."
              },
              {
                "detection_name": "Identify Pass-the-Hash",
                "mapped_ttp": "T1550.002",
                "threat_scenario": "Successful logon where `auth_type: NTLM`, `logon_type: 3 (Network)`, and destination account is high-privilege.",
                "detection_logic": "- Filter events where `auth_type == \"NTLM\"` AND `logon_type == \"Network\"` AND `statuses == \"Success\"`\n- Destination account in privileged group list",
                "detection_probability": null,
                "Details_reasoning_with_fields": "To determine the probability, identify successful logons (`statuses: Success`) using the NTLM protocol (`auth_type: NTLM`) with a network logon type (`logon_type: 3 (Network)`). The key is to correlate this with the `destination_users` being a member of a high-privilege group. The combination of these specific field values is a strong indicator of a Pass-the-Hash attempt."
              },
              {
                "detection_name": "Flag Kerberoasting Attempts",
                "mapped_ttp": "T1558.003",
                "threat_scenario": "≥ 5 Kerberos (`auth_type`) service ticket requests for a single `destination_users` within 10 minutes.",
                "detection_logic": "- Filter events where `auth_type == \"Kerberos\"` AND `destination_users` is a service account\n- Aggregate by `destination_users`, count in rolling 10-minute window\n- Alert if count ≥ 5",
                "detection_probability": null,
                "Details_reasoning_with_fields": "To determine the probability, look for a high frequency of Kerberos authentication events (`auth_type: Kerberos`). The detection requires identifying a single service account (`destination_users`) receiving five or more service ticket requests within a 10-minute `times` window. This focuses on the temporal correlation of `auth_type` and `destination_users`."
              },
              {
                "detection_name": "RDP Lateral Movement",
                "mapped_ttp": "T1021.001",
                "threat_scenario": "Interactive logon (`logon_type: 10`) from non-standard `source_computer` to domain workstations/servers.",
                "detection_logic": "- Filter where `logon_type == \"Interactive\"` AND `source_computer` not in baseline list for user",
                "detection_probability": null,
                "Details_reasoning_with_fields": "To determine the probability, filter for interactive logons (`logon_type: 10`). The critical step is to check if the `source_computer` for a given logon is not on a pre-established baseline of allowed hosts for that `source_users`. The detection relies on the relationship between `logon_type`, `source_computer`, and the user's normal activity profile."
              },
              {
                "detection_name": "MFA Fatigue Attack",
                "mapped_ttp": "T1621",
                "threat_scenario": "≥ 20 failed MFA-associated `statuses` for same `source_users` in 1 hour.",
                "detection_logic": "- Correlate authentication events with MFA challenge outcome logs\n- Aggregate failure count by `source_users`\n- Alert if count ≥ 20 in 60 minutes",
                "detection_probability": null,
                "Details_reasoning_with_fields": "To determine the probability, you must correlate Windows authentication logs with MFA logs. The logic requires counting a high number of failed authentication events (`statuses: Failure`) for a single `source_users` over a 60-minute `times` window. The key is the high volume of failures for a specific user, indicating a bombardment attempt."
              }
            ],
            "indicators_of_compromise": [
              {
                "indicator_category": "Unrecognized or Unusual Source Hostnames",
                "Instruction": "Unrecognized or unusual `source_computer` identifiers may indicate attacker-controlled systems.",
                "relevant_fields": [
                  "source_computer: List"
                ]
              },
              {
                "indicator_category": "Anomalous Destination Hostnames",
                "Instruction": "Access attempts to critical servers (`destination_computer`), especially domain controllers.",
                "relevant_fields": [
                  "destination_computer: List"
                ]
              },
              {
                "indicator_category": "Anomalous User Account Usage",
                "Instruction": "Compromised or service accounts (`source_users`/`destination_users`) involved in anomalous logons.",
                "relevant_fields": [
                  "source_users: List",
                  "destination_users: List"
                ]
              },
              {
                "indicator_category": "Divergent Authentication Protocols",
                "Instruction": "NTLM vs Kerberos (`auth_type`) divergence from normal baselines.",
                "relevant_fields": [
                  "auth_type: List"
                ]
              },
              {
                "indicator_category": "Anomalous Logon Types",
                "Instruction": "Elevated remote interactive (`logon_type: 10`) vs console access.",
                "relevant_fields": [
                  "logon_type: List"
                ]
              },
              {
                "indicator_category": "Unusual Timestamps",
                "Instruction": "Off-hours or rapid successive events in `times` indicating brute force or reconnaissance.",
                "relevant_fields": [
                  "times: List"
                ]
              },
              {
                "indicator_category": "Suspicious Event Outcomes",
                "Instruction": "Repeated failures followed by success (`statuses`) indicating credential stuffing.",
                "relevant_fields": [
                  "statuses: List"
                ]
              }
            ],
            "attack_pattern_checks": [
              {
                "attack_pattern_name": "T1078 - Valid Accounts",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you find evidence of legitimate credentials being used from unexpected source hosts or for disabled accounts. As proof, provide the source/destination entities and relevant timestamps.",
                "evidence": []
              },
              {
                "attack_pattern_name": "T1110.001 - Brute Force",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Brute Force Attack' behavioral pattern. As proof, provide the source/destination entities and the relevant timestamps.",
                "evidence": []
              },
              {
                "attack_pattern_name": "T1110.003 - Password Spraying",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Detect Password Spraying' detection rule. As proof, provide the source computer, the list of targeted users, and the relevant timestamps.",
                "evidence": []
              },
              {
                "attack_pattern_name": "T1550.002 - Pass the Hash",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Identify Pass-the-Hash' detection rule. As proof, provide the source and destination entities, the protocol used, and the relevant timestamps.",
                "evidence": []
              },
              {
                "attack_pattern_name": "T1558.003 - Kerberoasting",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Flag Kerberoasting Attempts' detection rule. As proof, provide the targeted service account and the relevant timestamps of the ticket requests.",
                "evidence": []
              },
              {
                "attack_pattern_name": "T1003.001 - OS Credential Dumping: LSASS Memory",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe subsequent machine-account logons from an unusual source computer with an unusual authentication type, which may indicate prior credential dumping. As proof, describe the anomalous machine-account logon event.",
                "evidence": []
              },
              {
                "attack_pattern_name": "T1021.001 - Remote Desktop Protocol",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'RDP Lateral Movement' detection rule. As proof, provide the source and destination hosts, the user, and the timestamp of the interactive logon.",
                "evidence": []
              },
              {
                "attack_pattern_name": "T1621 - Multi-Factor Authentication Request Generation",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'MFA Fatigue Attack' detection rule. As proof, provide the targeted user and the timeframe of the high-volume failed logon attempts.",
                "evidence": []
              },
              {
                "attack_pattern_name": "T1556.006 - Modify Authentication Process: Multi-Factor Authentication",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe a successful logon event for a new source computer registration under an existing user account, particularly on ADFS or Okta correlated events. As proof, detail the registration event.",
                "evidence": []
              }
            ],
            "vulnerability_checks": [
              {
                "vulnerability_id": "CVE-2022-30170 (Credential Roaming)",
                "is_present": false,
                "evidence_instruction": "For CVE-2022-30170, set `is_present` to `true` if you observe unusual LDAP attribute access or modifications related to credential roaming features, which may not be directly visible in authentication logs but could be correlated. As proof, describe any related anomalous LDAP events if available.",
                "evidence": []
              },
              {
                "vulnerability_id": "Legacy NTLM/LM Fallback",
                "is_present": false,
                "evidence_instruction": "Set `is_present` to `true` if you observe successful or failed authentication events where the `auth_type` is identified as 'LM' or 'NTLMv1', especially in an environment where policy should disable them. As proof, provide the event details including the protocol used and the involved entities.",
                "evidence": []
              }
            ]
          },
          "raw_response": "```json\n{\n  \"Log_context\": {\n    \"log_type\": \"Windows Authentication Log\",\n    \"log_description\": \"Windows Authentication Logs are one of the most critical data sources for detecting and investigating adversary behavior, including credential theft, lateral movement, and persistence techniques. This report synthesizes industry and academic research, maps key MITRE ATT&CK® techniques, enumerates observable patterns in authentication events, and provides actionable detection and response guidance.\"\n  },\n  \"observations\": {\n    \"behavioral_patterns\": {\n      \"malicious\": [\n        {\n          \"pattern_name\": \"Password Spraying\",\n          \"Instruction\": \"Broad targeting of multiple accounts from one host with low-frequency failures to evade lockout.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"destination_users: List\",\n            \"statuses: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Brute Force Attack\",\n          \"Instruction\": \"Rapid-fire authentication failures against a single account indicating credential guessing.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"destination_users: List\",\n            \"statuses: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Pass-the-Hash\",\n          \"Instruction\": \"Successful NTLM authentication (auth_type) on network logons (logon_type) without Kerberos fallback.\",\n          \"identifiable_fields\": [\n            \"auth_type: List\",\n            \"logon_type: List\",\n            \"source_users: List\",\n            \"destination_computer: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Kerberoasting\",\n          \"Instruction\": \"Unusually high Kerberos service ticket requests for service accounts outside normal usage periods.\",\n          \"identifiable_fields\": [\n            \"auth_type: List\",\n            \"destination_users: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Pass-the-Ticket\",\n          \"Instruction\": \"Multiple Kerberos (auth_type) logons for high-privilege accounts without prior ticket-granting ticket requests.\",\n          \"identifiable_fields\": [\n            \"auth_type: List\",\n            \"source_users: List\",\n            \"statuses: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"RDP-based Lateral Movement\",\n          \"Instruction\": \"Interactive logons (logon_type: 10) from remote hosts not normally accessed by user.\",\n          \"identifiable_fields\": [\n            \"logon_type: List\",\n            \"source_computer: List\",\n            \"destination_computer: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Golden Ticket Use\",\n          \"Instruction\": \"Kerberos logons (auth_type) for non-existent or service accounts with no corresponding TGT events.\",\n          \"identifiable_fields\": [\n            \"auth_type: List\",\n            \"destination_users: List\",\n            \"statuses: List\"\n          ]\n        }\n      ],\n      \"anomalous\": [\n        {\n          \"pattern_name\": \"Impossible Travel\",\n          \"Instruction\": \"Logons for same user from geographically disparate hosts within implausible timeframes.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"source_users: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Unusual Protocol Usage\",\n          \"Instruction\": \"NTLM logon events in environments locked to Kerberos-only authentication.\",\n          \"identifiable_fields\": [\n            \"auth_type: List\",\n            \"source_users: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Out-of-Hours Logons\",\n          \"Instruction\": \"Successful logons occurring outside established business hours for a given user.\",\n          \"identifiable_fields\": [\n            \"times: List\",\n            \"source_users: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Service Account Interactive Logon\",\n          \"Instruction\": \"Non-service hosts showing interactive (logon_type: 2) logons by service accounts.\",\n          \"identifiable_fields\": [\n            \"destination_users: List\",\n            \"logon_type: List\",\n            \"destination_computer: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Account Lockout Storm\",\n          \"Instruction\": \"Multiple failure events followed by a lockout (event ID 4740) within a short period.\",\n          \"identifiable_fields\": [\n            \"statuses: List\",\n            \"source_users: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"New Host Access\",\n          \"Instruction\": \"First-time successful logon by a user to a host in their typical domain scope.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"source_users: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Orphaned Logoff\",\n          \"Instruction\": \"Logon events with no subsequent logoff (orientations) indicating potential persistence.\",\n          \"identifiable_fields\": [\n            \"orientations: List\",\n            \"times: List\"\n          ]\n        }\n      ],\n      \"vulnerable\": [\n        {\n          \"pattern_name\": \"Legacy Protocol Fall-back\",\n          \"Instruction\": \"Use of LM or NTLMv1 protocols despite policy disabling them.\",\n          \"identifiable_fields\": [\n            \"auth_type: List\",\n            \"statuses: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Shared Account Across Hosts\",\n          \"Instruction\": \"Same account logging into multiple unrelated hosts simultaneously.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"source_users: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Disabled Account Attempts\",\n          \"Instruction\": \"Authentication failures (statuses: Failure) for known-disabled accounts.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"statuses: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Excessive Failure Noise\",\n          \"Instruction\": \"High volume of failed logons from one host without any successes, indicating misconfiguration or reconnaissance.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"statuses: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Default Credential Usage\",\n          \"Instruction\": \"Attempts to log on with default or well-known account names (e.g., “Administrator”, “Guest”).\",\n          \"identifiable_fields\": [\n            \"destination_users: List\",\n            \"statuses: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Non-Rotating Service Account Logon\",\n          \"Instruction\": \"Long-lived service accounts authenticating interactively at irregular intervals.\",\n          \"identifiable_fields\": [\n            \"destination_users: List\",\n            \"times: List\",\n            \"logon_type: List\"\n          ]\n        }\n      ]\n    },\n    \"temporal_patterns\": {\n      \"malicious\": [\n        {\n          \"pattern_name\": \"Password Spraying\",\n          \"Instruction\": \"Broad targeting of multiple accounts from one host with low-frequency failures to evade lockout.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"destination_users: List\",\n            \"statuses: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Brute Force Attack\",\n          \"Instruction\": \"Rapid-fire authentication failures against a single account indicating credential guessing.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"destination_users: List\",\n            \"statuses: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Kerberoasting\",\n          \"Instruction\": \"Unusually high Kerberos service ticket requests for service accounts outside normal usage periods.\",\n          \"identifiable_fields\": [\n            \"auth_type: List\",\n            \"destination_users: List\",\n            \"times: List\"\n          ]\n        }\n      ],\n      \"anomalous\": [\n        {\n          \"pattern_name\": \"Impossible Travel\",\n          \"Instruction\": \"Logons for same user from geographically disparate hosts within implausible timeframes.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"source_users: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Out-of-Hours Logons\",\n          \"Instruction\": \"Successful logons occurring outside established business hours for a given user.\",\n          \"identifiable_fields\": [\n            \"times: List\",\n            \"source_users: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Account Lockout Storm\",\n          \"Instruction\": \"Multiple failure events followed by a lockout (event ID 4740) within a short period.\",\n          \"identifiable_fields\": [\n            \"statuses: List\",\n            \"source_users: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Orphaned Logoff\",\n          \"Instruction\": \"Logon events with no subsequent logoff (orientations) indicating potential persistence.\",\n          \"identifiable_fields\": [\n            \"orientations: List\",\n            \"times: List\"\n          ]\n        }\n      ],\n      \"vulnerable\": [\n        {\n          \"pattern_name\": \"Shared Account Across Hosts\",\n          \"Instruction\": \"Same account logging into multiple unrelated hosts simultaneously.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"source_users: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Excessive Failure Noise\",\n          \"Instruction\": \"High volume of failed logons from one host without any successes, indicating misconfiguration or reconnaissance.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"statuses: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Non-Rotating Service Account Logon\",\n          \"Instruction\": \"Long-lived service accounts authenticating interactively at irregular intervals.\",\n          \"identifiable_fields\": [\n            \"destination_users: List\",\n            \"times: List\",\n            \"logon_type: List\"\n          ]\n        }\n      ]\n    }\n  },\n  \"entity_analysis_instructions\": {\n    \"source_profiling_queries\": [\n      {\n        \"query_name\": \"Identify Malicious and Anomalous Source Entities\",\n        \"instruction\": \"From the raw logs, extract and list all `source_computer` and `source_users` that are directly involved in the following patterns: 'Password Spraying', 'Brute Force Attack', 'Pass-the-Hash', 'Pass-the-Ticket', 'Impossible Travel', 'Unusual Protocol Usage', 'New Host Access', and 'Shared Account Across Hosts'.\"\n      }\n    ],\n    \"target_profiling_queries\": [\n      {\n        \"query_name\": \"Identify High-Value or Frequently Targeted Entities\",\n        \"instruction\": \"From the raw logs, extract and list all `destination_computer` and `destination_users` that are involved in patterns like 'Pass-the-Hash', 'Kerberoasting', 'RDP-based Lateral Movement', 'Service Account Interactive Logon' or appear as a target in multiple anomalous events.\"\n      }\n    ]\n  },\n  \"detection_rule_checklist\": [\n    {\n      \"detection_name\": \"Detect Password Spraying\",\n      \"mapped_ttp\": \"T1110.003\",\n      \"threat_scenario\": \"Count failed `statuses` per `source_computer` across ≥ 10 unique `destination_users` within 5 minutes.\",\n      \"detection_logic\": \"- Filter events where `statuses: Failure` and `times` in a rolling 5-minute window\\n- Aggregate by `source_computer`, count distinct `destination_users`\\n- Alert if count ≥ 10\",\n      \"detection_probability\": null,\n      \"Details_reasoning_with_fields\": \"To determine the probability, analyze the logs for events matching the detection logic. Specifically, look for a single `source_computer` generating failed authentication events (`statuses: Failure`) for ten or more distinct `destination_users` within a 5-minute `times` window. The presence of these correlated fields directly indicates a password spraying attack.\"\n    },\n    {\n      \"detection_name\": \"Identify Pass-the-Hash\",\n      \"mapped_ttp\": \"T1550.002\",\n      \"threat_scenario\": \"Successful logon where `auth_type: NTLM`, `logon_type: 3 (Network)`, and destination account is high-privilege.\",\n      \"detection_logic\": \"- Filter events where `auth_type == \\\"NTLM\\\"` AND `logon_type == \\\"Network\\\"` AND `statuses == \\\"Success\\\"`\\n- Destination account in privileged group list\",\n      \"detection_probability\": null,\n      \"Details_reasoning_with_fields\": \"To determine the probability, identify successful logons (`statuses: Success`) using the NTLM protocol (`auth_type: NTLM`) with a network logon type (`logon_type: 3 (Network)`). The key is to correlate this with the `destination_users` being a member of a high-privilege group. The combination of these specific field values is a strong indicator of a Pass-the-Hash attempt.\"\n    },\n    {\n      \"detection_name\": \"Flag Kerberoasting Attempts\",\n      \"mapped_ttp\": \"T1558.003\",\n      \"threat_scenario\": \"≥ 5 Kerberos (`auth_type`) service ticket requests for a single `destination_users` within 10 minutes.\",\n      \"detection_logic\": \"- Filter events where `auth_type == \\\"Kerberos\\\"` AND `destination_users` is a service account\\n- Aggregate by `destination_users`, count in rolling 10-minute window\\n- Alert if count ≥ 5\",\n      \"detection_probability\": null,\n      \"Details_reasoning_with_fields\": \"To determine the probability, look for a high frequency of Kerberos authentication events (`auth_type: Kerberos`). The detection requires identifying a single service account (`destination_users`) receiving five or more service ticket requests within a 10-minute `times` window. This focuses on the temporal correlation of `auth_type` and `destination_users`.\"\n    },\n    {\n      \"detection_name\": \"RDP Lateral Movement\",\n      \"mapped_ttp\": \"T1021.001\",\n      \"threat_scenario\": \"Interactive logon (`logon_type: 10`) from non-standard `source_computer` to domain workstations/servers.\",\n      \"detection_logic\": \"- Filter where `logon_type == \\\"Interactive\\\"` AND `source_computer` not in baseline list for user\",\n      \"detection_probability\": null,\n      \"Details_reasoning_with_fields\": \"To determine the probability, filter for interactive logons (`logon_type: 10`). The critical step is to check if the `source_computer` for a given logon is not on a pre-established baseline of allowed hosts for that `source_users`. The detection relies on the relationship between `logon_type`, `source_computer`, and the user's normal activity profile.\"\n    },\n    {\n      \"detection_name\": \"MFA Fatigue Attack\",\n      \"mapped_ttp\": \"T1621\",\n      \"threat_scenario\": \"≥ 20 failed MFA-associated `statuses` for same `source_users` in 1 hour.\",\n      \"detection_logic\": \"- Correlate authentication events with MFA challenge outcome logs\\n- Aggregate failure count by `source_users`\\n- Alert if count ≥ 20 in 60 minutes\",\n      \"detection_probability\": null,\n      \"Details_reasoning_with_fields\": \"To determine the probability, you must correlate Windows authentication logs with MFA logs. The logic requires counting a high number of failed authentication events (`statuses: Failure`) for a single `source_users` over a 60-minute `times` window. The key is the high volume of failures for a specific user, indicating a bombardment attempt.\"\n    }\n  ],\n  \"indicators_of_compromise\": [\n    {\n      \"indicator_category\": \"Unrecognized or Unusual Source Hostnames\",\n      \"Instruction\": \"Unrecognized or unusual `source_computer` identifiers may indicate attacker-controlled systems.\",\n      \"relevant_fields\": [\n        \"source_computer: List\"\n      ]\n    },\n    {\n      \"indicator_category\": \"Anomalous Destination Hostnames\",\n      \"Instruction\": \"Access attempts to critical servers (`destination_computer`), especially domain controllers.\",\n      \"relevant_fields\": [\n        \"destination_computer: List\"\n      ]\n    },\n    {\n      \"indicator_category\": \"Anomalous User Account Usage\",\n      \"Instruction\": \"Compromised or service accounts (`source_users`/`destination_users`) involved in anomalous logons.\",\n      \"relevant_fields\": [\n        \"source_users: List\",\n        \"destination_users: List\"\n      ]\n    },\n    {\n      \"indicator_category\": \"Divergent Authentication Protocols\",\n      \"Instruction\": \"NTLM vs Kerberos (`auth_type`) divergence from normal baselines.\",\n      \"relevant_fields\": [\n        \"auth_type: List\"\n      ]\n    },\n    {\n      \"indicator_category\": \"Anomalous Logon Types\",\n      \"Instruction\": \"Elevated remote interactive (`logon_type: 10`) vs console access.\",\n      \"relevant_fields\": [\n        \"logon_type: List\"\n      ]\n    },\n    {\n      \"indicator_category\": \"Unusual Timestamps\",\n      \"Instruction\": \"Off-hours or rapid successive events in `times` indicating brute force or reconnaissance.\",\n      \"relevant_fields\": [\n        \"times: List\"\n      ]\n    },\n    {\n      \"indicator_category\": \"Suspicious Event Outcomes\",\n      \"Instruction\": \"Repeated failures followed by success (`statuses`) indicating credential stuffing.\",\n      \"relevant_fields\": [\n        \"statuses: List\"\n      ]\n    }\n  ],\n  \"attack_pattern_checks\": [\n    {\n      \"attack_pattern_name\": \"T1078 - Valid Accounts\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you find evidence of legitimate credentials being used from unexpected source hosts or for disabled accounts. As proof, provide the source/destination entities and relevant timestamps.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"T1110.001 - Brute Force\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you find evidence matching the 'Brute Force Attack' behavioral pattern. As proof, provide the source/destination entities and the relevant timestamps.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"T1110.003 - Password Spraying\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you find evidence matching the 'Detect Password Spraying' detection rule. As proof, provide the source computer, the list of targeted users, and the relevant timestamps.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"T1550.002 - Pass the Hash\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you find evidence matching the 'Identify Pass-the-Hash' detection rule. As proof, provide the source and destination entities, the protocol used, and the relevant timestamps.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"T1558.003 - Kerberoasting\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you find evidence matching the 'Flag Kerberoasting Attempts' detection rule. As proof, provide the targeted service account and the relevant timestamps of the ticket requests.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"T1003.001 - OS Credential Dumping: LSASS Memory\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe subsequent machine-account logons from an unusual source computer with an unusual authentication type, which may indicate prior credential dumping. As proof, describe the anomalous machine-account logon event.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"T1021.001 - Remote Desktop Protocol\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you find evidence matching the 'RDP Lateral Movement' detection rule. As proof, provide the source and destination hosts, the user, and the timestamp of the interactive logon.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"T1621 - Multi-Factor Authentication Request Generation\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you find evidence matching the 'MFA Fatigue Attack' detection rule. As proof, provide the targeted user and the timeframe of the high-volume failed logon attempts.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"T1556.006 - Modify Authentication Process: Multi-Factor Authentication\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe a successful logon event for a new source computer registration under an existing user account, particularly on ADFS or Okta correlated events. As proof, detail the registration event.\",\n      \"evidence\": []\n    }\n  ],\n  \"vulnerability_checks\": [\n    {\n      \"vulnerability_id\": \"CVE-2022-30170 (Credential Roaming)\",\n      \"is_present\": false,\n      \"evidence_instruction\": \"For CVE-2022-30170, set `is_present` to `true` if you observe unusual LDAP attribute access or modifications related to credential roaming features, which may not be directly visible in authentication logs but could be correlated. As proof, describe any related anomalous LDAP events if available.\",\n      \"evidence\": []\n    },\n    {\n      \"vulnerability_id\": \"Legacy NTLM/LM Fallback\",\n      \"is_present\": false,\n      \"evidence_instruction\": \"Set `is_present` to `true` if you observe successful or failed authentication events where the `auth_type` is identified as 'LM' or 'NTLMv1', especially in an environment where policy should disable them. As proof, provide the event details including the protocol used and the involved entities.\",\n      \"evidence\": []\n    }\n  ]\n}\n```",
          "model": "gemini-2.5-pro",
          "provider": "gemini",
          "report_source": "openai"
        },
        "gemini_from_gemini_report": {
          "parsed_json": {
            "Log_context": {
              "log_type": "Windows Authentication Logs",
              "log_description": "A critical data source for detecting and responding to a wide array of cyber threats. These logs are fundamental to security monitoring as they capture the core of user and system activity within a Windows environment: every logon, logoff, and authentication attempt. They are crucial for detecting lateral movement, credential dumping, Pass-the-Hash, brute-force attacks, and the abuse of legitimate administrative tools."
            },
            "observations": {
              "behavioral_patterns": {
                "malicious": [
                  {
                    "pattern_name": "High Volume of Failed Logons (Brute Force)",
                    "Instruction": "A large number of failed logon attempts from a single source computer targeting one or more destination users in a short time frame. This is a classic indicator of a brute-force or password spraying attack.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "destination_users: List",
                      "statuses: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Successful Logon After Multiple Failures",
                    "Instruction": "A sequence of failed logon events (`statuses`: \"Failure\") followed immediately by a successful logon (`statuses`: \"Success\") for the same user. This can indicate a successful password guessing attempt.",
                    "identifiable_fields": [
                      "destination_users: List",
                      "source_computer: List",
                      "statuses: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "NTLM Logon for Remote Administrative Access (Pass-the-Hash)",
                    "Instruction": "A successful network logon (`logon_type`: 3) using NTLM authentication (`auth_type`: \"NTLM\") by an administrative account to a remote system. Kerberos is expected for legitimate domain admin activity; NTLM usage can suggest a Pass-the-Hash attack.",
                    "identifiable_fields": [
                      "source_users: List",
                      "destination_computer: List",
                      "logon_type: List",
                      "auth_type: List",
                      "statuses: List"
                    ]
                  },
                  {
                    "pattern_name": "Lateral Movement via Remote Interactive Logon",
                    "Instruction": "A user account logging on to multiple workstations or servers via Remote Desktop (`logon_type`: 10) in rapid succession. This is highly indicative of an attacker exploring the network.",
                    "identifiable_fields": [
                      "source_users: List",
                      "destination_computer: List",
                      "logon_type: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Logon with Explicit Credentials by Unexpected Account",
                    "Instruction": "An event (ID 4648) showing that a user or process used the credentials of a *different* user to access a resource. This is common in \"runas\" scenarios but is suspicious when the source or target user is unexpected, often indicating lateral movement.",
                    "identifiable_fields": [
                      "source_users: List",
                      "destination_users: List",
                      "source_computer: List",
                      "destination_computer: List"
                    ]
                  },
                  {
                    "pattern_name": "First-time Logon from a User to a Critical Server",
                    "Instruction": "A user account that has never logged into a specific critical asset (like a domain controller or database server) before suddenly authenticates successfully.",
                    "identifiable_fields": [
                      "source_users: List",
                      "destination_computer: List",
                      "statuses: List"
                    ]
                  },
                  {
                    "pattern_name": "Service Account Interactive Logon",
                    "Instruction": "A service account, which should only perform automated tasks and network logons (`logon_type`: 5 or 3), performs an interactive logon (`logon_type`: 2) or remote interactive logon (`logon_type`: 10). This is highly anomalous and suggests account compromise.",
                    "identifiable_fields": [
                      "source_users: List",
                      "logon_type: List"
                    ]
                  }
                ],
                "anomalous": [
                  {
                    "pattern_name": "Multiple Users Logged into a Single Workstation",
                    "Instruction": "Multiple distinct user accounts are concurrently logged onto a standard end-user workstation within a short time window. This is abnormal for typical user behavior.",
                    "identifiable_fields": [
                      "destination_computer: List",
                      "source_users: List",
                      "times: List",
                      "orientations: List"
                    ]
                  },
                  {
                    "pattern_name": "Same User Logged into Multiple Hosts Simultaneously",
                    "Instruction": "A single user account shows active logon sessions on a large number of different computers simultaneously. While some roaming is normal, a widespread pattern can indicate credential abuse.",
                    "identifiable_fields": [
                      "source_users: List",
                      "destination_computer: List",
                      "times: List",
                      "orientations: List"
                    ]
                  },
                  {
                    "pattern_name": "Authentication from Non-Standard Hostname",
                    "Instruction": "Authentication attempts originating from a `source_computer` with a hostname that does not conform to the organization's standard naming convention.",
                    "identifiable_fields": [
                      "source_computer: List"
                    ]
                  },
                  {
                    "pattern_name": "Sudden Spike in Kerberos Ticket Requests",
                    "Instruction": "A sudden, anomalous increase in Kerberos ticket requests (Event ID 4768/4769), especially from a single host, which could indicate reconnaissance or a Kerberoasting attack.",
                    "identifiable_fields": [
                      "source_computer: List",
                      "auth_type: List",
                      "times: List"
                    ]
                  }
                ],
                "vulnerable": [
                  {
                    "pattern_name": "Use of Weak Kerberos Encryption (RC4/DES)",
                    "Instruction": "Authentication events show the use of weak or deprecated Kerberos encryption types like RC4 or DES. This makes credentials susceptible to offline cracking and is a significant hygiene issue.",
                    "identifiable_fields": [
                      "auth_type: List"
                    ]
                  },
                  {
                    "pattern_name": "Excessive NTLMv1 Authentication",
                    "Instruction": "The continued use of the outdated and insecure NTLMv1 protocol. NTLMv1 is highly vulnerable to relay and cracking attacks and should be disabled.",
                    "identifiable_fields": [
                      "auth_type: List"
                    ]
                  },
                  {
                    "pattern_name": "Accounts with No Pre-Authentication Required",
                    "Instruction": "Kerberos pre-authentication is a security feature that helps prevent offline password cracking. An authentication attempt for an account where this is disabled is a vulnerability. This is often detected via Kerberos event logs (4768).",
                    "identifiable_fields": []
                  },
                  {
                    "pattern_name": "Cleartext Password Submission over Network",
                    "Instruction": "Some configurations might allow passwords to be sent in cleartext, which would be logged in certain events (e.g., if WDigest is enabled). This is a critical vulnerability.",
                    "identifiable_fields": []
                  },
                  {
                    "pattern_name": "Privileged Account Logon to a Workstation",
                    "Instruction": "A domain administrator or other highly privileged account (`source_users`) logs on to a standard user workstation (`destination_computer`). This increases the risk of credential theft via LSASS dumping.",
                    "identifiable_fields": [
                      "source_users: List",
                      "destination_computer: List",
                      "logon_type: List"
                    ]
                  },
                  {
                    "pattern_name": "Authentication from a Device with Known Vulnerabilities",
                    "Instruction": "A successful authentication from a `source_computer` that is known to be unpatched or have critical vulnerabilities. This indicates a high-risk entry point.",
                    "identifiable_fields": [
                      "source_computer: List"
                    ]
                  }
                ]
              },
              "temporal_patterns": {
                "anomalous": [
                  {
                    "pattern_name": "Impossible Travel",
                    "Instruction": "A single user account successfully authenticates from two geographically distant `source_computer` locations in a time frame that would be impossible to travel between.",
                    "identifiable_fields": [
                      "source_users: List",
                      "source_computer: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Off-Hours Authentication",
                    "Instruction": "A user account authenticates at unusual times, such as late at night or on weekends, contrary to their established baseline of activity.",
                    "identifiable_fields": [
                      "source_users: List",
                      "times: List"
                    ]
                  },
                  {
                    "pattern_name": "Excessive Logoff/Logon Activity",
                    "Instruction": "An abnormally high frequency of logon and logoff events (`orientations`) for a single user or on a single machine, which could indicate scripted activity or an unstable connection being exploited.",
                    "identifiable_fields": [
                      "source_users: List",
                      "destination_computer: List",
                      "orientations: List",
                      "times: List"
                    ]
                  }
                ]
              }
            },
            "entity_analysis_instructions": {
              "source_profiling_queries": [
                {
                  "query_name": "Identify Malicious and Anomalous Source Entities",
                  "instruction": "From the raw logs, extract and list all `source_computer` and `source_users` that are directly involved in the following patterns: 'High Volume of Failed Logons (Brute Force)', 'Successful Logon After Multiple Failures', 'NTLM Logon for Remote Administrative Access (Pass-the-Hash)', 'Service Account Interactive Logon', 'Authentication from Non-Standard Hostname', and 'Impossible Travel'."
                }
              ],
              "target_profiling_queries": [
                {
                  "query_name": "Identify High-Value or Frequently Targeted Systems",
                  "instruction": "From the raw logs, extract and list all `destination_computer` and `destination_users` that are involved in patterns like 'Privileged Account Logon to a Workstation', 'First-time Logon from a User to a Critical Server', or appear as a target in a high number of 'High Volume of Failed Logons (Brute Force)' events."
                }
              ]
            },
            "detection_rule_checklist": [
              {
                "detection_name": "Potential Brute-Force or Password Spraying Attack",
                "mapped_ttp": "T1110 (Brute Force)",
                "threat_scenario": "An attacker is attempting to guess user credentials through brute force (many passwords for one user) or password spraying (one password for many users).",
                "detection_logic": "Alert when a single `source_computer` generates more than 20 failed logon events (`statuses`: \"Failure\") within a 5-minute window. Group by `source_computer`. A lower threshold (e.g., 5 failures) targeting more than 50 distinct `destination_users` can specifically detect password spraying.",
                "detection_probability": 0.8,
                "Details_reasoning_with_fields": "This detection has a high probability of success by correlating a high count of failures from a single origin. The key fields are `source_computer` to identify the origin of the attack, `statuses` to count the 'Failure' events, `destination_users` to differentiate between brute-force and password spraying, and `times` to apply the time window for the correlation."
              },
              {
                "detection_name": "Successful Logon Immediately Following Failed Attempts",
                "mapped_ttp": "T1110 (Brute Force), T1078 (Valid Accounts)",
                "threat_scenario": "An attacker successfully guesses a password after multiple attempts.",
                "detection_logic": "Alert when a successful logon event (`statuses`: \"Success\") for a `destination_users` from a specific `source_computer` is preceded by 5 or more failed logon events for the same user from the same source within the last 15 minutes.",
                "detection_probability": 0.9,
                "Details_reasoning_with_fields": "This is a very strong indicator of a successful guess. The detection relies on tracking state over time. The key fields are `statuses` to find the 'Failure' to 'Success' transition, `destination_users` and `source_computer` to ensure the events are for the same session, and `times` to define the 15-minute correlation window."
              },
              {
                "detection_name": "Potential Pass-the-Hash (PtH) Activity",
                "mapped_ttp": "T1550.002 (Use Alternate Authentication Material: Pass the Hash)",
                "threat_scenario": "An attacker is using a stolen NTLM hash to authenticate to a remote system, bypassing the need for a password.",
                "detection_logic": "Alert on a successful network logon (`logon_type`: 3) that uses NTLM authentication (`auth_type`: \"NTLM\") for a privileged user account (`source_users`) to a `destination_computer` where that user has no prior interactive logon history.",
                "detection_probability": 0.7,
                "Details_reasoning_with_fields": "This detection identifies behavior that is highly anomalous for legitimate administrative activity. It is detected by combining multiple fields: `logon_type` must be '3' (Network), `auth_type` must be 'NTLM', `source_users` should be a member of a privileged group, and this activity must be cross-referenced with historical data to confirm the lack of prior interactive logons from that user to the `destination_computer`."
              },
              {
                "detection_name": "Anomalous Remote Desktop (RDP) Logon",
                "mapped_ttp": "T1021.001 (Remote Services: Remote Desktop Protocol), T1078 (Valid Accounts)",
                "threat_scenario": "An attacker is moving laterally between hosts using RDP.",
                "detection_logic": "Alert when a user account (`source_users`) initiates a remote interactive logon (`logon_type`: 10) to a `destination_computer` that is not on a pre-approved list of administrative jump boxes or servers for that user. Also, alert if a user logs into more than 5 distinct hosts via RDP within one hour.",
                "detection_probability": 0.75,
                "Details_reasoning_with_fields": "This rule detects lateral movement by identifying unusual RDP patterns. The detection relies on `logon_type` being '10' (RemoteInteractive), and then applying logic based on `source_users` and `destination_computer` against an allow-list or by using `times` to count the frequency of distinct `destination_computer` logons by the same `source_users`."
              },
              {
                "detection_name": "Service Account Interactive Logon",
                "mapped_ttp": "T1078 (Valid Accounts)",
                "threat_scenario": "A service account has been compromised and is being used by an attacker for interactive access.",
                "detection_logic": "Alert whenever an account known to be a service account (based on naming convention or group membership) generates a logon event with `logon_type` 2 (Interactive) or 10 (Remote Interactive).",
                "detection_probability": 0.95,
                "Details_reasoning_with_fields": "This is a high-fidelity alert as service accounts should never log on interactively. The detection requires identifying a `source_users` as a service account and checking if the `logon_type` is '2' or '10'. This is a very strong signal of compromise."
              }
            ],
            "indicators_of_compromise": [
              {
                "indicator_category": "Suspicious Source Hostnames",
                "Instruction": "Hostnames that do not conform to internal naming conventions, are randomly generated, or are known to be associated with malicious tools. This can indicate an unauthorized device on the network.",
                "relevant_fields": [
                  "source_computer:"
                ]
              },
              {
                "indicator_category": "Known Malicious Source IP Addresses",
                "Instruction": "Authentication attempts originating from IP addresses listed on threat intelligence feeds as being malicious, command-and-control (C2) servers, or Tor exit nodes.",
                "relevant_fields": [
                  "source_computer:"
                ]
              },
              {
                "indicator_category": "Use of Common Hacking/Admin Tool Names as Usernames/Hostnames",
                "Instruction": "Usernames or hostnames that match the names of common penetration testing or administration tools (e.g., \"mimikatz\", \"psexec\", \"kali\").",
                "relevant_fields": [
                  "source_computer:",
                  "source_users:",
                  "destination_users:"
                ]
              }
            ],
            "attack_pattern_checks": [
              {
                "attack_pattern_name": "Brute Force (T1110)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Potential Brute-Force or Password Spraying Attack' or 'Successful Logon Immediately Following Failed Attempts' detection rules. As proof, provide the source and target entities and the relevant timestamps.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Password Spraying (T1110.003)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Potential Brute-Force or Password Spraying Attack' detection rule, specifically the logic for one source attacking many destination users. As proof, provide the source computer and a list of targeted user accounts.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Pass the Hash (T1550.002)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Potential Pass-the-Hash (PtH) Activity' detection rule. As proof, provide the source computer, destination computer, user account, and the timestamp of the NTLM network logon.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Pass the Ticket (T1550.003)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe a Kerberos ticket being used from a source computer where the associated user has no recent interactive logon history, indicating the ticket was likely stolen and moved. As proof, list the source, destination, user, and time.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Kerberoasting (T1558.003)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe a 'Sudden Spike in Kerberos Ticket Requests' from a single host, especially for service accounts. As proof, provide the source host and the list of requested service principal names.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Remote Services: Remote Desktop Protocol (T1021.001)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Anomalous Remote Desktop (RDP) Logon' detection rule. As proof, describe the anomalous RDP activity, including the user and the multiple hosts they connected to.",
                "evidence": []
              },
              {
                "attack_pattern_name": "Valid Accounts (T1078)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if any of the following detection rules are matched: 'Successful Logon Immediately Following Failed Attempts', 'Anomalous Remote Desktop (RDP) Logon', or 'Service Account Interactive Logon'. As proof, provide the details from the triggered detection.",
                "evidence": []
              },
              {
                "attack_pattern_name": "OS Credential Dumping: LSASS Memory (T1003.001)",
                "is_present": false,
                "evidence_Instruction": "Set `is_present` to `true` if you observe a successful logon from a user to a new destination computer shortly after suspicious process activity (like accessing lsass.exe) on the source computer. This requires correlation with process logs. As proof, show the logon event and reference the preceding suspicious process event.",
                "evidence": []
              }
            ],
            "vulnerability_checks": [
              {
                "vulnerability_id": "CVE-2024-20674",
                "is_present": false,
                "evidence_instruction": "For CVE-2024-20674, set `is_present` to `true` if you observe successful Kerberos authentication events that are preceded by Kerberos errors or anomalies, potentially indicating a machine-in-the-middle attack. As proof, describe the sequence of anomalous Kerberos events and associated entities.",
                "evidence": []
              },
              {
                "vulnerability_id": "CVE-2022-26931",
                "is_present": false,
                "evidence_instruction": "For CVE-2022-26931, set `is_present` to `true` if you observe a user account suddenly gaining higher privileges during certificate-based authentication. This may manifest as a logon event where the user's token has unexpected group memberships. As proof, detail the user and the anomalous privilege seen in the logon event.",
                "evidence": []
              },
              {
                "vulnerability_id": "NTLM Relay Vulnerabilities",
                "is_present": false,
                "evidence_instruction": "Set `is_present` to `true` if you observe a successful NTLM authentication to a server from a source that is not the user's actual machine, especially if the authentication is for a privileged service like SMB or HTTP. This often requires correlation with network traffic. As proof, show the NTLM logon and any evidence of it originating from a suspicious relay point.",
                "evidence": []
              }
            ]
          },
          "raw_response": "```json\n{\n  \"Log_context\": {\n    \"log_type\": \"Windows Authentication Logs\",\n    \"log_description\": \"A critical data source for detecting and responding to a wide array of cyber threats. These logs are fundamental to security monitoring as they capture the core of user and system activity within a Windows environment: every logon, logoff, and authentication attempt. They are crucial for detecting lateral movement, credential dumping, Pass-the-Hash, brute-force attacks, and the abuse of legitimate administrative tools.\"\n  },\n  \"observations\": {\n    \"behavioral_patterns\": {\n      \"malicious\": [\n        {\n          \"pattern_name\": \"High Volume of Failed Logons (Brute Force)\",\n          \"Instruction\": \"A large number of failed logon attempts from a single source computer targeting one or more destination users in a short time frame. This is a classic indicator of a brute-force or password spraying attack.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"destination_users: List\",\n            \"statuses: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Successful Logon After Multiple Failures\",\n          \"Instruction\": \"A sequence of failed logon events (`statuses`: \\\"Failure\\\") followed immediately by a successful logon (`statuses`: \\\"Success\\\") for the same user. This can indicate a successful password guessing attempt.\",\n          \"identifiable_fields\": [\n            \"destination_users: List\",\n            \"source_computer: List\",\n            \"statuses: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"NTLM Logon for Remote Administrative Access (Pass-the-Hash)\",\n          \"Instruction\": \"A successful network logon (`logon_type`: 3) using NTLM authentication (`auth_type`: \\\"NTLM\\\") by an administrative account to a remote system. Kerberos is expected for legitimate domain admin activity; NTLM usage can suggest a Pass-the-Hash attack.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"destination_computer: List\",\n            \"logon_type: List\",\n            \"auth_type: List\",\n            \"statuses: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Lateral Movement via Remote Interactive Logon\",\n          \"Instruction\": \"A user account logging on to multiple workstations or servers via Remote Desktop (`logon_type`: 10) in rapid succession. This is highly indicative of an attacker exploring the network.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"destination_computer: List\",\n            \"logon_type: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Logon with Explicit Credentials by Unexpected Account\",\n          \"Instruction\": \"An event (ID 4648) showing that a user or process used the credentials of a *different* user to access a resource. This is common in \\\"runas\\\" scenarios but is suspicious when the source or target user is unexpected, often indicating lateral movement.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"destination_users: List\",\n            \"source_computer: List\",\n            \"destination_computer: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"First-time Logon from a User to a Critical Server\",\n          \"Instruction\": \"A user account that has never logged into a specific critical asset (like a domain controller or database server) before suddenly authenticates successfully.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"destination_computer: List\",\n            \"statuses: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Service Account Interactive Logon\",\n          \"Instruction\": \"A service account, which should only perform automated tasks and network logons (`logon_type`: 5 or 3), performs an interactive logon (`logon_type`: 2) or remote interactive logon (`logon_type`: 10). This is highly anomalous and suggests account compromise.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"logon_type: List\"\n          ]\n        }\n      ],\n      \"anomalous\": [\n        {\n          \"pattern_name\": \"Multiple Users Logged into a Single Workstation\",\n          \"Instruction\": \"Multiple distinct user accounts are concurrently logged onto a standard end-user workstation within a short time window. This is abnormal for typical user behavior.\",\n          \"identifiable_fields\": [\n            \"destination_computer: List\",\n            \"source_users: List\",\n            \"times: List\",\n            \"orientations: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Same User Logged into Multiple Hosts Simultaneously\",\n          \"Instruction\": \"A single user account shows active logon sessions on a large number of different computers simultaneously. While some roaming is normal, a widespread pattern can indicate credential abuse.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"destination_computer: List\",\n            \"times: List\",\n            \"orientations: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Authentication from Non-Standard Hostname\",\n          \"Instruction\": \"Authentication attempts originating from a `source_computer` with a hostname that does not conform to the organization's standard naming convention.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Sudden Spike in Kerberos Ticket Requests\",\n          \"Instruction\": \"A sudden, anomalous increase in Kerberos ticket requests (Event ID 4768/4769), especially from a single host, which could indicate reconnaissance or a Kerberoasting attack.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\",\n            \"auth_type: List\",\n            \"times: List\"\n          ]\n        }\n      ],\n      \"vulnerable\": [\n        {\n          \"pattern_name\": \"Use of Weak Kerberos Encryption (RC4/DES)\",\n          \"Instruction\": \"Authentication events show the use of weak or deprecated Kerberos encryption types like RC4 or DES. This makes credentials susceptible to offline cracking and is a significant hygiene issue.\",\n          \"identifiable_fields\": [\n            \"auth_type: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Excessive NTLMv1 Authentication\",\n          \"Instruction\": \"The continued use of the outdated and insecure NTLMv1 protocol. NTLMv1 is highly vulnerable to relay and cracking attacks and should be disabled.\",\n          \"identifiable_fields\": [\n            \"auth_type: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Accounts with No Pre-Authentication Required\",\n          \"Instruction\": \"Kerberos pre-authentication is a security feature that helps prevent offline password cracking. An authentication attempt for an account where this is disabled is a vulnerability. This is often detected via Kerberos event logs (4768).\",\n          \"identifiable_fields\": []\n        },\n        {\n          \"pattern_name\": \"Cleartext Password Submission over Network\",\n          \"Instruction\": \"Some configurations might allow passwords to be sent in cleartext, which would be logged in certain events (e.g., if WDigest is enabled). This is a critical vulnerability.\",\n          \"identifiable_fields\": []\n        },\n        {\n          \"pattern_name\": \"Privileged Account Logon to a Workstation\",\n          \"Instruction\": \"A domain administrator or other highly privileged account (`source_users`) logs on to a standard user workstation (`destination_computer`). This increases the risk of credential theft via LSASS dumping.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"destination_computer: List\",\n            \"logon_type: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Authentication from a Device with Known Vulnerabilities\",\n          \"Instruction\": \"A successful authentication from a `source_computer` that is known to be unpatched or have critical vulnerabilities. This indicates a high-risk entry point.\",\n          \"identifiable_fields\": [\n            \"source_computer: List\"\n          ]\n        }\n      ]\n    },\n    \"temporal_patterns\": {\n      \"anomalous\": [\n        {\n          \"pattern_name\": \"Impossible Travel\",\n          \"Instruction\": \"A single user account successfully authenticates from two geographically distant `source_computer` locations in a time frame that would be impossible to travel between.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"source_computer: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Off-Hours Authentication\",\n          \"Instruction\": \"A user account authenticates at unusual times, such as late at night or on weekends, contrary to their established baseline of activity.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"times: List\"\n          ]\n        },\n        {\n          \"pattern_name\": \"Excessive Logoff/Logon Activity\",\n          \"Instruction\": \"An abnormally high frequency of logon and logoff events (`orientations`) for a single user or on a single machine, which could indicate scripted activity or an unstable connection being exploited.\",\n          \"identifiable_fields\": [\n            \"source_users: List\",\n            \"destination_computer: List\",\n            \"orientations: List\",\n            \"times: List\"\n          ]\n        }\n      ]\n    }\n  },\n  \"entity_analysis_instructions\": {\n    \"source_profiling_queries\": [\n      {\n        \"query_name\": \"Identify Malicious and Anomalous Source Entities\",\n        \"instruction\": \"From the raw logs, extract and list all `source_computer` and `source_users` that are directly involved in the following patterns: 'High Volume of Failed Logons (Brute Force)', 'Successful Logon After Multiple Failures', 'NTLM Logon for Remote Administrative Access (Pass-the-Hash)', 'Service Account Interactive Logon', 'Authentication from Non-Standard Hostname', and 'Impossible Travel'.\"\n      }\n    ],\n    \"target_profiling_queries\": [\n      {\n        \"query_name\": \"Identify High-Value or Frequently Targeted Systems\",\n        \"instruction\": \"From the raw logs, extract and list all `destination_computer` and `destination_users` that are involved in patterns like 'Privileged Account Logon to a Workstation', 'First-time Logon from a User to a Critical Server', or appear as a target in a high number of 'High Volume of Failed Logons (Brute Force)' events.\"\n      }\n    ]\n  },\n  \"detection_rule_checklist\": [\n    {\n      \"detection_name\": \"Potential Brute-Force or Password Spraying Attack\",\n      \"mapped_ttp\": \"T1110 (Brute Force)\",\n      \"threat_scenario\": \"An attacker is attempting to guess user credentials through brute force (many passwords for one user) or password spraying (one password for many users).\",\n      \"detection_logic\": \"Alert when a single `source_computer` generates more than 20 failed logon events (`statuses`: \\\"Failure\\\") within a 5-minute window. Group by `source_computer`. A lower threshold (e.g., 5 failures) targeting more than 50 distinct `destination_users` can specifically detect password spraying.\",\n      \"detection_probability\": 0.8,\n      \"Details_reasoning_with_fields\": \"This detection has a high probability of success by correlating a high count of failures from a single origin. The key fields are `source_computer` to identify the origin of the attack, `statuses` to count the 'Failure' events, `destination_users` to differentiate between brute-force and password spraying, and `times` to apply the time window for the correlation.\"\n    },\n    {\n      \"detection_name\": \"Successful Logon Immediately Following Failed Attempts\",\n      \"mapped_ttp\": \"T1110 (Brute Force), T1078 (Valid Accounts)\",\n      \"threat_scenario\": \"An attacker successfully guesses a password after multiple attempts.\",\n      \"detection_logic\": \"Alert when a successful logon event (`statuses`: \\\"Success\\\") for a `destination_users` from a specific `source_computer` is preceded by 5 or more failed logon events for the same user from the same source within the last 15 minutes.\",\n      \"detection_probability\": 0.9,\n      \"Details_reasoning_with_fields\": \"This is a very strong indicator of a successful guess. The detection relies on tracking state over time. The key fields are `statuses` to find the 'Failure' to 'Success' transition, `destination_users` and `source_computer` to ensure the events are for the same session, and `times` to define the 15-minute correlation window.\"\n    },\n    {\n      \"detection_name\": \"Potential Pass-the-Hash (PtH) Activity\",\n      \"mapped_ttp\": \"T1550.002 (Use Alternate Authentication Material: Pass the Hash)\",\n      \"threat_scenario\": \"An attacker is using a stolen NTLM hash to authenticate to a remote system, bypassing the need for a password.\",\n      \"detection_logic\": \"Alert on a successful network logon (`logon_type`: 3) that uses NTLM authentication (`auth_type`: \\\"NTLM\\\") for a privileged user account (`source_users`) to a `destination_computer` where that user has no prior interactive logon history.\",\n      \"detection_probability\": 0.7,\n      \"Details_reasoning_with_fields\": \"This detection identifies behavior that is highly anomalous for legitimate administrative activity. It is detected by combining multiple fields: `logon_type` must be '3' (Network), `auth_type` must be 'NTLM', `source_users` should be a member of a privileged group, and this activity must be cross-referenced with historical data to confirm the lack of prior interactive logons from that user to the `destination_computer`.\"\n    },\n    {\n      \"detection_name\": \"Anomalous Remote Desktop (RDP) Logon\",\n      \"mapped_ttp\": \"T1021.001 (Remote Services: Remote Desktop Protocol), T1078 (Valid Accounts)\",\n      \"threat_scenario\": \"An attacker is moving laterally between hosts using RDP.\",\n      \"detection_logic\": \"Alert when a user account (`source_users`) initiates a remote interactive logon (`logon_type`: 10) to a `destination_computer` that is not on a pre-approved list of administrative jump boxes or servers for that user. Also, alert if a user logs into more than 5 distinct hosts via RDP within one hour.\",\n      \"detection_probability\": 0.75,\n      \"Details_reasoning_with_fields\": \"This rule detects lateral movement by identifying unusual RDP patterns. The detection relies on `logon_type` being '10' (RemoteInteractive), and then applying logic based on `source_users` and `destination_computer` against an allow-list or by using `times` to count the frequency of distinct `destination_computer` logons by the same `source_users`.\"\n    },\n    {\n      \"detection_name\": \"Service Account Interactive Logon\",\n      \"mapped_ttp\": \"T1078 (Valid Accounts)\",\n      \"threat_scenario\": \"A service account has been compromised and is being used by an attacker for interactive access.\",\n      \"detection_logic\": \"Alert whenever an account known to be a service account (based on naming convention or group membership) generates a logon event with `logon_type` 2 (Interactive) or 10 (Remote Interactive).\",\n      \"detection_probability\": 0.95,\n      \"Details_reasoning_with_fields\": \"This is a high-fidelity alert as service accounts should never log on interactively. The detection requires identifying a `source_users` as a service account and checking if the `logon_type` is '2' or '10'. This is a very strong signal of compromise.\"\n    }\n  ],\n  \"indicators_of_compromise\": [\n    {\n      \"indicator_category\": \"Suspicious Source Hostnames\",\n      \"Instruction\": \"Hostnames that do not conform to internal naming conventions, are randomly generated, or are known to be associated with malicious tools. This can indicate an unauthorized device on the network.\",\n      \"relevant_fields\": [\n        \"source_computer:\"\n      ]\n    },\n    {\n      \"indicator_category\": \"Known Malicious Source IP Addresses\",\n      \"Instruction\": \"Authentication attempts originating from IP addresses listed on threat intelligence feeds as being malicious, command-and-control (C2) servers, or Tor exit nodes.\",\n      \"relevant_fields\": [\n        \"source_computer:\"\n      ]\n    },\n    {\n      \"indicator_category\": \"Use of Common Hacking/Admin Tool Names as Usernames/Hostnames\",\n      \"Instruction\": \"Usernames or hostnames that match the names of common penetration testing or administration tools (e.g., \\\"mimikatz\\\", \\\"psexec\\\", \\\"kali\\\").\",\n      \"relevant_fields\": [\n        \"source_computer:\",\n        \"source_users:\",\n        \"destination_users:\"\n      ]\n    }\n  ],\n  \"attack_pattern_checks\": [\n    {\n      \"attack_pattern_name\": \"Brute Force (T1110)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you find evidence matching the 'Potential Brute-Force or Password Spraying Attack' or 'Successful Logon Immediately Following Failed Attempts' detection rules. As proof, provide the source and target entities and the relevant timestamps.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Password Spraying (T1110.003)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you find evidence matching the 'Potential Brute-Force or Password Spraying Attack' detection rule, specifically the logic for one source attacking many destination users. As proof, provide the source computer and a list of targeted user accounts.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Pass the Hash (T1550.002)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you find evidence matching the 'Potential Pass-the-Hash (PtH) Activity' detection rule. As proof, provide the source computer, destination computer, user account, and the timestamp of the NTLM network logon.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Pass the Ticket (T1550.003)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe a Kerberos ticket being used from a source computer where the associated user has no recent interactive logon history, indicating the ticket was likely stolen and moved. As proof, list the source, destination, user, and time.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Kerberoasting (T1558.003)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe a 'Sudden Spike in Kerberos Ticket Requests' from a single host, especially for service accounts. As proof, provide the source host and the list of requested service principal names.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Remote Services: Remote Desktop Protocol (T1021.001)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you find evidence matching the 'Anomalous Remote Desktop (RDP) Logon' detection rule. As proof, describe the anomalous RDP activity, including the user and the multiple hosts they connected to.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"Valid Accounts (T1078)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if any of the following detection rules are matched: 'Successful Logon Immediately Following Failed Attempts', 'Anomalous Remote Desktop (RDP) Logon', or 'Service Account Interactive Logon'. As proof, provide the details from the triggered detection.\",\n      \"evidence\": []\n    },\n    {\n      \"attack_pattern_name\": \"OS Credential Dumping: LSASS Memory (T1003.001)\",\n      \"is_present\": false,\n      \"evidence_Instruction\": \"Set `is_present` to `true` if you observe a successful logon from a user to a new destination computer shortly after suspicious process activity (like accessing lsass.exe) on the source computer. This requires correlation with process logs. As proof, show the logon event and reference the preceding suspicious process event.\",\n      \"evidence\": []\n    }\n  ],\n  \"vulnerability_checks\": [\n    {\n      \"vulnerability_id\": \"CVE-2024-20674\",\n      \"is_present\": false,\n      \"evidence_instruction\": \"For CVE-2024-20674, set `is_present` to `true` if you observe successful Kerberos authentication events that are preceded by Kerberos errors or anomalies, potentially indicating a machine-in-the-middle attack. As proof, describe the sequence of anomalous Kerberos events and associated entities.\",\n      \"evidence\": []\n    },\n    {\n      \"vulnerability_id\": \"CVE-2022-26931\",\n      \"is_present\": false,\n      \"evidence_instruction\": \"For CVE-2022-26931, set `is_present` to `true` if you observe a user account suddenly gaining higher privileges during certificate-based authentication. This may manifest as a logon event where the user's token has unexpected group memberships. As proof, detail the user and the anomalous privilege seen in the logon event.\",\n      \"evidence\": []\n    },\n    {\n      \"vulnerability_id\": \"NTLM Relay Vulnerabilities\",\n      \"is_present\": false,\n      \"evidence_instruction\": \"Set `is_present` to `true` if you observe a successful NTLM authentication to a server from a source that is not the user's actual machine, especially if the authentication is for a privileged service like SMB or HTTP. This often requires correlation with network traffic. As proof, show the NTLM logon and any evidence of it originating from a suspicious relay point.\",\n      \"evidence\": []\n    }\n  ]\n}\n```",
          "model": "gemini-2.5-pro",
          "provider": "gemini",
          "report_source": "gemini"
        }
      },
      "confidence": 0.8,
      "processing_time": 202.61175107955933,
      "method_used": "multi_model_prompt3",
      "source_files": [
        "output_v3\\stage4_prompt3\\gemini_from_claude_report_prompt3.json",
        "output_v3\\stage4_prompt3\\gemini_from_openai_report_prompt3.json",
        "output_v3\\stage4_prompt3\\gemini_from_gemini_report_prompt3.json"
      ],
      "metadata": {
        "models_used": [
          "gemini_from_claude_report",
          "gemini_from_openai_report",
          "gemini_from_gemini_report"
        ],
        "input_reports_count": 3
      }
    },
    "stage5_optimized_consensus": {
      "stage_name": "stage5_optimized_consensus",
      "content": {
        "parsed_json": {
          "observations": {
            "behavioral_patterns": {
              "malicious": [
                {
                  "pattern_name": "Credential Stuffing Attack",
                  "Instruction": "Event ID 4625: Signals a failed logon attempt, which may indicate potential brute force attacks, password guessing attempts, or attempts to gain unauthorized access. Multiple failed authentication attempts from the same source using different usernames.",
                  "identifiable_fields": [
                    "source_computer: List",
                    "source_users: List",
                    "destination_users: List",
                    "statuses: List",
                    "times: List"
                  ]
                },
                {
                  "pattern_name": "Pass-the-Hash Attack",
                  "Instruction": "Pass-the-Hash is a lateral movement technique in which attackers steal a user's NTLM hash from one computer and use it to gain access to another computer. Look for successful NTLM authentication without corresponding Kerberos pre-authentication.",
                  "identifiable_fields": [
                    "auth_type: List",
                    "source_computer: List",
                    "destination_computer: List",
                    "source_users: List",
                    "destination_users: List"
                  ]
                },
                {
                  "pattern_name": "Pass-the-Ticket Attack",
                  "Instruction": "Pass-the-Ticket is a lateral movement technique where attackers steal a Kerberos ticket from one computer and reuse it to access another. A Kerberos ticket is seen used on two or more different computers.",
                  "identifiable_fields": [
                    "auth_type: List",
                    "source_computer: List",
                    "destination_computer: List",
                    "source_users: List"
                  ]
                },
                {
                  "pattern_name": "Golden Ticket Attack",
                  "Instruction": "This attack allows adversaries to forge a valid Ticket Granting Ticket (TGT) for any user by obtaining the NTLM hash of the 'krbtgt' domain account, enabling impersonation of any user, including high-privileged ones.",
                  "identifiable_fields": [
                    "auth_type: List",
                    "source_users: List",
                    "destination_computer: List"
                  ]
                },
                {
                  "pattern_name": "Overpass-the-Hash Attack",
                  "Instruction": "A post-exploitation technique where an attacker uses a captured NTLM hash to create a new authenticated session and obtain fresh Kerberos tickets, unlike traditional Pass-the-Hash.",
                  "identifiable_fields": [
                    "auth_type: List",
                    "source_computer: List",
                    "destination_computer: List",
                    "source_users: List"
                  ]
                }
              ],
              "anomalous": [
                {
                  "pattern_name": "Service Account Interactive Logon",
                  "Instruction": "Event Id 4624 with logon types (2, 10, 7) and an account name like 'svc_*' or other internal service accounts indicates a possible interactive logon from a service account, which should typically only perform service-type authentication.",
                  "identifiable_fields": [
                    "source_users: List",
                    "logon_type: List",
                    "orientations: List"
                  ]
                },
                {
                  "pattern_name": "Privileged Account Lateral Movement",
                  "Instruction": "High-privilege accounts (e.g., Domain Admins) authenticating to low-privilege systems like standard user workstations via RDP is highly suspicious.",
                  "identifiable_fields": [
                    "source_users: List",
                    "destination_computer: List",
                    "logon_type: List"
                  ]
                },
                {
                  "pattern_name": "First-Time Remote Access",
                  "Instruction": "A user who has never used remote access (`logon_type` 10 or 3) before suddenly does so successfully.",
                  "identifiable_fields": [
                    "source_users: List",
                    "logon_type: List",
                    "statuses: List"
                  ]
                },
                {
                  "pattern_name": "High-Frequency Successful Logons",
                  "Instruction": "A single user or service account authenticating successfully to hundreds of different machines in a very short period, indicative of automated scripts for discovery or deployment.",
                  "identifiable_fields": [
                    "source_users: List",
                    "destination_computer: List",
                    "times: List",
                    "statuses: List"
                  ]
                },
                {
                  "pattern_name": "Use of Multiple Accounts from One Host",
                  "Instruction": "A single workstation is used to successfully authenticate with numerous different user accounts (not service accounts) within a short window, potentially indicating a compromised host used for lateral movement.",
                  "identifiable_fields": [
                    "source_computer: List",
                    "source_users: List",
                    "times: List",
                    "statuses: List"
                  ]
                }
              ],
              "vulnerable": [
                {
                  "pattern_name": "NTLM Downgrade Attack",
                  "Instruction": "Related to CVE-2019-1040, a man-in-the-middle attack can bypass the NTLM Message Integrity Check (MIC), allowing an attacker to downgrade security features and create authenticated sessions on behalf of other users.",
                  "identifiable_fields": [
                    "auth_type: List",
                    "source_computer: List",
                    "destination_computer: List"
                  ]
                },
                {
                  "pattern_name": "Weak Authentication Protocol Usage",
                  "Instruction": "NTLM's simplistic password hashing makes it vulnerable to pass-the-hash and brute-force attacks. Its usage indicates outdated cryptography.",
                  "identifiable_fields": [
                    "auth_type: List",
                    "source_computer: List",
                    "destination_computer: List"
                  ]
                },
                {
                  "pattern_name": "Legacy Protocol Authentication",
                  "Instruction": "Environments still using NTLM are susceptible to Overpass-the-Hash attacks. Its persistence is a significant vulnerability.",
                  "identifiable_fields": [
                    "auth_type: List",
                    "source_computer: List",
                    "destination_computer: List"
                  ]
                },
                {
                  "pattern_name": "Pre-Authentication Disabled Accounts",
                  "Instruction": "If Kerberos pre-authentication is disabled for an account, an adversary can request a Ticket Granting Ticket (TGT) for that user without needing a password, a technique known as AS-REP roasting.",
                  "identifiable_fields": [
                    "auth_type: List",
                    "source_users: List",
                    "destination_computer: List"
                  ]
                },
                {
                  "pattern_name": "Machine Account Interactive Authentication",
                  "Instruction": "Event Id 4624 with logon types (10, 2) where the account name ends with a '$' (e.g., ItSupport$) can indicate a fake machine account being used for interactive logon.",
                  "identifiable_fields": [
                    "source_users: List",
                    "logon_type: List",
                    "orientations: List"
                  ]
                }
              ]
            },
            "temporal_patterns": {
              "malicious": [
                {
                  "pattern_name": "Suspicious Logoff Timings",
                  "Instruction": "Logoff events for admin accounts shortly after unauthorized logon.",
                  "identifiable_fields": [
                    "orientations: List",
                    "source_users: List",
                    "times: List"
                  ]
                },
                {
                  "pattern_name": "Stealthy Kerberos Renewal",
                  "Instruction": "Frequent renewals (4768) without apparent need, indicating persistence.",
                  "identifiable_fields": [
                    "destination_computer: List",
                    "times: List",
                    "auth_type: List"
                  ]
                }
              ],
              "anomalous": [
                {
                  "pattern_name": "Impossible Travel",
                  "Instruction": "This detection identifies two user authentications from geographically distant locations within a time period shorter than the travel time between them, indicating compromised credentials. This often uses a machine-learning algorithm to filter out false positives like VPNs.",
                  "identifiable_fields": [
                    "source_computer: List",
                    "destination_computer: List",
                    "source_users: List",
                    "times: List"
                  ]
                },
                {
                  "pattern_name": "Off-Hours Authentication",
                  "Instruction": "Attackers using harvested credentials may not adhere to the legitimate user's normal working hours. Look for authentication attempts outside of normal business hours for specific users.",
                  "identifiable_fields": [
                    "source_users: List",
                    "times: List",
                    "source_computer: List",
                    "destination_computer: List"
                  ]
                },
                {
                  "pattern_name": "Multiple Concurrent Sessions",
                  "Instruction": "Event Id 4624 showing more than one successful logon with logon type 3 or 10 from the same account name but different source network addresses indicates the same user account is authenticated from multiple locations simultaneously.",
                  "identifiable_fields": [
                    "source_users: List",
                    "source_computer: List",
                    "destination_computer: List",
                    "times: List"
                  ]
                },
                {
                  "pattern_name": "Suspicious Time-of-Day Logon",
                  "Instruction": "Successful logons outside business hours.",
                  "identifiable_fields": [
                    "times: List",
                    "statuses: List",
                    "source_users: List"
                  ]
                }
              ]
            }
          },
          "detection_rule_checklist": [
            {
              "detection_name": "Multiple Failed Authentication Attempts (Brute Force Detection)",
              "mapped_ttp": "T1110 (Brute Force)",
              "threat_scenario": "Credential stuffing or brute force attacks",
              "detection_logic": "Count `statuses` = \"Failure\" WHERE `source_computer` AND `times` within 5-minute window > 10",
              "detection_probability": "___",
              "Details_reasoning_with_fields": "To determine the probability, analyze the logs for clusters of failed authentications. The key fields are `statuses`, `source_computer`, and `times`. A high count of 'Failure' statuses from a single `source_computer` within a short `times` window (5 minutes) strongly indicates a brute-force or credential stuffing attack (T1110). Correlate with multiple `destination_users` being targeted from that source."
            },
            {
              "detection_name": "Pass-the-Hash Detection",
              "mapped_ttp": "T1550.002 (Pass the Hash)",
              "threat_scenario": "Credential theft and lateral movement using stolen password hashes",
              "detection_logic": "`auth_type` = \"NTLM\" AND `statuses` = \"Success\" AND no preceding Kerberos authentication",
              "detection_probability": "___",
              "Details_reasoning_with_fields": "The core of this detection is identifying successful (`statuses` = 'Success') NTLM (`auth_type` = 'NTLM') authentication. In a healthy Kerberos environment, this is anomalous. The absence of a preceding Kerberos ticket request for the same session is the key indicator of a Pass-the-Hash attempt (T1550.002). Correlate `source_users`, `source_computer`, and `destination_computer` to trace the lateral movement path."
            },
            {
              "detection_name": "Impossible Travel Detection",
              "mapped_ttp": "T1078 (Valid Accounts)",
              "threat_scenario": "Account compromise and concurrent usage by legitimate user and attacker",
              "detection_logic": "Same `source_users` with different `source_computer` locations within impossible travel time",
              "detection_probability": "___",
              "Details_reasoning_with_fields": "This relies on geolocating the `source_computer` IP address for a successful logon by a specific `source_users`. If two successful logons for the same user occur from geographically distant locations within an impossible `times` window, it signals a compromised valid account (T1078). This requires enriching the log data with geolocation information."
            },
            {
              "detection_name": "Privileged Account Anomaly",
              "mapped_ttp": "T1078.002 (Domain Accounts)",
              "threat_scenario": "Privilege escalation and lateral movement using compromised admin accounts",
              "detection_logic": "`source_users` IN privileged_accounts AND `logon_type` = \"Interactive\" AND `destination_computer` IN workstations",
              "detection_probability": "___",
              "Details_reasoning_with_fields": "Identify if a `source_users` belonging to a privileged group (e.g., Domain Admins) performs an interactive logon (`logon_type` = 'Interactive' or 'RemoteInteractive') to a standard `destination_computer` (a workstation, not a server). This is a strong indicator of lateral movement using a compromised privileged account (T1078.002)."
            },
            {
              "detection_name": "Service Account Interactive Authentication",
              "mapped_ttp": "T1078.003 (Local Accounts)",
              "threat_scenario": "Service account compromise and misuse for interactive access",
              "detection_logic": "`source_users` LIKE \"svc_*\" AND `logon_type` IN [\"Interactive\", \"RemoteInteractive\"]",
              "detection_probability": "___",
              "Details_reasoning_with_fields": "Service accounts should not be used for interactive logons. Find events where the `source_users` matches a service account naming convention (e.g., starts with 'svc_') and the `logon_type` is 'Interactive' or 'RemoteInteractive'. This suggests the account has been compromised and is being used for hands-on access (T1078.003)."
            },
            {
              "detection_name": "Off-Hours Authentication Anomaly",
              "mapped_ttp": "T1078 (Valid Accounts)",
              "threat_scenario": "After-hours unauthorized access or compromised credentials",
              "detection_logic": "`source_users` authentication during non-business hours based on user baseline",
              "detection_probability": "___",
              "Details_reasoning_with_fields": "This requires establishing a baseline of normal logon hours for each `source_users`. An alert should be triggered if the `times` of a successful authentication falls outside this established baseline. This is a general indicator of a compromised valid account (T1078)."
            },
            {
              "detection_name": "Golden/Silver Ticket Detection",
              "mapped_ttp": "T1558.001 (Golden Ticket), T1558.002 (Silver Ticket)",
              "threat_scenario": "Forged Kerberos tickets for persistence and privilege escalation",
              "detection_logic": "`auth_type` = \"Kerberos\" AND encryption_type = \"RC4-HMAC\" AND unusual ticket properties",
              "detection_probability": "___",
              "Details_reasoning_with_fields": "This is an advanced detection. Look for Kerberos (`auth_type` = 'Kerberos') authentication events where weak or legacy encryption like RC4-HMAC is used, especially for TGT requests. This is a strong indicator of a Golden Ticket (T1558.001) or Overpass-the-Hash attack. The presence of a ticket for a user who does not exist or has unusual properties also points to this."
            },
            {
              "detection_name": "NTLM Relay Attack Detection",
              "mapped_ttp": "T1557.001 (LLMNR/NBT-NS Poisoning)",
              "threat_scenario": "Network-based attacks leveraging NTLM authentication weaknesses",
              "detection_logic": "`auth_type` = \"NTLM\" AND rapid authentication to multiple `destination_computer` from same `source_computer`",
              "detection_probability": "___",
              "Details_reasoning_with_fields": "An NTLM relay attack involves an attacker's machine (`source_computer`) rapidly relaying NTLM (`auth_type` = 'NTLM') authentication requests from a victim to multiple `destination_computer` systems. Look for a single `source_computer` making many NTLM authentication attempts to different destinations in a very short `times` window. This points to poisoning attacks like T1557.001."
            },
            {
              "detection_name": "High-Volume Failed Logons (Brute-Force/Spray)",
              "mapped_ttp": "T1110 (Brute Force)",
              "threat_scenario": "An attacker is attempting to guess user credentials.",
              "detection_logic": "ALERT if count(statuses = 'Failure') > 20 within 5 minutes for the same source_computer OR ALERT if count(statuses = 'Failure') > 20 within 5 minutes for the same destination_users.",
              "detection_probability": "___",
              "Details_reasoning_with_fields": "What is the probability this attack is detected? Provide the exact fields list and how they are related to the detection. Find information from the report."
            },
            {
              "detection_name": "Potential Pass-the-Hash (PtH) Attempt",
              "mapped_ttp": "T1550.002 (Use Alternate Authentication Material: Pass the Hash)",
              "threat_scenario": "An attacker is using a stolen NTLM hash for lateral movement.",
              "detection_logic": "ALERT on (logon_type = '3' AND auth_type = 'NTLM' AND statuses = 'Success') where source_users is a privileged account (e.g., Domain Admin) AND destination_computer is a workstation.",
              "detection_probability": "___",
              "Details_reasoning_with_fields": "What is the probability this attack is detected? Provide the exact fields list and how they are related to the detection. Find information from the report."
            },
            {
              "detection_name": "Remote Interactive Logon from Non-Admin Host",
              "mapped_ttp": "T1021.001 (Remote Services: Remote Desktop Protocol)",
              "threat_scenario": "An attacker is using RDP for lateral movement from a compromised workstation.",
              "detection_logic": "ALERT on (logon_type = '10' AND statuses = 'Success') where destination_computer is a server OR domain controller AND source_computer is NOT in the list of approved administrative hosts.",
              "detection_probability": "___",
              "Details_reasoning_with_fields": "What is the probability this attack is detected? Provide the exact fields list and how they are related to the detection. Find information from the report."
            },
            {
              "detection_name": "Potential Kerberoasting",
              "mapped_ttp": "T1558.003 (Steal or Forge Kerberos Tickets: Kerberoasting)",
              "threat_scenario": "An attacker is attempting to steal the credential hash of a service account.",
              "detection_logic": "ALERT on (auth_type = 'Kerberos' AND statuses = 'Success') where destination_users has a Service Principal Name (ends in '$') AND source_users is NOT a known administrative or service account.",
              "detection_probability": "___",
              "Details_reasoning_with_fields": "What is the probability this attack is detected? Provide the exact fields list and how they are related to the detection. Find information from the report."
            },
            {
              "detection_name": "Brute Force Network Logons",
              "mapped_ttp": "T1110 (Brute Force)",
              "threat_scenario": "Trigger when `statuses`=Failure AND `logon_type`=Network for the same `destination_users` exceeds threshold X within Y minutes.",
              "detection_logic": "Trigger when `statuses`=Failure AND `logon_type`=Network for the same `destination_users` exceeds threshold X within Y minutes.",
              "detection_probability": 0.0,
              "Details reasoning witb fields like previous points": "To determine the probability, analyze the logs for a high count of events where the 'statuses' field is 'Failure', the 'logon_type' is 'Network', and the 'destination_users' field is consistent across these events within a short time window defined by the 'times' field. A high frequency of this combination indicates a likely brute-force attack."
            },
            {
              "detection_name": "Pass-the-Hash via NTLM",
              "mapped_ttp": "T1550.002",
              "threat_scenario": "Alert on 4624 events where `auth_type` includes NTLM AND no prior 4768 Kerberos TGT for that `source_users`.",
              "detection_logic": "Alert on 4624 events where `auth_type` includes NTLM AND no prior 4768 Kerberos TGT for that `source_users`.",
              "detection_probability": 0.0,
              "Details reasoning witb fields like previous points": "To determine the probability, look for successful logon events (Event ID 4624) where the 'auth_type' is 'NTLM'. Then, verify that for the specific 'source_users' in that event, there was no preceding Kerberos Ticket Granting Ticket request (Event ID 4768) within a recent timeframe ('times'). The presence of a successful NTLM logon without a Kerberos ticket request is a strong indicator of Pass-the-Hash."
            },
            {
              "detection_name": "Kerberoasting SPN Requests",
              "mapped_ttp": "T1558.003",
              "threat_scenario": "Spike in 4769 requests for non-standard SPNs by same `source_users`.",
              "detection_logic": "Spike in 4769 requests for non-standard SPNs by same `source_users`.",
              "detection_probability": 0.0,
              "Details reasoning witb fields like previous points": "To determine the probability, monitor for a statistical anomaly (a spike) in the volume of Kerberos service ticket requests (Event ID 4769). The key fields to correlate are 'source_users' (the requester) and 'destination_users' (the Service Principal Name, or SPN). A single source user requesting an unusually high number of tickets for various service accounts in a short time ('times') is the primary indicator."
            },
            {
              "detection_name": "Token Impersonation Sequence",
              "mapped_ttp": "T1134.001",
              "threat_scenario": "Sequential logon events for two distinct accounts on same host within short time.",
              "detection_logic": "Sequential logon events for two distinct accounts on same host within short time.",
              "detection_probability": 0.0,
              "Details reasoning witb fields like previous points": "To determine the probability, search for a sequence of logon events (Event ID 4624) occurring within a very short time window ('times'). The pattern to match is two events on the same 'source_computer' but with different 'source_users', especially if one is a service account and the next is a privileged user account. This sequence suggests one session is spawning another with different credentials."
            },
            {
              "detection_name": "NTLM Coercion Detection",
              "mapped_ttp": "T1187",
              "threat_scenario": "Outbound SMB negotiation attempts (`auth_type`=NTLM) to external IPs.",
              "detection_logic": "Outbound SMB negotiation attempts (`auth_type`=NTLM) to external IPs.",
              "detection_probability": 0.0,
              "Details reasoning witb fields like previous points": "To determine the probability, filter for authentication events where the 'auth_type' is 'NTLM' and the 'destination_computer' is an external or non-domain IP address. This requires correlating authentication logs with network flow data or firewall logs to identify the external nature of the destination. Such outbound NTLM traffic is highly suspicious and indicative of a coercion attempt."
            }
          ],
          "entity_analysis_instructions": {
            "source_profiling_queries": [
              {
                "query_name": "Identify Malicious Source Actors",
                "instruction": "From the raw logs, extract and list all `source_computer` and `source_users` that are directly involved in the following patterns: 'Credential Stuffing Attack', 'Pass-the-Hash Attack', 'Pass-the-Ticket Attack', 'Golden Ticket Attack', 'Overpass-the-Hash Attack', 'Impossible Travel', 'Off-Hours Authentication', 'Privileged Account Lateral Movement'."
              }
            ],
            "target_profiling_queries": [
              {
                "query_name": "Identify High-Value or Frequently Targeted Systems",
                "instruction": "From the raw logs, extract and list all `destination_computer` and `destination_users` that are involved in patterns like 'Privileged Account Lateral Movement', 'Golden Ticket Attack', 'Pass-the-Hash Attack', or that appear as a target in more than 10 events matching any malicious or anomalous patterns."
              }
            ]
          },
          "fields": {
            "source_computer": {
              "type": "string",
              "description": "The name or identifier of the computer where the authentication attempt originated.",
              "OCSF": "source.device.hostname",
              "ECS": "source.domain",
              "OSSEM": "source.host.name",
              "importance": 8
            },
            "destination_computer": {
              "type": "string",
              "description": "The name or identifier of the computer that was the target of the authentication attempt.",
              "OCSF": "dst_endpoint.hostname",
              "ECS": "destination.domain",
              "OSSEM": "destination.host.name",
              "importance": 8
            },
            "auth_type": {
              "type": "string",
              "description": "The authentication protocol used for the logon, such as Kerberos or NTLM.",
              "OCSF": "auth.auth_protocol",
              "ECS": "event.authentication_method",
              "OSSEM": "authentication.package_name",
              "importance": 7
            },
            "logon_type": {
              "type": "string",
              "description": "The type of logon that occurred, such as Network or Interactive.",
              "OCSF": "logon_type",
              "ECS": "winlog.logon.type",
              "OSSEM": "logon.logon_type",
              "importance": 7
            },
            "times": {
              "type": "array",
              "description": "A list of timestamps associated with the event. The raw log sample indicates multiple timestamps can be present for a single event.",
              "OCSF": "time",
              "ECS": "@timestamp",
              "OSSEM": "event.time",
              "importance": 9
            },
            "source_users": {
              "type": "array",
              "description": "The user account that initiated the logon request.",
              "OCSF": "src.user.name",
              "ECS": "source.user.name",
              "OSSEM": "source.user.name",
              "importance": 9
            },
            "destination_users": {
              "type": "array",
              "description": "The user account for which the new logon was created.",
              "OCSF": "user.name",
              "ECS": "destination.user.name",
              "OSSEM": "object.user.name",
              "importance": 9
            },
            "orientations": {
              "type": "string",
              "description": "The orientation of the event, indicating if it was a logon or logoff.",
              "OCSF": "activity_name",
              "ECS": "event.action",
              "OSSEM": "action",
              "importance": 8
            },
            "statuses": {
              "type": "string",
              "description": "The status of the authentication attempt, such as Success or Failure.",
              "OCSF": "status",
              "ECS": "event.outcome",
              "OSSEM": "status",
              "importance": 8
            }
          },
          "log_type": "Windows Security Authentication Log",
          "indicators_of_compromise": [
            {
              "indicator_category": "Authentication Failure Patterns",
              "Instruction": "More than '10' EventID 4625 with different 'Account Name' and Sub status 0xc0000064 (user name does not exist) from a source network address that is not null, indicates possible account discovery (password spraying).",
              "relevant_fields": [
                "statuses:",
                "source_users:",
                "source_computer:"
              ]
            },
            {
              "indicator_category": "Suspicious Network Logons",
              "Instruction": "Event ID 4624 with logon type 10 (Remote Interactive) from a source network that is not within your organization's subnets.",
              "relevant_fields": [
                "logon_type:",
                "source_computer:"
              ]
            },
            {
              "indicator_category": "RDP Tunneling Indicators",
              "Instruction": "Event ID 4624 with Logon type 10 (RemoteInteractive) where the source network address is a loopback address (127.x.x.x or ::1), often indicates RDP tunneling.",
              "relevant_fields": [
                "logon_type:",
                "source_computer:"
              ]
            },
            {
              "indicator_category": "Lateral Movement Between Endpoints",
              "Instruction": "Event ID 4624 with logon type 3 or 10 where both the source workstation name and destination are end-user machines (not servers).",
              "relevant_fields": [
                "logon_type:",
                "source_computer:",
                "destination_computer:"
              ]
            },
            {
              "indicator_category": "Kerberos Attack Indicators",
              "Instruction": "A Kerberos authentication ticket (TGT) was requested with encryption type 0x17 (RC4-HMAC). This legacy encryption type can be evidence of an OverPass The Hash attack.",
              "relevant_fields": [
                "auth_type:"
              ]
            },
            {
              "indicator_category": "Anomalous Source Hostname/IP",
              "Instruction": "A `source_computer` that is not part of the known corporate network or is on a blacklist attempting authentication.",
              "relevant_fields": [
                "source_computer:"
              ]
            },
            {
              "indicator_category": "Unauthorized Account Usage",
              "Instruction": "The `source_users` or `destination_users` field shows activity from a disabled, dormant, or unauthorized account.",
              "relevant_fields": [
                "source_users:",
                "destination_users:"
              ]
            },
            {
              "indicator_category": "Suspicious Authentication Patterns",
              "Instruction": "A high ratio of failed to successful logons (`statuses`) from a single `source_computer`.",
              "relevant_fields": [
                "statuses:",
                "source_computer:"
              ]
            },
            {
              "indicator_category": "Anomalous Logon Types",
              "Instruction": "A `logon_type` that is inconsistent with the user's role, such as a service account performing an interactive logon.",
              "relevant_fields": [
                "logon_type:"
              ]
            },
            {
              "indicator_category": "Use of Weak/Legacy Protocols",
              "Instruction": "The `auth_type` field indicates widespread use of NTLMv1 or other insecure protocols.",
              "relevant_fields": [
                "auth_type:"
              ]
            },
            {
              "indicator_category": "Known Malicious Tool Signatures",
              "Instruction": "While not in the log itself, the *behavior* generated by tools like Mimikatz (e.g., specific logon patterns) can be an indicator.",
              "relevant_fields": []
            },
            {
              "indicator_category": "Anomalous User Account Names",
              "Instruction": "Accounts observed in anomalous logons (e.g., service$, admin).",
              "relevant_fields": [
                "source_users:",
                "destination_users:"
              ]
            },
            {
              "indicator_category": "Anomalous Hostnames/IP Addresses",
              "Instruction": "`source_computer`, `destination_computer` involved in lateral movement or NTLM relay.",
              "relevant_fields": [
                "source_computer:",
                "destination_computer:"
              ]
            },
            {
              "indicator_category": "Anomalous Authentication Protocols",
              "Instruction": "Spikes in NTLM vs. Kerberos usage.",
              "relevant_fields": [
                "auth_type:"
              ]
            },
            {
              "indicator_category": "Anomalous Event IDs",
              "Instruction": "4624, 4625, 4648, 4672, 4697, 4768, 4769 anomalies.",
              "relevant_fields": []
            }
          ],
          "attack_pattern_checks": [
            {
              "attack_pattern_name": "T1187 (Forced Authentication)",
              "is_present": false,
              "evidence_Instruction": "Set `is_present` to `true` if you observe unusual SMB authentication patterns in the `auth_type` field, especially if correlated with tools known to coerce authentication. As proof, provide the source and target entities and the relevant timestamps.",
              "evidence": []
            },
            {
              "attack_pattern_name": "T1556 (Modify Authentication Process)",
              "is_present": false,
              "evidence_Instruction": "Set `is_present` to `true` if you observe anomalous `auth_type` values or unusual authentication flows not matching standard Kerberos or NTLM procedures. As proof, provide the source and target entities and the relevant timestamps.",
              "evidence": []
            },
            {
              "attack_pattern_name": "T1003 (OS Credential Dumping)",
              "is_present": false,
              "evidence_Instruction": "Set `is_present` to `true` if authentication events are correlated with subsequent suspicious process execution logs on the source computer, such as the execution of Mimikatz. As proof, provide the source and target entities and the relevant timestamps.",
              "evidence": []
            },
            {
              "attack_pattern_name": "T1550.002 (Pass the Hash)",
              "is_present": false,
              "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Pass-the-Hash Detection' rule. As proof, provide the source and target entities, and the relevant timestamps.",
              "evidence": []
            },
            {
              "attack_pattern_name": "T1550.003 (Pass the Ticket)",
              "is_present": false,
              "evidence_Instruction": "Set `is_present` to `true` if you observe a Kerberos ticket being used from multiple source computers for the same user. As proof, provide the source user and the multiple source computers and timestamps.",
              "evidence": []
            },
            {
              "attack_pattern_name": "T1558.001 (Golden Ticket)",
              "is_present": false,
              "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Golden/Silver Ticket Detection' rule, especially involving high-privilege accounts. As proof, detail the unusual ticket properties, source, and target.",
              "evidence": []
            },
            {
              "attack_pattern_name": "T1558.002 (Silver Ticket)",
              "is_present": false,
              "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Golden/Silver Ticket Detection' rule, often related to a specific service. As proof, detail the unusual ticket properties, source, target, and service.",
              "evidence": []
            },
            {
              "attack_pattern_name": "T1110 (Brute Force)",
              "is_present": false,
              "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Multiple Failed Authentication Attempts' rule. As proof, provide the source computer, the list of targeted users, and the time window of the attack.",
              "evidence": []
            },
            {
              "attack_pattern_name": "T1078 (Valid Accounts)",
              "is_present": false,
              "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching 'Impossible Travel', 'Off-Hours Authentication', or 'Privileged Account Anomaly' rules. As proof, provide the user account, source/destination, and timestamps that constitute the anomaly.",
              "evidence": []
            },
            {
              "attack_pattern_name": "T1557.001 (LLMNR/NBT-NS Poisoning)",
              "is_present": false,
              "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'NTLM Relay Attack Detection' rule. As proof, provide the source relaying computer and the multiple destinations it authenticated to.",
              "evidence": []
            }
          ]
        },
        "_field_property_stats": {
          "total_fields": 9,
          "properties_per_field": {
            "source_computer": [
              "type",
              "description",
              "OCSF",
              "ECS",
              "OSSEM",
              "importance"
            ],
            "destination_computer": [
              "type",
              "description",
              "OCSF",
              "ECS",
              "OSSEM",
              "importance"
            ],
            "auth_type": [
              "type",
              "description",
              "OCSF",
              "ECS",
              "OSSEM",
              "importance"
            ],
            "logon_type": [
              "type",
              "description",
              "OCSF",
              "ECS",
              "OSSEM",
              "importance"
            ],
            "times": [
              "type",
              "description",
              "OCSF",
              "ECS",
              "OSSEM",
              "importance"
            ],
            "source_users": [
              "type",
              "description",
              "OCSF",
              "ECS",
              "OSSEM",
              "importance"
            ],
            "destination_users": [
              "type",
              "description",
              "OCSF",
              "ECS",
              "OSSEM",
              "importance"
            ],
            "orientations": [
              "type",
              "description",
              "OCSF",
              "ECS",
              "OSSEM",
              "importance"
            ],
            "statuses": [
              "type",
              "description",
              "OCSF",
              "ECS",
              "OSSEM",
              "importance"
            ]
          },
          "semantic_selection_applied": true
        },
        "_consensus_metadata": {
          "generation_timestamp": 1753887999.9488337,
          "consensus_parts_count": 23,
          "filtered_parts_count": 20,
          "contributing_sources": [
            "gemini_from_gemini_report_prompt3",
            "gemini_from_openai_report_prompt3",
            "gemini_from_claude_report_prompt3"
          ],
          "average_confidence": 0.49563934741096105,
          "processing_config": {
            "consensus_strength": "comprehensive",
            "use_sbert_embeddings": true,
            "use_semantic_clustering": true,
            "use_semantic_ted": true,
            "use_bft_consensus": true,
            "use_weighted_voting": true,
            "use_mcts_optimization": false,
            "bft_agreement_threshold": 0.67,
            "similarity_threshold": 0.75,
            "consensus_threshold": 0.6,
            "enable_research_mode": true,
            "preservation_ratio": 0.8,
            "min_confidence_threshold": 0.0,
            "min_part_size": 1,
            "clustering_method": "distance_based",
            "strictness_level": "moderate",
            "security_focus": true,
            "content_complexity_preference": "balanced"
          },
          "hyperparameter_summary": {
            "preservation_ratio": 0.8,
            "strictness_level": "moderate",
            "security_focus": true,
            "content_complexity_preference": "balanced"
          }
        },
        "_provenance": {
          "part_contributions": {
            "parsed_json.observations.behavioral_patterns": {
              "contributing_sources": [
                "gemini_from_gemini_report_prompt3",
                "gemini_from_openai_report_prompt3",
                "gemini_from_claude_report_prompt3"
              ],
              "confidence": 0.4424058921923495,
              "is_merged": false,
              "hyperparameter_filtered": true
            },
            "parsed_json.observations.temporal_patterns.malicious.pattern_name": {
              "contributing_sources": [
                "gemini_from_openai_report_prompt3",
                "gemini_from_claude_report_prompt3"
              ],
              "confidence": 0.5,
              "is_merged": false,
              "hyperparameter_filtered": true
            },
            "parsed_json.observations.temporal_patterns.malicious.Instruction": {
              "contributing_sources": [
                "gemini_from_openai_report_prompt3",
                "gemini_from_claude_report_prompt3"
              ],
              "confidence": 0.5,
              "is_merged": false,
              "hyperparameter_filtered": true
            },
            "parsed_json.observations.temporal_patterns.vulnerable.pattern_name": {
              "contributing_sources": [
                "gemini_from_openai_report_prompt3",
                "gemini_from_claude_report_prompt3"
              ],
              "confidence": 0.5,
              "is_merged": false,
              "hyperparameter_filtered": true
            },
            "parsed_json.observations.temporal_patterns.vulnerable.Instruction": {
              "contributing_sources": [
                "gemini_from_openai_report_prompt3",
                "gemini_from_claude_report_prompt3"
              ],
              "confidence": 0.5,
              "is_merged": false,
              "hyperparameter_filtered": true
            },
            "parsed_json.detection_rule_checklist.detection_probability": {
              "contributing_sources": [
                "gemini_from_gemini_report_prompt3",
                "gemini_from_claude_report_prompt3"
              ],
              "confidence": 0.5,
              "is_merged": false,
              "hyperparameter_filtered": true
            },
            "part_18": {
              "contributing_sources": [
                "gemini_from_gemini_report_prompt3",
                "gemini_from_openai_report_prompt3",
                "gemini_from_claude_report_prompt3"
              ],
              "confidence": 0.5240867961811209,
              "is_merged": true,
              "hyperparameter_filtered": false
            },
            "parsed_json.entity_analysis_instructions.source_profiling_queries.query_name": {
              "contributing_sources": [
                "gemini_from_claude_report_prompt3"
              ],
              "confidence": 0.5,
              "is_merged": false,
              "hyperparameter_filtered": false
            }
          }
        }
      },
      "confidence": 0.4835310052939339,
      "processing_time": 15.979875087738037,
      "method_used": "OPTIMIZED_CONSENSUS_V2",
      "source_files": [
        "output_v3\\stage5_optimized_consensus\\final_unified_schema.json"
      ],
      "metadata": {
        "quality_metrics": {
          "overall_quality": 0.4835310052939339,
          "coverage": 0.03993055555555555,
          "consensus_success_rate": 0.8695652173913043,
          "average_consensus_confidence": 0.4962081281834444,
          "data_preservation": 0.3927464279887187,
          "source_diversity": 1.0,
          "structural_integrity": 0.0
        },
        "architectural_fixes_applied": true,
        "knowledge_preservation_approach": "consensus_filtered",
        "original_file_count": 3,
        "processing_method": "OPTIMIZED_CONSENSUS_V2",
        "bft_enabled": true,
        "muse_enabled": false,
        "ice_enabled": false,
        "ted_enabled": true,
        "clustering_enabled": true,
        "dempster_shafer_enabled": false,
        "clustering_method": "distance_based",
        "centralized_embeddings_enabled": false
      }
    }
  },
  "final_unified_schema": {
    "parsed_json": {
      "observations": {
        "behavioral_patterns": {
          "malicious": [
            {
              "pattern_name": "Credential Stuffing Attack",
              "Instruction": "Event ID 4625: Signals a failed logon attempt, which may indicate potential brute force attacks, password guessing attempts, or attempts to gain unauthorized access. Multiple failed authentication attempts from the same source using different usernames.",
              "identifiable_fields": [
                "source_computer: List",
                "source_users: List",
                "destination_users: List",
                "statuses: List",
                "times: List"
              ]
            },
            {
              "pattern_name": "Pass-the-Hash Attack",
              "Instruction": "Pass-the-Hash is a lateral movement technique in which attackers steal a user's NTLM hash from one computer and use it to gain access to another computer. Look for successful NTLM authentication without corresponding Kerberos pre-authentication.",
              "identifiable_fields": [
                "auth_type: List",
                "source_computer: List",
                "destination_computer: List",
                "source_users: List",
                "destination_users: List"
              ]
            },
            {
              "pattern_name": "Pass-the-Ticket Attack",
              "Instruction": "Pass-the-Ticket is a lateral movement technique where attackers steal a Kerberos ticket from one computer and reuse it to access another. A Kerberos ticket is seen used on two or more different computers.",
              "identifiable_fields": [
                "auth_type: List",
                "source_computer: List",
                "destination_computer: List",
                "source_users: List"
              ]
            },
            {
              "pattern_name": "Golden Ticket Attack",
              "Instruction": "This attack allows adversaries to forge a valid Ticket Granting Ticket (TGT) for any user by obtaining the NTLM hash of the 'krbtgt' domain account, enabling impersonation of any user, including high-privileged ones.",
              "identifiable_fields": [
                "auth_type: List",
                "source_users: List",
                "destination_computer: List"
              ]
            },
            {
              "pattern_name": "Overpass-the-Hash Attack",
              "Instruction": "A post-exploitation technique where an attacker uses a captured NTLM hash to create a new authenticated session and obtain fresh Kerberos tickets, unlike traditional Pass-the-Hash.",
              "identifiable_fields": [
                "auth_type: List",
                "source_computer: List",
                "destination_computer: List",
                "source_users: List"
              ]
            }
          ],
          "anomalous": [
            {
              "pattern_name": "Service Account Interactive Logon",
              "Instruction": "Event Id 4624 with logon types (2, 10, 7) and an account name like 'svc_*' or other internal service accounts indicates a possible interactive logon from a service account, which should typically only perform service-type authentication.",
              "identifiable_fields": [
                "source_users: List",
                "logon_type: List",
                "orientations: List"
              ]
            },
            {
              "pattern_name": "Privileged Account Lateral Movement",
              "Instruction": "High-privilege accounts (e.g., Domain Admins) authenticating to low-privilege systems like standard user workstations via RDP is highly suspicious.",
              "identifiable_fields": [
                "source_users: List",
                "destination_computer: List",
                "logon_type: List"
              ]
            },
            {
              "pattern_name": "First-Time Remote Access",
              "Instruction": "A user who has never used remote access (`logon_type` 10 or 3) before suddenly does so successfully.",
              "identifiable_fields": [
                "source_users: List",
                "logon_type: List",
                "statuses: List"
              ]
            },
            {
              "pattern_name": "High-Frequency Successful Logons",
              "Instruction": "A single user or service account authenticating successfully to hundreds of different machines in a very short period, indicative of automated scripts for discovery or deployment.",
              "identifiable_fields": [
                "source_users: List",
                "destination_computer: List",
                "times: List",
                "statuses: List"
              ]
            },
            {
              "pattern_name": "Use of Multiple Accounts from One Host",
              "Instruction": "A single workstation is used to successfully authenticate with numerous different user accounts (not service accounts) within a short window, potentially indicating a compromised host used for lateral movement.",
              "identifiable_fields": [
                "source_computer: List",
                "source_users: List",
                "times: List",
                "statuses: List"
              ]
            }
          ],
          "vulnerable": [
            {
              "pattern_name": "NTLM Downgrade Attack",
              "Instruction": "Related to CVE-2019-1040, a man-in-the-middle attack can bypass the NTLM Message Integrity Check (MIC), allowing an attacker to downgrade security features and create authenticated sessions on behalf of other users.",
              "identifiable_fields": [
                "auth_type: List",
                "source_computer: List",
                "destination_computer: List"
              ]
            },
            {
              "pattern_name": "Weak Authentication Protocol Usage",
              "Instruction": "NTLM's simplistic password hashing makes it vulnerable to pass-the-hash and brute-force attacks. Its usage indicates outdated cryptography.",
              "identifiable_fields": [
                "auth_type: List",
                "source_computer: List",
                "destination_computer: List"
              ]
            },
            {
              "pattern_name": "Legacy Protocol Authentication",
              "Instruction": "Environments still using NTLM are susceptible to Overpass-the-Hash attacks. Its persistence is a significant vulnerability.",
              "identifiable_fields": [
                "auth_type: List",
                "source_computer: List",
                "destination_computer: List"
              ]
            },
            {
              "pattern_name": "Pre-Authentication Disabled Accounts",
              "Instruction": "If Kerberos pre-authentication is disabled for an account, an adversary can request a Ticket Granting Ticket (TGT) for that user without needing a password, a technique known as AS-REP roasting.",
              "identifiable_fields": [
                "auth_type: List",
                "source_users: List",
                "destination_computer: List"
              ]
            },
            {
              "pattern_name": "Machine Account Interactive Authentication",
              "Instruction": "Event Id 4624 with logon types (10, 2) where the account name ends with a '$' (e.g., ItSupport$) can indicate a fake machine account being used for interactive logon.",
              "identifiable_fields": [
                "source_users: List",
                "logon_type: List",
                "orientations: List"
              ]
            }
          ]
        },
        "temporal_patterns": {
          "malicious": [
            {
              "pattern_name": "Suspicious Logoff Timings",
              "Instruction": "Logoff events for admin accounts shortly after unauthorized logon.",
              "identifiable_fields": [
                "orientations: List",
                "source_users: List",
                "times: List"
              ]
            },
            {
              "pattern_name": "Stealthy Kerberos Renewal",
              "Instruction": "Frequent renewals (4768) without apparent need, indicating persistence.",
              "identifiable_fields": [
                "destination_computer: List",
                "times: List",
                "auth_type: List"
              ]
            }
          ],
          "anomalous": [
            {
              "pattern_name": "Impossible Travel",
              "Instruction": "This detection identifies two user authentications from geographically distant locations within a time period shorter than the travel time between them, indicating compromised credentials. This often uses a machine-learning algorithm to filter out false positives like VPNs.",
              "identifiable_fields": [
                "source_computer: List",
                "destination_computer: List",
                "source_users: List",
                "times: List"
              ]
            },
            {
              "pattern_name": "Off-Hours Authentication",
              "Instruction": "Attackers using harvested credentials may not adhere to the legitimate user's normal working hours. Look for authentication attempts outside of normal business hours for specific users.",
              "identifiable_fields": [
                "source_users: List",
                "times: List",
                "source_computer: List",
                "destination_computer: List"
              ]
            },
            {
              "pattern_name": "Multiple Concurrent Sessions",
              "Instruction": "Event Id 4624 showing more than one successful logon with logon type 3 or 10 from the same account name but different source network addresses indicates the same user account is authenticated from multiple locations simultaneously.",
              "identifiable_fields": [
                "source_users: List",
                "source_computer: List",
                "destination_computer: List",
                "times: List"
              ]
            },
            {
              "pattern_name": "Suspicious Time-of-Day Logon",
              "Instruction": "Successful logons outside business hours.",
              "identifiable_fields": [
                "times: List",
                "statuses: List",
                "source_users: List"
              ]
            }
          ]
        }
      },
      "detection_rule_checklist": [
        {
          "detection_name": "Multiple Failed Authentication Attempts (Brute Force Detection)",
          "mapped_ttp": "T1110 (Brute Force)",
          "threat_scenario": "Credential stuffing or brute force attacks",
          "detection_logic": "Count `statuses` = \"Failure\" WHERE `source_computer` AND `times` within 5-minute window > 10",
          "detection_probability": "___",
          "Details_reasoning_with_fields": "To determine the probability, analyze the logs for clusters of failed authentications. The key fields are `statuses`, `source_computer`, and `times`. A high count of 'Failure' statuses from a single `source_computer` within a short `times` window (5 minutes) strongly indicates a brute-force or credential stuffing attack (T1110). Correlate with multiple `destination_users` being targeted from that source."
        },
        {
          "detection_name": "Pass-the-Hash Detection",
          "mapped_ttp": "T1550.002 (Pass the Hash)",
          "threat_scenario": "Credential theft and lateral movement using stolen password hashes",
          "detection_logic": "`auth_type` = \"NTLM\" AND `statuses` = \"Success\" AND no preceding Kerberos authentication",
          "detection_probability": "___",
          "Details_reasoning_with_fields": "The core of this detection is identifying successful (`statuses` = 'Success') NTLM (`auth_type` = 'NTLM') authentication. In a healthy Kerberos environment, this is anomalous. The absence of a preceding Kerberos ticket request for the same session is the key indicator of a Pass-the-Hash attempt (T1550.002). Correlate `source_users`, `source_computer`, and `destination_computer` to trace the lateral movement path."
        },
        {
          "detection_name": "Impossible Travel Detection",
          "mapped_ttp": "T1078 (Valid Accounts)",
          "threat_scenario": "Account compromise and concurrent usage by legitimate user and attacker",
          "detection_logic": "Same `source_users` with different `source_computer` locations within impossible travel time",
          "detection_probability": "___",
          "Details_reasoning_with_fields": "This relies on geolocating the `source_computer` IP address for a successful logon by a specific `source_users`. If two successful logons for the same user occur from geographically distant locations within an impossible `times` window, it signals a compromised valid account (T1078). This requires enriching the log data with geolocation information."
        },
        {
          "detection_name": "Privileged Account Anomaly",
          "mapped_ttp": "T1078.002 (Domain Accounts)",
          "threat_scenario": "Privilege escalation and lateral movement using compromised admin accounts",
          "detection_logic": "`source_users` IN privileged_accounts AND `logon_type` = \"Interactive\" AND `destination_computer` IN workstations",
          "detection_probability": "___",
          "Details_reasoning_with_fields": "Identify if a `source_users` belonging to a privileged group (e.g., Domain Admins) performs an interactive logon (`logon_type` = 'Interactive' or 'RemoteInteractive') to a standard `destination_computer` (a workstation, not a server). This is a strong indicator of lateral movement using a compromised privileged account (T1078.002)."
        },
        {
          "detection_name": "Service Account Interactive Authentication",
          "mapped_ttp": "T1078.003 (Local Accounts)",
          "threat_scenario": "Service account compromise and misuse for interactive access",
          "detection_logic": "`source_users` LIKE \"svc_*\" AND `logon_type` IN [\"Interactive\", \"RemoteInteractive\"]",
          "detection_probability": "___",
          "Details_reasoning_with_fields": "Service accounts should not be used for interactive logons. Find events where the `source_users` matches a service account naming convention (e.g., starts with 'svc_') and the `logon_type` is 'Interactive' or 'RemoteInteractive'. This suggests the account has been compromised and is being used for hands-on access (T1078.003)."
        },
        {
          "detection_name": "Off-Hours Authentication Anomaly",
          "mapped_ttp": "T1078 (Valid Accounts)",
          "threat_scenario": "After-hours unauthorized access or compromised credentials",
          "detection_logic": "`source_users` authentication during non-business hours based on user baseline",
          "detection_probability": "___",
          "Details_reasoning_with_fields": "This requires establishing a baseline of normal logon hours for each `source_users`. An alert should be triggered if the `times` of a successful authentication falls outside this established baseline. This is a general indicator of a compromised valid account (T1078)."
        },
        {
          "detection_name": "Golden/Silver Ticket Detection",
          "mapped_ttp": "T1558.001 (Golden Ticket), T1558.002 (Silver Ticket)",
          "threat_scenario": "Forged Kerberos tickets for persistence and privilege escalation",
          "detection_logic": "`auth_type` = \"Kerberos\" AND encryption_type = \"RC4-HMAC\" AND unusual ticket properties",
          "detection_probability": "___",
          "Details_reasoning_with_fields": "This is an advanced detection. Look for Kerberos (`auth_type` = 'Kerberos') authentication events where weak or legacy encryption like RC4-HMAC is used, especially for TGT requests. This is a strong indicator of a Golden Ticket (T1558.001) or Overpass-the-Hash attack. The presence of a ticket for a user who does not exist or has unusual properties also points to this."
        },
        {
          "detection_name": "NTLM Relay Attack Detection",
          "mapped_ttp": "T1557.001 (LLMNR/NBT-NS Poisoning)",
          "threat_scenario": "Network-based attacks leveraging NTLM authentication weaknesses",
          "detection_logic": "`auth_type` = \"NTLM\" AND rapid authentication to multiple `destination_computer` from same `source_computer`",
          "detection_probability": "___",
          "Details_reasoning_with_fields": "An NTLM relay attack involves an attacker's machine (`source_computer`) rapidly relaying NTLM (`auth_type` = 'NTLM') authentication requests from a victim to multiple `destination_computer` systems. Look for a single `source_computer` making many NTLM authentication attempts to different destinations in a very short `times` window. This points to poisoning attacks like T1557.001."
        },
        {
          "detection_name": "High-Volume Failed Logons (Brute-Force/Spray)",
          "mapped_ttp": "T1110 (Brute Force)",
          "threat_scenario": "An attacker is attempting to guess user credentials.",
          "detection_logic": "ALERT if count(statuses = 'Failure') > 20 within 5 minutes for the same source_computer OR ALERT if count(statuses = 'Failure') > 20 within 5 minutes for the same destination_users.",
          "detection_probability": "___",
          "Details_reasoning_with_fields": "What is the probability this attack is detected? Provide the exact fields list and how they are related to the detection. Find information from the report."
        },
        {
          "detection_name": "Potential Pass-the-Hash (PtH) Attempt",
          "mapped_ttp": "T1550.002 (Use Alternate Authentication Material: Pass the Hash)",
          "threat_scenario": "An attacker is using a stolen NTLM hash for lateral movement.",
          "detection_logic": "ALERT on (logon_type = '3' AND auth_type = 'NTLM' AND statuses = 'Success') where source_users is a privileged account (e.g., Domain Admin) AND destination_computer is a workstation.",
          "detection_probability": "___",
          "Details_reasoning_with_fields": "What is the probability this attack is detected? Provide the exact fields list and how they are related to the detection. Find information from the report."
        },
        {
          "detection_name": "Remote Interactive Logon from Non-Admin Host",
          "mapped_ttp": "T1021.001 (Remote Services: Remote Desktop Protocol)",
          "threat_scenario": "An attacker is using RDP for lateral movement from a compromised workstation.",
          "detection_logic": "ALERT on (logon_type = '10' AND statuses = 'Success') where destination_computer is a server OR domain controller AND source_computer is NOT in the list of approved administrative hosts.",
          "detection_probability": "___",
          "Details_reasoning_with_fields": "What is the probability this attack is detected? Provide the exact fields list and how they are related to the detection. Find information from the report."
        },
        {
          "detection_name": "Potential Kerberoasting",
          "mapped_ttp": "T1558.003 (Steal or Forge Kerberos Tickets: Kerberoasting)",
          "threat_scenario": "An attacker is attempting to steal the credential hash of a service account.",
          "detection_logic": "ALERT on (auth_type = 'Kerberos' AND statuses = 'Success') where destination_users has a Service Principal Name (ends in '$') AND source_users is NOT a known administrative or service account.",
          "detection_probability": "___",
          "Details_reasoning_with_fields": "What is the probability this attack is detected? Provide the exact fields list and how they are related to the detection. Find information from the report."
        },
        {
          "detection_name": "Brute Force Network Logons",
          "mapped_ttp": "T1110 (Brute Force)",
          "threat_scenario": "Trigger when `statuses`=Failure AND `logon_type`=Network for the same `destination_users` exceeds threshold X within Y minutes.",
          "detection_logic": "Trigger when `statuses`=Failure AND `logon_type`=Network for the same `destination_users` exceeds threshold X within Y minutes.",
          "detection_probability": 0.0,
          "Details reasoning witb fields like previous points": "To determine the probability, analyze the logs for a high count of events where the 'statuses' field is 'Failure', the 'logon_type' is 'Network', and the 'destination_users' field is consistent across these events within a short time window defined by the 'times' field. A high frequency of this combination indicates a likely brute-force attack."
        },
        {
          "detection_name": "Pass-the-Hash via NTLM",
          "mapped_ttp": "T1550.002",
          "threat_scenario": "Alert on 4624 events where `auth_type` includes NTLM AND no prior 4768 Kerberos TGT for that `source_users`.",
          "detection_logic": "Alert on 4624 events where `auth_type` includes NTLM AND no prior 4768 Kerberos TGT for that `source_users`.",
          "detection_probability": 0.0,
          "Details reasoning witb fields like previous points": "To determine the probability, look for successful logon events (Event ID 4624) where the 'auth_type' is 'NTLM'. Then, verify that for the specific 'source_users' in that event, there was no preceding Kerberos Ticket Granting Ticket request (Event ID 4768) within a recent timeframe ('times'). The presence of a successful NTLM logon without a Kerberos ticket request is a strong indicator of Pass-the-Hash."
        },
        {
          "detection_name": "Kerberoasting SPN Requests",
          "mapped_ttp": "T1558.003",
          "threat_scenario": "Spike in 4769 requests for non-standard SPNs by same `source_users`.",
          "detection_logic": "Spike in 4769 requests for non-standard SPNs by same `source_users`.",
          "detection_probability": 0.0,
          "Details reasoning witb fields like previous points": "To determine the probability, monitor for a statistical anomaly (a spike) in the volume of Kerberos service ticket requests (Event ID 4769). The key fields to correlate are 'source_users' (the requester) and 'destination_users' (the Service Principal Name, or SPN). A single source user requesting an unusually high number of tickets for various service accounts in a short time ('times') is the primary indicator."
        },
        {
          "detection_name": "Token Impersonation Sequence",
          "mapped_ttp": "T1134.001",
          "threat_scenario": "Sequential logon events for two distinct accounts on same host within short time.",
          "detection_logic": "Sequential logon events for two distinct accounts on same host within short time.",
          "detection_probability": 0.0,
          "Details reasoning witb fields like previous points": "To determine the probability, search for a sequence of logon events (Event ID 4624) occurring within a very short time window ('times'). The pattern to match is two events on the same 'source_computer' but with different 'source_users', especially if one is a service account and the next is a privileged user account. This sequence suggests one session is spawning another with different credentials."
        },
        {
          "detection_name": "NTLM Coercion Detection",
          "mapped_ttp": "T1187",
          "threat_scenario": "Outbound SMB negotiation attempts (`auth_type`=NTLM) to external IPs.",
          "detection_logic": "Outbound SMB negotiation attempts (`auth_type`=NTLM) to external IPs.",
          "detection_probability": 0.0,
          "Details reasoning witb fields like previous points": "To determine the probability, filter for authentication events where the 'auth_type' is 'NTLM' and the 'destination_computer' is an external or non-domain IP address. This requires correlating authentication logs with network flow data or firewall logs to identify the external nature of the destination. Such outbound NTLM traffic is highly suspicious and indicative of a coercion attempt."
        }
      ],
      "entity_analysis_instructions": {
        "source_profiling_queries": [
          {
            "query_name": "Identify Malicious Source Actors",
            "instruction": "From the raw logs, extract and list all `source_computer` and `source_users` that are directly involved in the following patterns: 'Credential Stuffing Attack', 'Pass-the-Hash Attack', 'Pass-the-Ticket Attack', 'Golden Ticket Attack', 'Overpass-the-Hash Attack', 'Impossible Travel', 'Off-Hours Authentication', 'Privileged Account Lateral Movement'."
          }
        ],
        "target_profiling_queries": [
          {
            "query_name": "Identify High-Value or Frequently Targeted Systems",
            "instruction": "From the raw logs, extract and list all `destination_computer` and `destination_users` that are involved in patterns like 'Privileged Account Lateral Movement', 'Golden Ticket Attack', 'Pass-the-Hash Attack', or that appear as a target in more than 10 events matching any malicious or anomalous patterns."
          }
        ]
      },
      "fields": {
        "source_computer": {
          "type": "string",
          "description": "The name or identifier of the computer where the authentication attempt originated.",
          "OCSF": "source.device.hostname",
          "ECS": "source.domain",
          "OSSEM": "source.host.name",
          "importance": 8
        },
        "destination_computer": {
          "type": "string",
          "description": "The name or identifier of the computer that was the target of the authentication attempt.",
          "OCSF": "dst_endpoint.hostname",
          "ECS": "destination.domain",
          "OSSEM": "destination.host.name",
          "importance": 8
        },
        "auth_type": {
          "type": "string",
          "description": "The authentication protocol used for the logon, such as Kerberos or NTLM.",
          "OCSF": "auth.auth_protocol",
          "ECS": "event.authentication_method",
          "OSSEM": "authentication.package_name",
          "importance": 7
        },
        "logon_type": {
          "type": "string",
          "description": "The type of logon that occurred, such as Network or Interactive.",
          "OCSF": "logon_type",
          "ECS": "winlog.logon.type",
          "OSSEM": "logon.logon_type",
          "importance": 7
        },
        "times": {
          "type": "array",
          "description": "A list of timestamps associated with the event. The raw log sample indicates multiple timestamps can be present for a single event.",
          "OCSF": "time",
          "ECS": "@timestamp",
          "OSSEM": "event.time",
          "importance": 9
        },
        "source_users": {
          "type": "array",
          "description": "The user account that initiated the logon request.",
          "OCSF": "src.user.name",
          "ECS": "source.user.name",
          "OSSEM": "source.user.name",
          "importance": 9
        },
        "destination_users": {
          "type": "array",
          "description": "The user account for which the new logon was created.",
          "OCSF": "user.name",
          "ECS": "destination.user.name",
          "OSSEM": "object.user.name",
          "importance": 9
        },
        "orientations": {
          "type": "string",
          "description": "The orientation of the event, indicating if it was a logon or logoff.",
          "OCSF": "activity_name",
          "ECS": "event.action",
          "OSSEM": "action",
          "importance": 8
        },
        "statuses": {
          "type": "string",
          "description": "The status of the authentication attempt, such as Success or Failure.",
          "OCSF": "status",
          "ECS": "event.outcome",
          "OSSEM": "status",
          "importance": 8
        }
      },
      "log_type": "Windows Security Authentication Log",
      "indicators_of_compromise": [
        {
          "indicator_category": "Authentication Failure Patterns",
          "Instruction": "More than '10' EventID 4625 with different 'Account Name' and Sub status 0xc0000064 (user name does not exist) from a source network address that is not null, indicates possible account discovery (password spraying).",
          "relevant_fields": [
            "statuses:",
            "source_users:",
            "source_computer:"
          ]
        },
        {
          "indicator_category": "Suspicious Network Logons",
          "Instruction": "Event ID 4624 with logon type 10 (Remote Interactive) from a source network that is not within your organization's subnets.",
          "relevant_fields": [
            "logon_type:",
            "source_computer:"
          ]
        },
        {
          "indicator_category": "RDP Tunneling Indicators",
          "Instruction": "Event ID 4624 with Logon type 10 (RemoteInteractive) where the source network address is a loopback address (127.x.x.x or ::1), often indicates RDP tunneling.",
          "relevant_fields": [
            "logon_type:",
            "source_computer:"
          ]
        },
        {
          "indicator_category": "Lateral Movement Between Endpoints",
          "Instruction": "Event ID 4624 with logon type 3 or 10 where both the source workstation name and destination are end-user machines (not servers).",
          "relevant_fields": [
            "logon_type:",
            "source_computer:",
            "destination_computer:"
          ]
        },
        {
          "indicator_category": "Kerberos Attack Indicators",
          "Instruction": "A Kerberos authentication ticket (TGT) was requested with encryption type 0x17 (RC4-HMAC). This legacy encryption type can be evidence of an OverPass The Hash attack.",
          "relevant_fields": [
            "auth_type:"
          ]
        },
        {
          "indicator_category": "Anomalous Source Hostname/IP",
          "Instruction": "A `source_computer` that is not part of the known corporate network or is on a blacklist attempting authentication.",
          "relevant_fields": [
            "source_computer:"
          ]
        },
        {
          "indicator_category": "Unauthorized Account Usage",
          "Instruction": "The `source_users` or `destination_users` field shows activity from a disabled, dormant, or unauthorized account.",
          "relevant_fields": [
            "source_users:",
            "destination_users:"
          ]
        },
        {
          "indicator_category": "Suspicious Authentication Patterns",
          "Instruction": "A high ratio of failed to successful logons (`statuses`) from a single `source_computer`.",
          "relevant_fields": [
            "statuses:",
            "source_computer:"
          ]
        },
        {
          "indicator_category": "Anomalous Logon Types",
          "Instruction": "A `logon_type` that is inconsistent with the user's role, such as a service account performing an interactive logon.",
          "relevant_fields": [
            "logon_type:"
          ]
        },
        {
          "indicator_category": "Use of Weak/Legacy Protocols",
          "Instruction": "The `auth_type` field indicates widespread use of NTLMv1 or other insecure protocols.",
          "relevant_fields": [
            "auth_type:"
          ]
        },
        {
          "indicator_category": "Known Malicious Tool Signatures",
          "Instruction": "While not in the log itself, the *behavior* generated by tools like Mimikatz (e.g., specific logon patterns) can be an indicator.",
          "relevant_fields": []
        },
        {
          "indicator_category": "Anomalous User Account Names",
          "Instruction": "Accounts observed in anomalous logons (e.g., service$, admin).",
          "relevant_fields": [
            "source_users:",
            "destination_users:"
          ]
        },
        {
          "indicator_category": "Anomalous Hostnames/IP Addresses",
          "Instruction": "`source_computer`, `destination_computer` involved in lateral movement or NTLM relay.",
          "relevant_fields": [
            "source_computer:",
            "destination_computer:"
          ]
        },
        {
          "indicator_category": "Anomalous Authentication Protocols",
          "Instruction": "Spikes in NTLM vs. Kerberos usage.",
          "relevant_fields": [
            "auth_type:"
          ]
        },
        {
          "indicator_category": "Anomalous Event IDs",
          "Instruction": "4624, 4625, 4648, 4672, 4697, 4768, 4769 anomalies.",
          "relevant_fields": []
        }
      ],
      "attack_pattern_checks": [
        {
          "attack_pattern_name": "T1187 (Forced Authentication)",
          "is_present": false,
          "evidence_Instruction": "Set `is_present` to `true` if you observe unusual SMB authentication patterns in the `auth_type` field, especially if correlated with tools known to coerce authentication. As proof, provide the source and target entities and the relevant timestamps.",
          "evidence": []
        },
        {
          "attack_pattern_name": "T1556 (Modify Authentication Process)",
          "is_present": false,
          "evidence_Instruction": "Set `is_present` to `true` if you observe anomalous `auth_type` values or unusual authentication flows not matching standard Kerberos or NTLM procedures. As proof, provide the source and target entities and the relevant timestamps.",
          "evidence": []
        },
        {
          "attack_pattern_name": "T1003 (OS Credential Dumping)",
          "is_present": false,
          "evidence_Instruction": "Set `is_present` to `true` if authentication events are correlated with subsequent suspicious process execution logs on the source computer, such as the execution of Mimikatz. As proof, provide the source and target entities and the relevant timestamps.",
          "evidence": []
        },
        {
          "attack_pattern_name": "T1550.002 (Pass the Hash)",
          "is_present": false,
          "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Pass-the-Hash Detection' rule. As proof, provide the source and target entities, and the relevant timestamps.",
          "evidence": []
        },
        {
          "attack_pattern_name": "T1550.003 (Pass the Ticket)",
          "is_present": false,
          "evidence_Instruction": "Set `is_present` to `true` if you observe a Kerberos ticket being used from multiple source computers for the same user. As proof, provide the source user and the multiple source computers and timestamps.",
          "evidence": []
        },
        {
          "attack_pattern_name": "T1558.001 (Golden Ticket)",
          "is_present": false,
          "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Golden/Silver Ticket Detection' rule, especially involving high-privilege accounts. As proof, detail the unusual ticket properties, source, and target.",
          "evidence": []
        },
        {
          "attack_pattern_name": "T1558.002 (Silver Ticket)",
          "is_present": false,
          "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Golden/Silver Ticket Detection' rule, often related to a specific service. As proof, detail the unusual ticket properties, source, target, and service.",
          "evidence": []
        },
        {
          "attack_pattern_name": "T1110 (Brute Force)",
          "is_present": false,
          "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'Multiple Failed Authentication Attempts' rule. As proof, provide the source computer, the list of targeted users, and the time window of the attack.",
          "evidence": []
        },
        {
          "attack_pattern_name": "T1078 (Valid Accounts)",
          "is_present": false,
          "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching 'Impossible Travel', 'Off-Hours Authentication', or 'Privileged Account Anomaly' rules. As proof, provide the user account, source/destination, and timestamps that constitute the anomaly.",
          "evidence": []
        },
        {
          "attack_pattern_name": "T1557.001 (LLMNR/NBT-NS Poisoning)",
          "is_present": false,
          "evidence_Instruction": "Set `is_present` to `true` if you find evidence matching the 'NTLM Relay Attack Detection' rule. As proof, provide the source relaying computer and the multiple destinations it authenticated to.",
          "evidence": []
        }
      ]
    },
    "_field_property_stats": {
      "total_fields": 9,
      "properties_per_field": {
        "source_computer": [
          "type",
          "description",
          "OCSF",
          "ECS",
          "OSSEM",
          "importance"
        ],
        "destination_computer": [
          "type",
          "description",
          "OCSF",
          "ECS",
          "OSSEM",
          "importance"
        ],
        "auth_type": [
          "type",
          "description",
          "OCSF",
          "ECS",
          "OSSEM",
          "importance"
        ],
        "logon_type": [
          "type",
          "description",
          "OCSF",
          "ECS",
          "OSSEM",
          "importance"
        ],
        "times": [
          "type",
          "description",
          "OCSF",
          "ECS",
          "OSSEM",
          "importance"
        ],
        "source_users": [
          "type",
          "description",
          "OCSF",
          "ECS",
          "OSSEM",
          "importance"
        ],
        "destination_users": [
          "type",
          "description",
          "OCSF",
          "ECS",
          "OSSEM",
          "importance"
        ],
        "orientations": [
          "type",
          "description",
          "OCSF",
          "ECS",
          "OSSEM",
          "importance"
        ],
        "statuses": [
          "type",
          "description",
          "OCSF",
          "ECS",
          "OSSEM",
          "importance"
        ]
      },
      "semantic_selection_applied": true
    },
    "_consensus_metadata": {
      "generation_timestamp": 1753887999.9488337,
      "consensus_parts_count": 23,
      "filtered_parts_count": 20,
      "contributing_sources": [
        "gemini_from_gemini_report_prompt3",
        "gemini_from_openai_report_prompt3",
        "gemini_from_claude_report_prompt3"
      ],
      "average_confidence": 0.49563934741096105,
      "processing_config": {
        "consensus_strength": "comprehensive",
        "use_sbert_embeddings": true,
        "use_semantic_clustering": true,
        "use_semantic_ted": true,
        "use_bft_consensus": true,
        "use_weighted_voting": true,
        "use_mcts_optimization": false,
        "bft_agreement_threshold": 0.67,
        "similarity_threshold": 0.75,
        "consensus_threshold": 0.6,
        "enable_research_mode": true,
        "preservation_ratio": 0.8,
        "min_confidence_threshold": 0.0,
        "min_part_size": 1,
        "clustering_method": "distance_based",
        "strictness_level": "moderate",
        "security_focus": true,
        "content_complexity_preference": "balanced"
      },
      "hyperparameter_summary": {
        "preservation_ratio": 0.8,
        "strictness_level": "moderate",
        "security_focus": true,
        "content_complexity_preference": "balanced"
      }
    },
    "_provenance": {
      "part_contributions": {
        "parsed_json.observations.behavioral_patterns": {
          "contributing_sources": [
            "gemini_from_gemini_report_prompt3",
            "gemini_from_openai_report_prompt3",
            "gemini_from_claude_report_prompt3"
          ],
          "confidence": 0.4424058921923495,
          "is_merged": false,
          "hyperparameter_filtered": true
        },
        "parsed_json.observations.temporal_patterns.malicious.pattern_name": {
          "contributing_sources": [
            "gemini_from_openai_report_prompt3",
            "gemini_from_claude_report_prompt3"
          ],
          "confidence": 0.5,
          "is_merged": false,
          "hyperparameter_filtered": true
        },
        "parsed_json.observations.temporal_patterns.malicious.Instruction": {
          "contributing_sources": [
            "gemini_from_openai_report_prompt3",
            "gemini_from_claude_report_prompt3"
          ],
          "confidence": 0.5,
          "is_merged": false,
          "hyperparameter_filtered": true
        },
        "parsed_json.observations.temporal_patterns.vulnerable.pattern_name": {
          "contributing_sources": [
            "gemini_from_openai_report_prompt3",
            "gemini_from_claude_report_prompt3"
          ],
          "confidence": 0.5,
          "is_merged": false,
          "hyperparameter_filtered": true
        },
        "parsed_json.observations.temporal_patterns.vulnerable.Instruction": {
          "contributing_sources": [
            "gemini_from_openai_report_prompt3",
            "gemini_from_claude_report_prompt3"
          ],
          "confidence": 0.5,
          "is_merged": false,
          "hyperparameter_filtered": true
        },
        "parsed_json.detection_rule_checklist.detection_probability": {
          "contributing_sources": [
            "gemini_from_gemini_report_prompt3",
            "gemini_from_claude_report_prompt3"
          ],
          "confidence": 0.5,
          "is_merged": false,
          "hyperparameter_filtered": true
        },
        "part_18": {
          "contributing_sources": [
            "gemini_from_gemini_report_prompt3",
            "gemini_from_openai_report_prompt3",
            "gemini_from_claude_report_prompt3"
          ],
          "confidence": 0.5240867961811209,
          "is_merged": true,
          "hyperparameter_filtered": false
        },
        "parsed_json.entity_analysis_instructions.source_profiling_queries.query_name": {
          "contributing_sources": [
            "gemini_from_claude_report_prompt3"
          ],
          "confidence": 0.5,
          "is_merged": false,
          "hyperparameter_filtered": false
        }
      }
    }
  },
  "overall_confidence": 0.43599627187773615,
  "consensus_methods_used": {
    "json1_consensus": "SEMANTIC_CORE",
    "json2_consensus": "OPTIMIZED_CONSENSUS_V2"
  }
}